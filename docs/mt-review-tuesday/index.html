<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Midterm Review: TF-IDF and Merging</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../assets/theme.css" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Midterm Review: TF-IDF and Merging</h1>
</header>
<p><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<!-- add after bootstrap.min.css -->
<link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"/>
<!-- add after bootstrap.min.js or bootstrap.bundle.min.js -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script></p>
<!-- for difficulty gauges-->
<script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-B947E6J6H4"></script> -->
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  // gtag('js', new Date());

  // gtag('config', 'G-B947E6J6H4');
</script>
<p><a href="../index.html">← return to study.practicaldsc.org</a></p>
<hr />
<p>The problems in this worksheet are taken from past exams in similar
classes. Work on them <strong>on paper</strong>, since the exams you
take in this course will also be on paper. <br><br>We encourage you to
attempt these problems <strong>before</strong> Tuesday’s exam review
session, so that we have enough time to walk through the solutions to
all of the problems. <br><br>We will enable the solutions here after the
review session, though you can find the written solutions to these
problems in other discussion worksheets.</p>
<hr />
<h2 id="problem-1">Problem 1</h2>
<p>Nishant decides to look at reviews for the Catamaran Resort Hotel and
Spa. TripAdvisor has 96 reviews for the hotel; of those 96, Nishant’s
favorite review was:</p>
<pre><code>    &quot;close to the beach but far from the beach beach&quot;</code></pre>
<p><br></p>
<h3 id="problem-1.1">Problem 1.1</h3>
<p>What is the TF of <code>"beach"</code> in Nishant’s favorite review?
Give your answer as a simplified fraction.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_1" aria-expanded="true" aria-controls="collapse1_1">
Click to view the solution.
</button>
</h2>
<div id="collapse1_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading1_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> <span class="math inline">\frac{3}{10}</span></p>
<p>The answer is simply the proportion of words in the sentence that are
the word <code>"beach"</code>. There are 10 words in the sentence, 3 of
which are <code>"beach"</code>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.2">Problem 1.2</h3>
<p>The TF-IDF of <code>"beach"</code> in Nishant’s favorite review is
<span class="math inline">\frac{9}{10}</span>, when using a base-2
logarithm to compute the IDF. How many of the reviews on TripAdvisor for
this hotel contain the term <code>"beach"</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> 3</p></li>
<li><p><input type="radio" disabled="" /> 6</p></li>
<li><p><input type="radio" disabled="" /> 8</p></li>
<li><p><input type="radio" disabled="" /> 12</p></li>
<li><p><input type="radio" disabled="" /> 16</p></li>
<li><p><input type="radio" disabled="" /> 24</p></li>
<li><p><input type="radio" disabled="" /> 32</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_2" aria-expanded="true" aria-controls="collapse1_2">
Click to view the solution.
</button>
</h2>
<div id="collapse1_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading1_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> 12</p>
<p>The TF-IDF is the product of the TF and IDF terms. So if the TF-IDF
of this document is <span class="math inline">\frac{9}{10}</span>, and
the TF is <span class="math inline">\frac{3}{10}</span>, as established
in the last part, the IDF of the term <code>"beach"</code> is 3. The IDF
for a word is the log of the inverse of the proportion of documents in
which the word appears. So, since we know there are 96 total
documents.</p>
<p><span class="math display">3 = log_{2}(\frac{96}{\text{\# documents
containing "beach"}})</span></p>
<p><span class="math display">2^{3} = \frac{96}{\text{\# documents
containing "beach"}}</span></p>
<p><span class="math display">\boxed{12} = {\text{\# documents
containing "beach"}}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-2">Problem 2</h2>
<p>The DataFrame below contains a corpus of four song titles, labeled
from 0 to 3.</p>
<center><img src='../assets/images/disc06/love_songs.png' width=35%></center>
<p><br></p>
<h3 id="problem-2.1">Problem 2.1</h3>
<p>What is the TF-IDF of the word <code>"hate"</code> in Song 0’s title?
Use base 2 in your logarithm, and give your answer as a simplified
fraction.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_1" aria-expanded="true" aria-controls="collapse2_1">
Click to view the solution.
</button>
</h2>
<div id="collapse2_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading2_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <span class="math inline">\frac{1}{6}</span></p>
<p>There are 12 words in Song 0’s title, and 2 of them are
<code>"hate"</code>, so the term frequency of <code>"hate"</code> in
Song 0’s title is <span class="math inline">\frac{2}{12} =
\frac{1}{6}</span>.</p>
<p>There are 4 documents total, and 2 of them contain
<code>"hate"</code> (Song 0’s title and Song 3’s title), so the inverse
document frequency of <code>"hate"</code> in the corpus is <span class="math inline">\log_2 \left( \frac{4}{2} \right) = \log_2 (2) =
1</span>.</p>
<p>Then, the TF-IDF of <code>"hate"</code> in Song 0’s title is</p>
<p><span class="math display">\text{TF-IDF} = \frac{1}{6} \cdot 1 =
\frac{1}{6}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.2">Problem 2.2</h3>
<p>Which word in Song 0’s title has the highest TF-IDF?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>"i"</code></p></li>
<li><p><input type="radio" disabled="" /> <code>"hate"</code></p></li>
<li><p><input type="radio" disabled="" /> <code>"you"</code></p></li>
<li><p><input type="radio" disabled="" /> <code>"love"</code></p></li>
<li><p><input type="radio" disabled="" /> <code>"that"</code></p></li>
<li><p><input type="radio" disabled="" /> Two or more words are tied for the highest TF-IDF in Song 0’s
title</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_2" aria-expanded="true" aria-controls="collapse2_2">
Click to view the solution.
</button>
</h2>
<div id="collapse2_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading2_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> Option A: <code>"i"</code></p>
<p>It was not necessary to compute the TF-IDFs of all words in Song 0’s
title to determine the answer. <span class="math inline">\text{tfidf}(t,
d)</span> is high when <span class="math inline">t</span> occurs often
in <span class="math inline">d</span> but rarely overall. That is the
case with <code>"i"</code> — it is the most common word in Song 0’s
title (with 4 appearances), but it does not appear in any other
document. As such, it must be the word with the highest TF-IDF in Song
0’s title.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.3">Problem 2.3</h3>
<p>Let <span class="math inline">\text{tfidf}(t, d)</span> be the TF-IDF
of term <span class="math inline">t</span> in document <span
class="math inline">d</span>, and let <span
class="math inline">\text{bow}(t, d)</span> be the number of occurrences
of term <span class="math inline">t</span> in document <span
class="math inline">d</span>.</p>
<p><strong>Select all</strong> correct answers below.</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> If <span class="math inline">\text{tfidf}(t, d) = 0</span>, then
<span class="math inline">\text{bow}(t, d) = 0</span>.</p></li>
<li><p><input type="checkbox" disabled="" /> If <span class="math inline">\text{bow}(t, d) = 0</span>, then <span class="math inline">\text{tfidf}(t, d) = 0</span>.</p></li>
<li><p><input type="checkbox" disabled="" /> Neither of the above statements are necessarily true.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_3" aria-expanded="true" aria-controls="collapse2_3">
Click to view the solution.
</button>
</h2>
<div id="collapse2_3" class="accordion-collapse collapse collapse"
aria-labelledby="heading2_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> Option B</p>
<p>Recall that <span class="math inline">\text{tfidf}(t, d) =
\text{tf}(t, d) \cdot \text{idf}(t)</span>, and note that <span class="math inline">\text{tf}(t, d)</span> is just $ (t, d) $. Thus,
<span class="math inline">\text{tfidf}(t, d)</span> is 0 is if either
<span class="math inline">\text{bow}(t, d) = 0</span> or <span class="math inline">\text{idf}(t) = 0</span>.</p>
<p>So, if <span class="math inline">\text{bow}(t, d) = 0</span>, then
<span class="math inline">\text{tf}(t, d) = 0</span> and <span class="math inline">\text{tfidf}(t, d) = 0</span>, so the second option
is true. However, if <span class="math inline">\text{tfidf}(t, d) =
0</span>, it could be the case that <span class="math inline">\text{bow}(t, d) &gt; 0</span> and <span class="math inline">\text{idf}(t) = 0</span> (which happens when term
<span class="math inline">t</span> is in every document), so the first
option is not necessarily true.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.4">Problem 2.4</h3>
<p>Below, we’ve encoded the corpus from the previous page using the
bag-of-words model.</p>
<center><img src='../assets/images/disc06/bag-words.png' width=40%></center>
<p>Note that in the above DataFrame, each row has been normalized to
have a length of 1 (i.e. <span class="math inline">|\vec{v}| = 1</span>
for all four row vectors).</p>
<p>Which song’s title has the highest cosine similarity with Song 0’s
title?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Song 1</p></li>
<li><p><input type="radio" disabled="" /> Song 2</p></li>
<li><p><input type="radio" disabled="" /> Song 3</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_4" aria-expanded="true" aria-controls="collapse2_4">
Click to view the solution.
</button>
</h2>
<div id="collapse2_4" class="accordion-collapse collapse collapse"
aria-labelledby="heading2_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> Option B: Song 2</p>
<p>Recall, the cosine similarity between two vectors <span class="math inline">\vec{a}, \vec{b}</span> is computed as</p>
<p><span class="math display">\cos \theta = \frac{\vec{a} \cdot
\vec{b}}{| \vec{a} | | \vec{b}|}</span></p>
<p>We are told that each row vector is already normalized to have a
length of 1, so to compute the similarity between two songs’ titles, we
can compute dot products directly.</p>
<ul>
<li><p>Song 0 and Song 1: <span class="math inline">0.47 \cdot
0.76</span></p></li>
<li><p>Song 0 and Song 2: <span class="math inline">0.47 \cdot 0.58 +
0.71 \cdot 0.58</span></p></li>
<li><p>Song 0 and Song 3: <span class="math inline">0.47 \cdot
0.71</span></p></li>
</ul>
<p>Without using a calculator (which students did not have access to
during the exam), it is clear that the dot product between Song 0’s
title and Song 2’s title is the highest, hence Song 2’s title is the
most similar to Song 0’s.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-3">Problem 3</h2>
<p>The DataFrame <code>dogs</code>, contains one row for every
registered pet dog in Zurich, Switzerland in 2017.</p>
<p>The first few rows of <code>dogs</code> are shown below, but
<code>dogs</code> has many more rows than are shown.</p>
<center><img src="../assets/images/disc03/df.png" width=750></center>
<p><br></p>
<ul>
<li><code>"owner_id" (int)</code>: A unique ID for each owner. Note
that, for example, there are two rows in the preview for
<code>4215</code>, meaning that owner has at least 2 dogs.
<strong>Assume that if an <code>"owner_id"</code> appears in
<code>dogs</code> multiple times, the corresponding
<code>"owner_age"</code>, <code>"owner_sex"</code>, and
<code>"district"</code> are always the same.</strong></li>
<li><code>"owner_age" (str)</code>: The age group of the owner; either
<code>"11-20"</code>, <code>"21-30"</code>, …, or <code>"91-100"</code>
(9 possibilities in total).</li>
<li><code>"owner_sex" (str)</code>: The birth sex of the owner; either
<code>"m"</code> (male) or <code>"f"</code> (female).</li>
<li><code>"district" (int)</code>: The city district the owner lives in;
a positive integer between <code>1</code> and <code>12</code>
(inclusive).</li>
<li><code>"primary_breed" (str)</code>: The primary breed of the
dog.</li>
<li><code>"secondary_breed" (str)</code>: The secondary breed of the
dog. If this column is not null, the dog is a “mixed breed” dog;
otherwise, the dog is a “purebred” dog.</li>
<li><code>"dog_sex" (str)</code>: The birth sex of the dog; either
<code>"m"</code> (male) or <code>"f"</code> (female).</li>
<li><code>"birth_year" (int)</code>: The birth year of the dog.</li>
</ul>
<p>In this question, assume that there are more than 12 districts in
<code>dogs</code>.</p>
<p>Suppose we merge the <code>dogs</code> DataFrame with itself as
follows.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># on=&quot;x&quot; is the same as specifying both left_on=&quot;x&quot; and right_on=&quot;x&quot;.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>double <span class="op">=</span> dogs.merge(dogs, on<span class="op">=</span><span class="st">&quot;district&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sort_index sorts a Series in increasing order of its index.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>square <span class="op">=</span> double[<span class="st">&quot;district&quot;</span>].value_counts().value_counts().sort_index()</span></code></pre></div>
<p>The first few rows of <code>square</code> are shown below.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     <span class="dv">5500</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      <span class="dv">215</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>       <span class="dv">40</span></span></code></pre></div>
<p><br></p>
<h3 id="problem-3.1">Problem 3.1</h3>
<p>In <code>dogs</code>, there are 12 rows with a
<code>"district"</code> of <code>8</code>. How many rows of
<code>double</code> have a <code>"district"</code> of <code>8</code>?
Give your answer as a positive integer.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_1" aria-expanded="true" aria-controls="collapse3_1">
Click to view the solution.
</button>
</h2>
<div id="collapse3_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading3_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <span class="math inline">144</span></p>
<p>When we merge <code>dogs</code> with <code>dogs</code> on
<code>"district"</code>, each <code>8</code> in the first
<code>dogs</code> DataFrame will be combined with each <code>8</code> in
the second <code>dogs</code> DataFrame. Since there are 12 in the first
and 12 in the second, there are <span class="math inline">12 \cdot 12 =
144</span> combinations.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.2">Problem 3.2</h3>
<p>What does the following expression evaluate to? Give your answer as a
positive integer.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dogs.groupby(<span class="st">&quot;district&quot;</span>).<span class="bu">filter</span>(<span class="kw">lambda</span> df: df.shape[<span class="dv">0</span>] <span class="op">==</span> <span class="dv">3</span>).shape[<span class="dv">0</span>]</span></code></pre></div>
<p><em>Hint: Unlike in 5.1, your answer to 5.2 depends on the values in
<code>square</code>.</em></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_2" aria-expanded="true" aria-controls="collapse3_2">
Click to view the solution.
</button>
</h2>
<div id="collapse3_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading3_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <span class="math inline">120</span></p>
<p><code>square</code> is telling us that: - There are 5500 districts
that appeared just 1x in <code>dogs</code>. - There are 215 districts
that appeared 2x in <code>dogs</code> (2x, not 4x, because of the logic
explained in the 5a rubric item). - There are 40 districts that appeared
3x in <code>dogs</code>.</p>
<p>The expression given in this question is keeping all of the rows
corresponding to districts that appear 3 times. There are 40 districts
that appear 3 times. So, the total number of rows in this DataFrame is
<span class="math inline">40 \cdot 3 = 120</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-4">Problem 4</h2>
<p>Kyle and Yutong are trying to decide where they’ll study on campus
and start flipping a Michigan-themed coin, with a picture of the
Michigan Union on the heads side and a picture of the Shapiro
Undergraduate Library (aka the UgLi) on the tails side.</p>
<center><img src='../assets/images/disc03/michigan_union.png' width=400></center>
<p><br></p>
<p>Kyle flips the coin 21 times and sees 13 heads and 8 tails. He stores
this information in a DataFrame named <code>kyle</code> that has 21 rows
and 2 columns, such that:</p>
<ul>
<li><p>The <code>"flips"</code> column contains <code>"Heads"</code> 13
times and <code>"Tails"</code> 8 times.</p></li>
<li><p>The <code>"Markley"</code> column contains <code>"Kyle"</code> 21
times.</p></li>
</ul>
<p>Then, Yutong flips the coin 11 times and sees 4 heads and 7 tails.
She stores this information in a DataFrame named <code>yutong</code>
that has 11 rows and 2 columns, such that:</p>
<ul>
<li><p>The <code>"flips"</code> column contains <code>"Heads"</code> 4
times and <code>"Tails"</code> 7 times.</p></li>
<li><p>The <code>"MoJo"</code> column contains <code>"Yutong"</code> 11
times.</p></li>
</ul>
<p><br></p>
<h3 id="problem-4.1">Problem 4.1</h3>
<p>How many rows are in the following DataFrame? Give your answer as an
integer.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>    kyle.merge(yutong, on<span class="op">=</span><span class="st">&quot;flips&quot;</span>)</span></code></pre></div>
<p><em>Hint: The answer is less than 200.</em></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_1" aria-expanded="true" aria-controls="collapse4_1">
Click to view the solution.
</button>
</h2>
<div id="collapse4_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading4_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: 108</p>
<p>Since we used the argument <code>on="flips</code>, rows from
<code>kyle</code> and <code>yutong</code> will be combined whenever they
have matching values in their <code>"flips"</code> columns.</p>
<p>For the <code>kyle</code> DataFrame:</p>
<ul>
<li>There are 13 rows with <code>"Heads"</code> in the
<code>"flips"</code> column.</li>
<li>There are 8 rows with <code>"Tails"</code> in the
<code>"flips"</code> column.</li>
</ul>
<p>For the <code>yutong</code> DataFrame:</p>
<ul>
<li>There are 4 rows with <code>"Heads"</code> in the
<code>"flips"</code> column.</li>
<li>There are 7 rows with <code>"Tails"</code> in the
<code>"flips"</code> column.</li>
</ul>
<p>The merged DataFrame will also only have the values
<code>"Heads"</code> and <code>"Tails"</code> in its
<code>"flips"</code> column.</p>
<ul>
<li>The 13 <code>"Heads"</code> rows from <code>kyle</code> will each
pair with the 4 <code>"Heads"</code> rows from <code>yutong</code>. This
results in <span class="math inline">13 \cdot 4 = 52</span> rows with
<code>"Heads"</code></li>
<li>The 8 <code>"Tails"</code> rows from <code>kyle</code> will each
pair with the 7 <code>"Tails"</code> rows from <code>yutong</code>. This
results in <span class="math inline">8 \cdot 7 = 56</span> rows with
<code>"Tails"</code>.</li>
</ul>
<p>Then, the total number of rows in the merged DataFrame is <span class="math inline">52 + 56 = 108</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-4.2">Problem 4.2</h3>
<p>Let <span class="math inline">A</span> be your answer to the previous
part. Now, suppose that:</p>
<ul>
<li><p><code>kyle</code> contains an additional row, whose
<code>"flips"</code> value is <code>"Total"</code> and whose
<code>"Markley"</code> value is 21.</p></li>
<li><p><code>yutong</code> contains an additional row, whose
<code>"flips"</code> value is <code>"Total"</code> and whose
<code>"MoJo"</code> value is 11.</p></li>
</ul>
<p>Suppose we again merge <code>kyle</code> and <code>yutong</code> on
the <code>"flips"</code> column. In terms of <span
class="math inline">A</span>, how many rows are in the new merged
DataFrame?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">A</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">A+1</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">A+2</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">A+4</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">A+231</span></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_2" aria-expanded="true" aria-controls="collapse4_2">
Click to view the solution.
</button>
</h2>
<div id="collapse4_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading4_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <span class="math inline">A+1</span></p>
<p>The additional row in each DataFrame has a unique
<code>"flips"</code> value of <code>"Total"</code>. When we merge on the
<code>"flips"</code> column, this unique value will only create a single
new row in the merged DataFrame, as it pairs the <code>"Total"</code>
from <code>kyle</code> with the <code>"Total"</code> from
<code>yutong</code>. The rest of the rows are the same as in the
previous merge, and as such, they will contribute the same number of
rows, <span class="math inline">A</span>, to the merged DataFrame. Thus,
the total number of rows in the new merged DataFrame will be <span class="math inline">A</span> (from the original matching rows) plus 1
(from the new <code>"Total"</code> rows), which sums up to <span class="math inline">A+1</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-5">Problem 5</h2>
<p>For each day in May 2022, the DataFrame <code>streams</code> contains
the number of streams for each of the “Top 200" songs on Spotify that
day — that is, the number of streams for the 200 songs with the most
streams on Spotify that day. The columns in <code>streams</code> are as
follows:</p>
<ul>
<li><p><code>"date"</code>: the date the song was streamed</p></li>
<li><p><code>"artist_names"</code>: name(s) of the artists who created
the song</p></li>
<li><p><code>"track_name"</code>: name of the song</p></li>
<li><p><code>"streams"</code>: the number of times the song was streamed
on Spotify that day</p></li>
</ul>
<p>The first few rows of <code>streams</code> are shown below. Since
there were 31 days in May and 200 songs per day, <code>streams</code>
has 6200 rows in total.</p>
<center><img src='../assets/images/disc04/streams.png' width=50%></center>
<p>Note that:</p>
<ul>
<li><p><code>streams</code> is already sorted in a very particular way —
it is sorted by <code>"date"</code> in reverse chronological
(decreasing) order, and, within each <code>"date"</code>, by
<code>"streams"</code> in increasing order.</p></li>
<li><p>Many songs will appear multiple times in <code>streams</code>,
because many songs were in the Top 200 on more than one day.</p></li>
</ul>
<p>Suppose the DataFrame <code>today</code> consists of 15 rows — 3 rows
for each of 5 different <code>"artist_names"</code>. For each artist, it
contains the <code>"track_name"</code> for their three most-streamed
songs today. For instance, there may be one row for
<code>"olivia rodrigo"</code> and <code>"favorite crime"</code>, one row
for <code>"olivia rodrigo"</code> and <code>"drivers license"</code>,
and one row for <code>"olivia rodrigo"</code> and
<code>"deja vu"</code>.</p>
<p>Another DataFrame, <code>genres</code>, is shown below in its
entirety.</p>
<center><img src='../assets/images/disc04/genres.png' width=25%></center>
<p><br></p>
<h3 id="problem-5.1">Problem 5.1</h3>
<p>Suppose we perform an <strong>inner</strong> merge between
<code>today</code> and <code>genres</code> on
<code>"artist_names"</code>. If the five <code>"artist_names"</code> in
<code>today</code> are the same as the five <code>"artist_names"</code>
in <code>genres</code>, what fraction of the rows in the merged
DataFrame will contain <code>"Pop"</code> in the <code>"genre"</code>
column? Give your answer as a simplified fraction.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_1" aria-expanded="true" aria-controls="collapse5_1">
Click to view the solution.
</button>
</h2>
<div id="collapse5_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading5_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <span class="math inline">\frac{2}{5}</span></p>
<p>If the five <code>"artist_names"</code> in <code>today</code> and
<strong>genres</strong> are the same, the DataFrame that results from an
inner merge will have 15 rows, one for each row in <code>today</code>.
This is because there are 3 matches for <code>"harry styles"</code>, 3
matches for <code>"olivia rodrigo"</code>, 3 matches for
<code>"glass animals"</code>, and so on.</p>
<p>In the merged DataFrame’s 15 rows, 6 of them will correspond to
<code>"Pop"</code> artists — 3 to <code>"harry styles"</code> and 3 to
<code>"olivia rodrigo"</code>. Thus, the fraction of rows that contain
<code>"Pop"</code> in the <code>"genre"</code> column is <span class="math inline">\frac{6}{15} = \frac{2}{5}</span> (which is the
fraction of rows that contained <code>"Pop"</code> in
<code>genres["genre"]</code>, too).</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.2">Problem 5.2</h3>
<p>Suppose we perform an <strong>inner</strong> merge between
<code>today</code> and <code>genres</code> on
<code>"artist_names"</code>. Furthermore, suppose that the only
overlapping <code>"artist_names"</code> between <code>today</code> and
<code>genres</code> are <code>"drake"</code> and
<code>"olivia rodrigo"</code>. What fraction of the rows in the merged
DataFrame will contain <code>"Pop"</code> in the <code>"genre"</code>
column? Give your answer as a simplified fraction.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_2" aria-expanded="true" aria-controls="collapse5_2">
Click to view the solution.
</button>
</h2>
<div id="collapse5_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading5_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <span class="math inline">\frac{1}{2}</span></p>
<p>If we perform an inner merge, there will only be 6 rows in the merged
DataFrame — 3 for <code>"olivia rodrigo"</code> and 3 for
<code>"drake"</code>. 3 of those 6 rows will have <code>"Pop"</code> in
the <code>"genre"</code> column, hence the answer is <span class="math inline">\frac{3}{6} = \frac{1}{2}</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.3">Problem 5.3</h3>
<p>Suppose we perform an <strong>outer</strong> merge between
<code>today</code> and <code>genres</code> on
<code>"artist_names"</code>. Furthermore, suppose that the only
overlapping <code>"artist_names"</code> between <code>today</code> and
<code>genres</code> are <code>"drake"</code> and
<code>"olivia rodrigo"</code>. What fraction of the rows in the merged
DataFrame will contain <code>"Pop"</code> in the <code>"genre"</code>
column? Give your answer as a simplified fraction.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_3" aria-expanded="true" aria-controls="collapse5_3">
Click to view the solution.
</button>
</h2>
<div id="collapse5_3" class="accordion-collapse collapse collapse"
aria-labelledby="heading5_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <span class="math inline">\frac{2}{9}</span></p>
<p>Since we are performing an outer merge, we can decompose the rows in
the merged DataFrame into three groups:</p>
<ul>
<li><p>Rows that are in <code>today</code> that are not in
<code>genres</code>. There are 9 of these (3 each for the 3 artists that
are in <code>today</code> and not <code>genres</code>).
<code>today</code> doesn’t have a <code>"genre"</code> column, and so
all of these <code>"genre"</code>s will be <code>NaN</code> upon
merging.</p></li>
<li><p>Rows that are in <code>genres</code> that are not in
<code>today</code>. There are 3 of these — one for
<code>"harry styles"</code>, one for <code>"glass animals"</code>, and
one for <code>"doja cat"</code>. 1 of these 3 have <code>"Pop"</code> in
the <code>"genre"</code> column.</p></li>
<li><p>Rows that are in both <code>today</code> and <code>genres</code>.
There are 6 of these — 3 for <code>"olivia rodrigo"</code> and 3 for
<code>"drake"</code> — and 3 of those rows contain <code>"Pop"</code> in
the <code>"genre"</code> column.</p></li>
</ul>
<p>Tallying things up, we see that there are <span class="math inline">9
+ 3 + 6 = 18</span> rows in the merged DataFrame overall, of which <span class="math inline">0 + 1 + 3 = 4</span> have <code>"Pop"</code> in the
<code>"genre"</code> column. Hence, the relevant fraction is <span class="math inline">\frac{4}{18} = \frac{2}{9}</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="section"><span class="math display"> </span></h2>
<h4
id="feedback-find-an-error-still-confused-have-a-suggestion-let-us-know-here.">👋
Feedback: Find an error? Still confused? Have a suggestion? Let us know
<a href="https://forms.gle/xK4DpWXh9rq8AKP37">here</a>.</h4>
<hr />
</body>
</html>
