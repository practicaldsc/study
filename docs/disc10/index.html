<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Generalization, Cross-Validation, and Regularization</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../assets/theme.css" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">Generalization, Cross-Validation, and
Regularization</h1>
</header>
<p><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<!-- add after bootstrap.min.css -->
<link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"/>
<!-- add after bootstrap.min.js or bootstrap.bundle.min.js -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script></p>
<!-- for difficulty gauges-->
<script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-B947E6J6H4"></script> -->
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  // gtag('js', new Date());

  // gtag('config', 'G-B947E6J6H4');
</script>
<p><a href="../index.html">← return to study.practicaldsc.org</a></p>
<hr />
<p>The problems in this worksheet are taken from past exams in similar
classes. Work on them <strong>on paper</strong>, since the exams you
take in this course will also be on paper. <br><br>We encourage you to
complete this worksheet in a live discussion section. Solutions will be
made available after all discussion sections have concluded. You don’t
need to submit your answers anywhere.<br><br><b>Note: We do not plan to
cover all problems here in the live discussion section</b>; the problems
we don’t cover can be used for extra practice.</p>
<hr />
<h2 id="problem-1">Problem 1</h2>
<p>Neerad wants to build a model that predicts the number of open rooms
a hotel has, given various other features. He has a training set with
1200 rows available to him for the purposes of training his model.</p>
<p><br></p>
<h3 id="problem-1.1">Problem 1.1</h3>
<p>Neerad fits a regression model using the <code>GPTRegression</code>
class. <code>GPTRegression</code> models have several hyperparameters
that can be tuned, including <code>context_length</code> and
<code>sentience</code>.</p>
<p>To choose between 5 possible values of the hyperparameter
<code>context_length</code>, Neerad performs <span
class="math inline">k</span>-fold cross-validation.</p>
<ol type="1">
<li>How many total times is a <code>GPTRegression</code> model fit?</li>
</ol>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">4k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">5k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">240k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">6000k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">4(k − 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">5(k − 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">240(k − 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">6000(k − 1)</span></p></li>
</ul>
<ol start="2" type="1">
<li>Suppose that every time a <code>GPTRegression</code> model is fit,
it appends the number of points in its training set to the list
<code>sizes</code>. Note that after performing cross- validation,
<code>len(sizes)</code> is equal to your answer to the previous
subpart.</li>
</ol>
<p>What is <code>sum(sizes)</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">4k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">5k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">240k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">6000k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">4(k − 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">5(k − 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">240(k − 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">6000(k − 1)</span></p></li>
</ul>
<p><br></p>
<h3 id="problem-1.2">Problem 1.2</h3>
<p>The average training error and validation error for all 5 candidate
values of <code>context_length</code> are given below.</p>
<center><img src="../../assets/images/disc10/validation.png" width=600></center>
<p>Fill in the blanks: As <code>context_length</code> increases, model
complexity <code>__(i)__</code>. The optimal choice of
<code>context_length</code> is <code>__(ii)__</code>; if we choose a
<code>context_length</code> any higher than that, our model will
<code>__(iii)__</code>.</p>
<ol type="1">
<li>What goes in blank (i)?</li>
</ol>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> increases</p></li>
<li><p><input type="radio" disabled="" /> decreases</p></li>
</ul>
<ol start="2" type="1">
<li>What goes in blank (ii)?</li>
</ol>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> 0.1</p></li>
<li><p><input type="radio" disabled="" /> 1</p></li>
<li><p><input type="radio" disabled="" /> 10</p></li>
<li><p><input type="radio" disabled="" /> 100</p></li>
<li><p><input type="radio" disabled="" /> 1000</p></li>
</ul>
<ol start="3" type="1">
<li>What goes in blank (iii)?</li>
</ol>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> overfit the training data and have high bias</p></li>
<li><p><input type="radio" disabled="" /> underfit the training data and have high bias</p></li>
<li><p><input type="radio" disabled="" /> overfit the training data and have low bias</p></li>
<li><p><input type="radio" disabled="" /> underfit the training data and have low bias</p></li>
</ul>
<p><br></p>
<hr />
<h2 id="problem-2">Problem 2</h2>
<p>Every week, Pranavi goes to her local grocery store and buys a
varying amount of vegetable but always buys exactly one pound of meat
(either beef, fish, or chicken). We use a linear regression model to
predict her total grocery bill. We’ve collected a dataset containing the
pounds of vegetables bought, the type of meat bought, and the total
bill. Below we display the first few rows of the dataset and two plots
generated using the entire training set.</p>
<center><img src='../../assets/images/disc10/dsc80_final_q9.png' width=65%></center>
<p><br></p>
<h3 id="problem-2.1">Problem 2.1</h3>
<p>Determine how each change below affects model bias and variance
compared to the model <span class="math inline">H(x)</span> described at
the top of this page. <strong>For each change (i., ii., iii., iv.),
choose all of the following that apply: increase bias, decrease bias,
increase variance, decrease variance.</strong></p>
<ol type="i">
<li>Add degree <span class="math inline">3</span> polynomial
features.</li>
<li>Add a feature of numbers chosen at random between <span
class="math inline">0</span> and <span
class="math inline">1</span>.</li>
<li>Collect <span class="math inline">100</span> more points for the
training set.</li>
<li>Don’t use the <code>'veg'</code> feature.</li>
</ol>
<p><br></p>
<h3 id="problem-2.2">Problem 2.2</h3>
<p>Suppose we predict <code>'total'</code> from <code>'veg'</code> using
<span class="math inline">8</span> models with different degree
polynomial features (degrees <span class="math inline">0</span> through
<span class="math inline">7</span>). Which of the following plots
display the training and validation errors of these models? Assume that
we plot the degree of the polynomial features on the x-axis, mean
squared error loss on the y-axis, and the plots share y-axes limits.</p>
<center><img src='../../assets/images/disc10/dsc80_final_plots.png' width=65%></center>
<p>Training Error:</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> A</p></li>
<li><p><input type="radio" disabled="" /> B</p></li>
<li><p><input type="radio" disabled="" /> C</p></li>
<li><p><input type="radio" disabled="" /> D</p></li>
</ul>
<p>Validation Error:</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> A</p></li>
<li><p><input type="radio" disabled="" /> B</p></li>
<li><p><input type="radio" disabled="" /> C</p></li>
<li><p><input type="radio" disabled="" /> D</p></li>
</ul>
<p><br></p>
<hr />
<h2 id="problem-3">Problem 3</h2>
<p>Consider the least squares regression model, <span
class="math inline">\vec{y} = X \vec{w}</span>. Assume that <span
class="math inline">X</span> and <span
class="math inline">\vec{y}</span> refer to the design matrix and true
response vector for our training data.</p>
<p>Let <span class="math inline">\vec{w}_\text{OLS}^*</span> be the
parameter vector that minimizes mean squared error without
regularization. Specifically:</p>
<p><span class="math inline">\vec{w}_\text{OLS}^*</span> = <span
class="math inline">\arg\underset{\vec{w}}{\min} \frac{1}{n} \| \vec{y}
- X \vec{w} \|^2_2</span></p>
<p>Let <span class="math inline">\vec{w}_\text{ridge}^*</span> be the
parameter vector that minimizes mean squared error with <span
class="math inline">L_2</span> regularization, using a non-negative
regularization hyperparameter <span class="math inline">\lambda</span>
(i.e. ridge regression). Specifically:</p>
<p><span class="math inline">\vec{w}_\text{ridge}^*</span> = <span
class="math inline">\arg\underset{\vec{w}}{\min} \frac{1}{n} \| y - X
\vec{w} \|^2_2 + \lambda \sum_{j=1}^{p} w_j^2</span></p>
<p>For each of the following problems, fill in the blank.</p>
<p><br></p>
<h3 id="problem-3.1">Problem 3.1</h3>
<p>If we set <span class="math inline">\lambda</span> = 0, then <span
class="math inline">\Vert \vec{w}_\text{OLS}^* \Vert^2_2</span> is
________ <span class="math inline">\Vert \vec{w}_\text{ridge}^*
\Vert^2_2</span></p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> less than</p></li>
<li><p><input type="radio" disabled="" /> equal to</p></li>
<li><p><input type="radio" disabled="" /> greater than</p></li>
<li><p><input type="radio" disabled="" /> impossible to tell</p></li>
</ul>
<p><br></p>
<h3 id="problem-3.2">Problem 3.2</h3>
<p>For each of the remaining parts, you can assume that <span
class="math inline">\lambda</span> is set such that the predicted
response vectors for our two models (<span class="math inline">\vec{y}^*
= X \vec{w}_\text{OLS}^*</span> and <span class="math inline">\vec{y}^*
= X \vec{w}_\text{ridge}^*</span>) is different.</p>
<p>The <strong>training</strong> MSE of the model <span
class="math inline">\vec{y}^* = X \vec{w}_\text{OLS}^*</span> is
________ than the model <span class="math inline">\vec{y}^* = X
\vec{w}_\text{ridge}^*</span>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> less than</p></li>
<li><p><input type="radio" disabled="" /> equal to</p></li>
<li><p><input type="radio" disabled="" /> greater than</p></li>
<li><p><input type="radio" disabled="" /> impossible to tell</p></li>
</ul>
<p><br></p>
<h3 id="problem-3.3">Problem 3.3</h3>
<p>Now, assume we’ve fit both models using our training data, and
evaluate both models on some unseen testing data.</p>
<p>The <strong>test</strong> MSE of the model <span
class="math inline">\vec{y}^* = X \vec{w}_\text{OLS}^*</span> is
________ than the model <span class="math inline">\vec{y}^* = X
\vec{w}_\text{ridge}^*</span>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> less than</p></li>
<li><p><input type="radio" disabled="" /> equal to</p></li>
<li><p><input type="radio" disabled="" /> greater than</p></li>
<li><p><input type="radio" disabled="" /> impossible to tell</p></li>
</ul>
<p><br></p>
<h3 id="problem-3.4">Problem 3.4</h3>
<p>Assume that our design matrix <span class="math inline">X</span>
contains a column of all ones. The sum of the residuals of our model
<span class="math inline">\vec{y}^* = X \vec{w}_\text{ridge}^*</span>
________.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> equal to 0</p></li>
<li><p><input type="radio" disabled="" /> not necessarily equal to 0</p></li>
</ul>
<p><br></p>
<h3 id="problem-3.5">Problem 3.5</h3>
<p>As we increase <span class="math inline">\lambda</span>, the bias of
the model <span class="math inline">\vec{y}^* = X
\vec{w}_\text{ridge}^*</span> tends to ________.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> increase</p></li>
<li><p><input type="radio" disabled="" /> stay the same</p></li>
<li><p><input type="radio" disabled="" /> decrease</p></li>
</ul>
<p><br></p>
<h3 id="problem-3.6">Problem 3.6</h3>
<p>As we increase <span class="math inline">\lambda</span>, the model
variance of the model <span class="math inline">\vec{y}^* = X
\vec{w}_\text{ridge}^*</span> tends to ________.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> increase</p></li>
<li><p><input type="radio" disabled="" /> stay the same</p></li>
<li><p><input type="radio" disabled="" /> decrease</p></li>
</ul>
<p><br></p>
<h3 id="problem-3.7">Problem 3.7</h3>
<p>As we increase <span class="math inline">\lambda</span>, the
observation variance of the model <span class="math inline">\vec{y}^* =
X \vec{w}_\text{ridge}^*</span> tends to ________.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> increase</p></li>
<li><p><input type="radio" disabled="" /> stay the same</p></li>
<li><p><input type="radio" disabled="" /> decrease</p></li>
</ul>
<p><br></p>
<hr />
<h2 id="problem-4">Problem 4</h2>
<p>One piece of information that may be useful as a feature is the
proportion of SAT test takers in a state in a given year that qualify
for free lunches in school. The Series <code>lunch_props</code> contains
8 values, each of which are either <code>"low"</code>,
<code>"medium"</code>, or <code>"high"</code>. Since we can’t use
strings as features in a model, we decide to encode these strings using
the following <code>Pipeline</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: The FunctionTransformer is only needed to change the result</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># of the OneHotEncoder from a &quot;sparse&quot; matrix to a regular matrix</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># so that it can be used with StandardScaler;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># it doesn&#39;t change anything mathematically.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>pl <span class="op">=</span> Pipeline([</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;ohe&quot;</span>, OneHotEncoder(drop<span class="op">=</span><span class="st">&quot;first&quot;</span>)),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;ft&quot;</span>, FunctionTransformer(<span class="kw">lambda</span> X: X.toarray())),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;ss&quot;</span>, StandardScaler())</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>])</span></code></pre></div>
<p>After calling <code>pl.fit(lunch_props)</code>,
<code>pl.transform(lunch_props)</code> evaluates to the following
array:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>array([[ <span class="fl">1.29099445</span>, <span class="op">-</span><span class="fl">0.37796447</span>],</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.77459667</span>, <span class="op">-</span><span class="fl">0.37796447</span>],</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.77459667</span>, <span class="op">-</span><span class="fl">0.37796447</span>],</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.77459667</span>,  <span class="fl">2.64575131</span>],</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">1.29099445</span>, <span class="op">-</span><span class="fl">0.37796447</span>],</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">1.29099445</span>, <span class="op">-</span><span class="fl">0.37796447</span>],</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.77459667</span>, <span class="op">-</span><span class="fl">0.37796447</span>],</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.77459667</span>, <span class="op">-</span><span class="fl">0.37796447</span>]])</span></code></pre></div>
<p>and <code>pl.named_steps["ohe"].get_feature_names()</code> evaluates
to the following array:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>array([<span class="st">&quot;x0_low&quot;</span>, <span class="st">&quot;x0_med&quot;</span>], dtype<span class="op">=</span><span class="bu">object</span>)</span></code></pre></div>
<p>Fill in the blanks: Given the above information, we can conclude that
<code>lunch_props</code> has <strong>(a)</strong> value(s) equal to
<code>"low"</code>, <strong>(b)</strong> value(s) equal to
<code>"medium"</code>, and <strong>(c)</strong> value(s) equal to
<code>"high"</code>. <em>(Note: You should write one positive integer in
each box such that the numbers add up to 8.)</em></p>
<p>What goes in the blanks?</p>
<hr />
<h2 id="problem-5">Problem 5</h2>
<p>Suppose we have one qualitative variable that that we convert to
numerical values using one- hot encoding. We’ve shown the first four
rows of the resulting design matrix below:</p>
<center><img src='../assets/images/disc10/matrix.png' width=400></center>
<p><br></p>
<h3 id="problem-5.1">Problem 5.1</h3>
<p>Say we train a linear model <span class="math inline">m_1</span> on
these data. Then, we replace all of the 1 values in column
<strong>a</strong> with 3’s and all of the 1 values in column
<strong>b</strong> with 2’s and train a new linear model <span
class="math inline">m_2</span>. Neither <span
class="math inline">m_1</span> nor <span class="math inline">m_2</span>
have an intercept term. On the training data, the average squared loss
for <span class="math inline">m_1</span> will be ________ that of <span
class="math inline">m_2</span>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> greater than</p></li>
<li><p><input type="radio" disabled="" /> less than</p></li>
<li><p><input type="radio" disabled="" /> equal to</p></li>
<li><p><input type="radio" disabled="" /> impossible to tell</p></li>
</ul>
<p><br></p>
<h3 id="problem-5.2">Problem 5.2</h3>
<p>To account for the intercept term, we add a column of all ones to our
design matrix from part a. That is, the resulting design matrix has four
columns: <strong>a</strong> with 3’s instead of 1’s, <strong>b</strong>
with 2’s instead of 1’s, <strong>c</strong>, and a column of all ones.
What is the rank of the new design matrix with these four columns?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> 1</p></li>
<li><p><input type="radio" disabled="" /> 2</p></li>
<li><p><input type="radio" disabled="" /> 3</p></li>
<li><p><input type="radio" disabled="" /> 4</p></li>
</ul>
<p><br></p>
<h3 id="problem-5.3">Problem 5.3</h3>
<p>Suppose we divide our sampling frame into three clusters of people,
numbered 1, 2, and 3. After we survey people, along with our survey
results, we save their cluster number as a new feature in our design
matrix. Before training a model, what should we do with the cluster
column? (Note: This part is independent of parts a and b.)</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Leave as is</p></li>
<li><p><input type="radio" disabled="" /> One-hot encode it</p></li>
<li><p><input type="radio" disabled="" /> Normalize it</p></li>
<li><p><input type="radio" disabled="" /> Use bag of words</p></li>
</ul>
<p><br></p>
<hr />
<h2 id="problem-6">Problem 6</h2>
<p>We will aim to build a classifier that takes in demographic
information about a state from a particular year and predicts whether or
not the state’s mean math score is higher than its mean verbal score
that year.</p>
<p>In honor of the
<a href="https://www.reddit.com/r/UCSD/comments/11o0w9r/chicken_event/">rotisserie
chicken event</a> on UCSD’s campus in March of 2023,
<code>sklearn</code> released a new classifier class called
<code>ChickenClassifier</code>.</p>
<p><br></p>
<h3 id="problem-6.1">Problem 6.1</h3>
<p><code>ChickenClassifier</code>s have many hyperparameters, one of
which is <code>height</code>. As we increase the value of
<code>height</code>, the model variance of the resulting
<code>ChickenClassifier</code> also increases.</p>
<p>First, we consider the training and testing accuracy of a
<code>ChickenClassifier</code> trained using various values of
<code>height</code>. Consider the plot below.</p>
<center><img src='../assets/images/disc10/accuracy.png' width=30%></center>
<ul>
<li>Note that <strong>accuracy</strong> is a metric that measures how
well a classifier performs by comparing the number of correct
predictions to the total number of predictions.</li>
</ul>
<p>Which of the following depicts <strong>training accuracy
vs. <code>height</code></strong>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Option 1</p></li>
<li><p><input type="radio" disabled="" /> Option 2</p></li>
<li><p><input type="radio" disabled="" /> Option 3</p></li>
</ul>
<p>Which of the following depicts <strong>testing accuracy
vs. <code>height</code></strong>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Option 1</p></li>
<li><p><input type="radio" disabled="" /> Option 2</p></li>
<li><p><input type="radio" disabled="" /> Option 3</p></li>
</ul>
<p><br></p>
<p><code>ChickenClassifier</code>s have another hyperparameter,
<code>color</code>, for which there are four possible values:
<code>"yellow"</code>, <code>"brown"</code>, <code>"red"</code>, and
<code>"orange"</code>. To find the optimal value of <code>color</code>,
we perform <span class="math inline">k</span>-fold cross-validation with
<span class="math inline">k=4</span>. The results are given in the table
below.</p>
<center><img src='../assets/images/disc10/CV.png' width=30%></center>
<p><br></p>
<h3 id="problem-6.2">Problem 6.2</h3>
<p>Which value of <code>color</code> has the best average validation
accuracy?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>"yellow"</code></p></li>
<li><p><input type="radio" disabled="" /> <code>"brown"</code></p></li>
<li><p><input type="radio" disabled="" /> <code>"red"</code></p></li>
<li><p><input type="radio" disabled="" /> <code>"orange"</code></p></li>
</ul>
<p><br></p>
<h3 id="problem-6.3">Problem 6.3</h3>
<p>True or False: It is possible for a hyperparameter value to have the
best average validation accuracy across all folds, but not have the best
validation accuracy in any one particular fold.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<p><br></p>
<h3 id="problem-6.4">Problem 6.4</h3>
<p>Now, instead of finding the best <code>height</code> and best
<code>color</code> individually, we decide to perform a grid search that
uses <span class="math inline">k</span>-fold cross-validation to find
the combination of <code>height</code> and <code>color</code> with the
best average validation accuracy.</p>
<p>For the purposes of this question, assume that:</p>
<ul>
<li>We are performing <span class="math inline">k</span>-fold cross
validation.</li>
<li>Our training set contains <span class="math inline">n</span> rows,
where <span class="math inline">n</span> is greater than 5 and is a
multiple of <span class="math inline">k</span>.</li>
<li>There are <span class="math inline">h_1</span> possible values of
<code>height</code> and <span class="math inline">h_2</span> possible
values of <code>color</code>.</li>
</ul>
<p>Consider the following three subparts:</p>
<ul>
<li>A. What is the size of each fold?</li>
<li>B. How many times is row 5 in the training set used for
training?</li>
<li>C. How many times is row 5 in the training set used for
validation?</li>
</ul>
<p>Choose from the following options.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">\frac{k}{n}</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">\frac{n}{k}</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">\frac{n}{k} \cdot (k - 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">h_1h_2k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">h_1h_2(k-1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">\frac{nh_1h_2}{k}</span></p></li>
<li><p><input type="radio" disabled="" /> None of the above</p></li>
</ul>
<p><br></p>
<hr />
<h2 id="problem-7">Problem 7</h2>
<p>Suppose we build a binary classifier that uses a song’s
<code>"track_name"</code> and <code>"artist_names"</code> to predict
whether its genre is <code>"Hip-Hop/Rap"</code> (1) or not (0).</p>
<p>For our classifier, we decide to use a brand-new model built into
<code>sklearn</code> called the<br />
<code>BillyClassifier</code>. A <code>BillyClassifier</code> instance
has three hyperparameters that we’d like to tune. Below, we show a
dictionary containing the values for each hyperparameter that we’d like
to try:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>hyp_grid <span class="op">=</span> {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;radius&quot;</span>: [<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">100</span>], <span class="co"># 12 total</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;inflection&quot;</span>: [<span class="op">-</span><span class="dv">5</span>, <span class="op">-</span><span class="dv">4</span>, <span class="op">-</span><span class="dv">3</span>, <span class="op">-</span><span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], <span class="co"># 10 total</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;color&quot;</span>: [<span class="st">&quot;red&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;purple&quot;</span>] <span class="co"># 5 total</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>To find the best combination of hyperparameters for our
<code>BillyClassifier</code>, we first conduct a train-test split, which
we use to create a training set with 800 rows. We then use
<code>GridSearchCV</code> to conduct <span
class="math inline">k</span>-fold cross-validation for each combination
of hyperparameters in <code>hyp_grid</code>, with <span
class="math inline">k=4</span>.</p>
<p><br></p>
<h3 id="problem-7.1">Problem 7.1</h3>
<p>When we call <code>GridSearchCV</code>, how many times is a
<code>BillyClassifier</code> instance trained in total? Give your answer
as an integer.</p>
<p><br></p>
<h3 id="problem-7.2">Problem 7.2</h3>
<p>In each of the 4 folds of the data, how large is the training set,
and how large is the validation set? Give your answers as integers.</p>
<p>size of training set =</p>
<p>size of validation set =</p>
<p><br></p>
<h3 id="problem-7.3">Problem 7.3</h3>
<p>Suppose that after fitting a <code>GridSearchCV</code> instance, its
<code>best_params_</code> attribute is</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>{<span class="st">&quot;radius&quot;</span>: <span class="dv">8</span>, <span class="st">&quot;inflection&quot;</span>: <span class="dv">4</span>, <span class="st">&quot;color&quot;</span>: <span class="st">&quot;blue&quot;</span>}</span></code></pre></div>
<p>Select all true statements below.</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> The specific combination of hyperparameters in
<code>best_params_</code> had the highest average training accuracy
among all combinations of hyperparameters in <code>hyp_grid</code>.</p></li>
<li><p><input type="checkbox" disabled="" /> The specific combination of hyperparameters in
<code>best_params_</code> had the highest average validation accuracy
among all combinations of hyperparameters in <code>hyp_grid</code>.</p></li>
<li><p><input type="checkbox" disabled="" /> The specific combination of hyperparameters in
<code>best_params_</code> had the highest training accuracy among all
combinations of hyperparameters in <code>hyp_grid</code>, in each of the
4 folds of the training data.</p></li>
<li><p><input type="checkbox" disabled="" /> The specific combination of hyperparameters in
<code>best_params_</code> had the highest validation accuracy among all
combinations of hyperparameters in <code>hyp_grid</code>, in each of the
4 folds of the training data.</p></li>
<li><p><input type="checkbox" disabled="" /> A <code>BillyClassifier</code> that is fit using the specific
combination of hyperparameters in <code>best_params_</code> is
guaranteed to have the best accuracy on unseen testing data among all
combinations of hyperparameters in <code>hyp_grid</code>.</p></li>
</ul>
<p><br></p>
<hr />
<h2 id="section"><span class="math display"> </span></h2>
<h4
id="feedback-find-an-error-still-confused-have-a-suggestion-let-us-know-here.">👋
Feedback: Find an error? Still confused? Have a suggestion? Let us know
<a href="https://forms.gle/xK4DpWXh9rq8AKP37">here</a>.</h4>
<hr />
</body>
</html>
