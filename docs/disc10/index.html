<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Cross-Validation and Regularization</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../assets/theme.css" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">Cross-Validation and Regularization</h1>
</header>
<p><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<!-- add after bootstrap.min.css -->
<link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"/>
<!-- add after bootstrap.min.js or bootstrap.bundle.min.js -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script></p>
<!-- for difficulty gauges-->
<script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-B947E6J6H4"></script> -->
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  // gtag('js', new Date());

  // gtag('config', 'G-B947E6J6H4');
</script>
<p><a href="../index.html">← return to study.practicaldsc.org</a></p>
<hr />
<p>The problems in this worksheet are taken from past exams in similar
classes. Work on them <strong>on paper</strong>, since the exams you
take in this course will also be on paper. <br><br>We encourage you to
complete this worksheet in a live discussion section. Solutions will be
made available after all discussion sections have concluded. You don’t
need to submit your answers anywhere.<br><br><b>Note: We do not plan to
cover all problems here in the live discussion section</b>; the problems
we don’t cover can be used for extra practice.</p>
<hr />
<h2 id="problem-1">Problem 1</h2>
<p>Neerad wants to build a model that predicts the number of open rooms
a hotel has, given various other features. He has a training set with
1200 rows available to him for the purposes of training his model.</p>
<p><br></p>
<h3 id="problem-1.1">Problem 1.1</h3>
<p>Neerad fits a regression model using the <code>GPTRegression</code>
class. <code>GPTRegression</code> models have several hyperparameters
that can be tuned, including <code>context_length</code> and
<code>sentience</code>.</p>
<p>To choose between 5 possible values of the hyperparameter
<code>context_length</code>, Neerad performs <span
class="math inline">k</span>-fold cross-validation.</p>
<ol type="1">
<li>How many total times is a <code>GPTRegression</code> model fit?</li>
</ol>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">4k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">5k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">240k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">6000k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">4(k − 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">5(k − 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">240(k − 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">6000(k − 1)</span></p></li>
</ul>
<ol start="2" type="1">
<li>Suppose that every time a <code>GPTRegression</code> model is fit,
it appends the number of points in its training set to the list
<code>sizes</code>. Note that after performing cross- validation,
<code>len(sizes)</code> is equal to your answer to the previous
subpart.</li>
</ol>
<p>What is <code>sum(sizes)</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">4k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">5k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">240k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">6000k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">4(k − 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">5(k − 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">240(k − 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">6000(k − 1)</span></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_1" aria-expanded="true" aria-controls="collapse1_1">
Click to view the solution.
</button>
</h2>
<div id="collapse1_1" class="accordion-collapse collapse"
aria-labelledby="heading1_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<ol type="1">
<li><span class="math inline">5k</span></li>
<li><span class="math inline">6000(k-1)</span></li>
</ol>
<p>When we do <span class="math inline">k</span>-fold cross-validation
for one single hyperparameter value, we split the dataset into <span class="math inline">k</span> folds, and in each iteration <span class="math inline">i</span>, train the model on the remaining <span class="math inline">k-1</span> folds and evaluate on fold <span class="math inline">i</span>. Since every fold is left out and evaluated
on once, the model is fit in total <span class="math inline">k</span>
times. We do this once for every hyperparameter value we want to test,
so the total number of model fits required is <span class="math inline">5k</span>.</p>
<p>In part 2, we can note that each model fit is performed on the same
size of data – the size of the remaining <span class="math inline">k-1</span> folds when we hold out a single fold.
This size is <span class="math inline">1 - \frac{1}{k} =
\frac{k-1}{k}</span> times the size of the entire dataset, in this case,
<span class="math inline">1200 \cdot \frac{k-1}{k}</span>, and we fit a
model on a dataset of this size <span class="math inline">5k</span>
times. So, the sum of the training sizes for each model fit is:</p>
<p><span class="math display">5k \cdot \frac{k-1}{k} \cdot 1200 =
6000(k-1)</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.2">Problem 1.2</h3>
<p>The average training error and validation error for all 5 candidate
values of <code>context_length</code> are given below.</p>
<center><img src="../../assets/images/disc10/validation.png" width=600></center>
<p>Fill in the blanks: As <code>context_length</code> increases, model
complexity <code>__(i)__</code>. The optimal choice of
<code>context_length</code> is <code>__(ii)__</code>; if we choose a
<code>context_length</code> any higher than that, our model will
<code>__(iii)__</code>.</p>
<ol type="1">
<li>What goes in blank (i)?</li>
</ol>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> increases</p></li>
<li><p><input type="radio" disabled="" /> decreases</p></li>
</ul>
<ol start="2" type="1">
<li>What goes in blank (ii)?</li>
</ol>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> 0.1</p></li>
<li><p><input type="radio" disabled="" /> 1</p></li>
<li><p><input type="radio" disabled="" /> 10</p></li>
<li><p><input type="radio" disabled="" /> 100</p></li>
<li><p><input type="radio" disabled="" /> 1000</p></li>
</ul>
<ol start="3" type="1">
<li>What goes in blank (iii)?</li>
</ol>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> overfit the training data and have high bias</p></li>
<li><p><input type="radio" disabled="" /> underfit the training data and have high bias</p></li>
<li><p><input type="radio" disabled="" /> overfit the training data and have low bias</p></li>
<li><p><input type="radio" disabled="" /> underfit the training data and have low bias</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_2" aria-expanded="true" aria-controls="collapse1_2">
Click to view the solution.
</button>
</h2>
<div id="collapse1_2" class="accordion-collapse collapse"
aria-labelledby="heading1_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<ol type="1">
<li>decreases</li>
<li>100</li>
<li>underfit the training data and have high bias</li>
</ol>
<p>In part 1, we can see that as <code>context_length</code> increases,
the training error increases, and the model performs worse. In general,
higher model complexity leads to better model performance, so here,
increasing <code>context_length</code> is <em>reducing</em> model
complexity.</p>
<p>In part 2, we will choose a <code>context_length</code> of 100, since
this parameterization leads to the best validation performance. If we
increase <code>context_length</code> further, the validation error
increases.</p>
<p>In part 3, since increased <code>context_length</code> indicates
<em>less</em> complexity and worse training performance, increasing the
<code>context_length</code> further would lead to underfitting, as the
model would lack the expressiveness or number of parameters required to
capture the data. Since training error represents model bias, and since
high variance is associated with <em>over</em>fitting, a further
increase in <code>context_length</code> would mean a more biased
model.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-2">Problem 2</h2>
<p>Consider the least squares regression model, <span
class="math inline">\vec{h} = X \vec{w}</span>. Assume that <span
class="math inline">X</span> and <span
class="math inline">\vec{h}</span> refer to the design matrix and
hypothesis vector for our training data, and <span
class="math inline">\vec y</span> is the true observation vector.</p>
<p>Let <span class="math inline">\vec{w}_\text{OLS}^*</span> be the
parameter vector that minimizes mean squared error without
regularization. Specifically:</p>
<p><span class="math inline">\vec{w}_\text{OLS}^*</span> = <span
class="math inline">\arg\underset{\vec{w}}{\min} \frac{1}{n} \| \vec{y}
- X \vec{w} \|^2_2</span></p>
<p>Let <span class="math inline">\vec{w}_\text{ridge}^*</span> be the
parameter vector that minimizes mean squared error with <span
class="math inline">L_2</span> regularization, using a non-negative
regularization hyperparameter <span class="math inline">\lambda</span>
(i.e. ridge regression). Specifically:</p>
<p><span class="math inline">\vec{w}_\text{ridge}^*</span> = <span
class="math inline">\arg\underset{\vec{w}}{\min} \frac{1}{n} \| \vec y -
X \vec{w} \|^2_2 + \lambda \sum_{j=1}^{p} w_j^2</span></p>
<p>For each of the following problems, fill in the blank.</p>
<p><br></p>
<h3 id="problem-2.1">Problem 2.1</h3>
<p>If we set <span class="math inline">\lambda</span> = 0, then <span
class="math inline">\Vert \vec{w}_\text{OLS}^* \Vert^2_2</span> is
<strong>____</strong> <span class="math inline">\Vert
\vec{w}_\text{ridge}^* \Vert^2_2</span></p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> less than</p></li>
<li><p><input type="radio" disabled="" /> equal to</p></li>
<li><p><input type="radio" disabled="" /> greater than</p></li>
<li><p><input type="radio" disabled="" /> impossible to tell</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_1" aria-expanded="true" aria-controls="collapse2_1">
Click to view the solution.
</button>
</h2>
<div id="collapse2_1" class="accordion-collapse collapse"
aria-labelledby="heading2_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<p>equal to</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.2">Problem 2.2</h3>
<p>For each of the remaining parts, you can assume that <span
class="math inline">\lambda</span> is set such that the predicted
response vectors for our two models (<span class="math inline">\vec{h} =
X \vec{w}_\text{OLS}^*</span> and <span class="math inline">\vec{h} = X
\vec{w}_\text{ridge}^*</span>) is different.</p>
<p>The <strong>training</strong> MSE of the model <span
class="math inline">\vec{h} = X \vec{w}_\text{OLS}^*</span> is
<strong>____</strong> than the model <span class="math inline">\vec{h} =
X \vec{w}_\text{ridge}^*</span>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> less than</p></li>
<li><p><input type="radio" disabled="" /> equal to</p></li>
<li><p><input type="radio" disabled="" /> greater than</p></li>
<li><p><input type="radio" disabled="" /> impossible to tell</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_2" aria-expanded="true" aria-controls="collapse2_2">
Click to view the solution.
</button>
</h2>
<div id="collapse2_2" class="accordion-collapse collapse"
aria-labelledby="heading2_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<p>less than</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.3">Problem 2.3</h3>
<p>Now, assume we’ve fit both models using our training data, and
evaluate both models on some unseen testing data.</p>
<p>The <strong>test</strong> MSE of the model <span
class="math inline">\vec{h} = X \vec{w}_\text{OLS}^*</span> is
<strong>____</strong> than the model <span class="math inline">\vec{h} =
X \vec{w}_\text{ridge}^*</span>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> less than</p></li>
<li><p><input type="radio" disabled="" /> equal to</p></li>
<li><p><input type="radio" disabled="" /> greater than</p></li>
<li><p><input type="radio" disabled="" /> impossible to tell</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_3" aria-expanded="true" aria-controls="collapse2_3">
Click to view the solution.
</button>
</h2>
<div id="collapse2_3" class="accordion-collapse collapse"
aria-labelledby="heading2_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<p>impossible to tell</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.4">Problem 2.4</h3>
<p>Assume that our design matrix <span class="math inline">X</span>
contains a column of all ones. The sum of the residuals of our model
<span class="math inline">\vec{h} = X \vec{w}_\text{ridge}^*</span>
<strong>____</strong>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> equal to 0</p></li>
<li><p><input type="radio" disabled="" /> not necessarily equal to 0</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_4" aria-expanded="true" aria-controls="collapse2_4">
Click to view the solution.
</button>
</h2>
<div id="collapse2_4" class="accordion-collapse collapse"
aria-labelledby="heading2_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<p>not necessarily equal to 0</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.5">Problem 2.5</h3>
<p>As we increase <span class="math inline">\lambda</span>, the bias of
the model <span class="math inline">\vec{h} = X
\vec{w}_\text{ridge}^*</span> tends to <strong>____</strong>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> increase</p></li>
<li><p><input type="radio" disabled="" /> stay the same</p></li>
<li><p><input type="radio" disabled="" /> decrease</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_5">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_5" aria-expanded="true" aria-controls="collapse2_5">
Click to view the solution.
</button>
</h2>
<div id="collapse2_5" class="accordion-collapse collapse"
aria-labelledby="heading2_5" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<p>increase</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.6">Problem 2.6</h3>
<p>As we increase <span class="math inline">\lambda</span>, the model
variance of the model <span class="math inline">\vec{h} = X
\vec{w}_\text{ridge}^*</span> tends to <strong>____</strong>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> increase</p></li>
<li><p><input type="radio" disabled="" /> stay the same</p></li>
<li><p><input type="radio" disabled="" /> decrease</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_6">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_6" aria-expanded="true" aria-controls="collapse2_6">
Click to view the solution.
</button>
</h2>
<div id="collapse2_6" class="accordion-collapse collapse"
aria-labelledby="heading2_6" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<p>decrease</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.7">Problem 2.7</h3>
<p>As we increase <span class="math inline">\lambda</span>, the
observation variance of the model <span class="math inline">\vec{h} = X
\vec{w}_\text{ridge}^*</span> tends to <strong>____</strong>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> increase</p></li>
<li><p><input type="radio" disabled="" /> stay the same</p></li>
<li><p><input type="radio" disabled="" /> decrease</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_7">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_7" aria-expanded="true" aria-controls="collapse2_7">
Click to view the solution.
</button>
</h2>
<div id="collapse2_7" class="accordion-collapse collapse"
aria-labelledby="heading2_7" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<p>stay the same</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-3">Problem 3</h2>
<p>Suppose we want to use LASSO (i.e. minimize mean squared error with
<span class="math inline">L_1</span> regularization) to fit a linear
model that predicts the number of ingredients in a product given its
price and rating.</p>
<p>Let <span class="math inline">\lambda</span> be a non-negative
regularization hyperparameter. Using cross-validation, we determine the
average validation mean squared error — which we’ll refer to as AVMSE in
this question — for several different choices of <span
class="math inline">\lambda</span>. The results are given below.</p>
<center><img src="../assets/images/disc10/avmse.png" width=600></center>
<p><br></p>
<h3 id="problem-3.1">Problem 3.1</h3>
<p>As <span class="math inline">\lambda</span> increases, what happens
to model complexity and model variance?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Model complexity and model variance both increase.</p></li>
<li><p><input type="radio" disabled="" /> Model complexity increases while model variance decreases.</p></li>
<li><p><input type="radio" disabled="" /> Model complexity decreases while model variance increases.</p></li>
<li><p><input type="radio" disabled="" /> Model complexity and model variance both decrease.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_1" aria-expanded="true" aria-controls="collapse3_1">
Click to view the solution.
</button>
</h2>
<div id="collapse3_1" class="accordion-collapse collapse"
aria-labelledby="heading3_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: Model complexity and model variance both
decrease.</p>
<p>As <span class="math inline">\lambda</span> increases, the <span class="math inline">L_1</span> regularization penalizes larger
coefficient values more heavily, forcing the model to forget the details
in the training data and focus on the bigger picture. This effectively
reduces the number of non-zero coefficients, decreasing model
complexity. Since model complexity and model variance are the same
thing, variance also decreases.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.2">Problem 3.2</h3>
<p>What does the value <span class="math inline">A</span> on the graph
above correspond to?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> The AVMSE of the <span class="math inline">\lambda</span> we’d choose
to use to train a model.</p></li>
<li><p><input type="radio" disabled="" /> The AVMSE of an unregularized multiple linear regression model.</p></li>
<li><p><input type="radio" disabled="" /> The AVMSE of the constant model.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_2" aria-expanded="true" aria-controls="collapse3_2">
Click to view the solution.
</button>
</h2>
<div id="collapse3_2" class="accordion-collapse collapse"
aria-labelledby="heading3_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: The AVMSE of an unregularized multiple
linear regression model.</p>
<p>Point <span class="math inline">A</span> represents the case where
<span class="math inline">\lambda = 0</span>, meaning no regularization
is applied. This corresponds to an unregularized multiple linear
regression model.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.3">Problem 3.3</h3>
<p>What does the value <span class="math inline">B</span> on the graph
above correspond to?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> The AVMSE of the <span class="math inline">\lambda</span> we’d choose
to use to train a model.</p></li>
<li><p><input type="radio" disabled="" /> The AVMSE of an unregularized multiple linear regression model.</p></li>
<li><p><input type="radio" disabled="" /> The AVMSE of the constant model.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_3" aria-expanded="true" aria-controls="collapse3_3">
Click to view the solution.
</button>
</h2>
<div id="collapse3_3" class="accordion-collapse collapse"
aria-labelledby="heading3_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: The AVMSE of the <span class="math inline">\lambda</span> we’d choose to use to train a
model.</p>
<p>Point <span class="math inline">B</span> is the minimum point on the
graph, indicating the optimal <span class="math inline">\lambda</span>
value that minimizes the AVMSE. This is because we don’t typically
regularize the intercept term’s coefficient, <span class="math inline">w_0^*</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.4">Problem 3.4</h3>
<p>What does the value <span class="math inline">C</span> on the graph
above correspond to?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> The AVMSE of the <span class="math inline">\lambda</span> we’d choose
to use to train a model.</p></li>
<li><p><input type="radio" disabled="" /> The AVMSE of an unregularized multiple linear regression model.</p></li>
<li><p><input type="radio" disabled="" /> The AVMSE of the constant model.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_4" aria-expanded="true" aria-controls="collapse3_4">
Click to view the solution.
</button>
</h2>
<div id="collapse3_4" class="accordion-collapse collapse"
aria-labelledby="heading3_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: The AVMSE of the constant model.</p>
<p>Point <span class="math inline">C</span> represents the AVMSE when
<span class="math inline">\lambda</span> is very large, effectively
forcing all coefficients to zero. This corresponds to the constant
model.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-4">Problem 4</h2>
<p>Suppose we build a binary classifier that uses a song’s
<code>"track_name"</code> and <code>"artist_names"</code> to predict
whether its genre is <code>"Hip-Hop/Rap"</code> (1) or not (0).</p>
<p>For our classifier, we decide to use a brand-new model built into
<code>sklearn</code> called the<br />
<code>BillyClassifier</code>. A <code>BillyClassifier</code> instance
has three hyperparameters that we’d like to tune. Below, we show a
dictionary containing the values for each hyperparameter that we’d like
to try:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>hyp_grid <span class="op">=</span> {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;radius&quot;</span>: [<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">100</span>], <span class="co"># 12 total</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;inflection&quot;</span>: [<span class="op">-</span><span class="dv">5</span>, <span class="op">-</span><span class="dv">4</span>, <span class="op">-</span><span class="dv">3</span>, <span class="op">-</span><span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], <span class="co"># 10 total</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;color&quot;</span>: [<span class="st">&quot;red&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;purple&quot;</span>] <span class="co"># 5 total</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>To find the best combination of hyperparameters for our
<code>BillyClassifier</code>, we first conduct a train-test split, which
we use to create a training set with 800 rows. We then use
<code>GridSearchCV</code> to conduct <span
class="math inline">k</span>-fold cross-validation for each combination
of hyperparameters in <code>hyp_grid</code>, with <span
class="math inline">k=4</span>.</p>
<p><br></p>
<h3 id="problem-4.1">Problem 4.1</h3>
<p>When we call <code>GridSearchCV</code>, how many times is a
<code>BillyClassifier</code> instance trained in total? Give your answer
as an integer.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_1" aria-expanded="true" aria-controls="collapse4_1">
Click to view the solution.
</button>
</h2>
<div id="collapse4_1" class="accordion-collapse collapse"
aria-labelledby="heading4_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> 2400</p>
<p>There are <span class="math inline">12 \cdot 10 \cdot 5 = 600</span>
combinations of hyperparameters. For each combination of
hyperparameters, we will train a <code>BillyClassifier</code> with that
combination of hyperparameters <span class="math inline">k = 4</span>
times. So, the total number of <code>BillyClassifier</code> instances
that will be trained is <span class="math inline">600 \cdot 4 =
2400</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-4.2">Problem 4.2</h3>
<p>In each of the 4 folds of the data, how large is the training set,
and how large is the validation set? Give your answers as integers.</p>
<p>size of training set =</p>
<p>size of validation set =</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_2" aria-expanded="true" aria-controls="collapse4_2">
Click to view the solution.
</button>
</h2>
<div id="collapse4_2" class="accordion-collapse collapse"
aria-labelledby="heading4_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> 600, 200</p>
<p>Since we performed <span class="math inline">k=4</span>
cross-validation, we must divide the training set into four disjoint
groups each of the same size. <span class="math inline">\frac{800}{4} =
200</span>, so each group is of size 200. Each time we perform cross
validation, one group is used for validation, and the other three are
used for training, so the validation set size is 200 and the training
set size is <span class="math inline">200 \cdot 3 = 600</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-4.3">Problem 4.3</h3>
<p>Suppose that after fitting a <code>GridSearchCV</code> instance, its
<code>best_params_</code> attribute is</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>{<span class="st">&quot;radius&quot;</span>: <span class="dv">8</span>, <span class="st">&quot;inflection&quot;</span>: <span class="dv">4</span>, <span class="st">&quot;color&quot;</span>: <span class="st">&quot;blue&quot;</span>}</span></code></pre></div>
<p>Select all true statements below.</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> The specific combination of hyperparameters in
<code>best_params_</code> had the highest average training accuracy
among all combinations of hyperparameters in <code>hyp_grid</code>.</p></li>
<li><p><input type="checkbox" disabled="" /> The specific combination of hyperparameters in
<code>best_params_</code> had the highest average validation accuracy
among all combinations of hyperparameters in <code>hyp_grid</code>.</p></li>
<li><p><input type="checkbox" disabled="" /> The specific combination of hyperparameters in
<code>best_params_</code> had the highest training accuracy among all
combinations of hyperparameters in <code>hyp_grid</code>, in each of the
4 folds of the training data.</p></li>
<li><p><input type="checkbox" disabled="" /> The specific combination of hyperparameters in
<code>best_params_</code> had the highest validation accuracy among all
combinations of hyperparameters in <code>hyp_grid</code>, in each of the
4 folds of the training data.</p></li>
<li><p><input type="checkbox" disabled="" /> A <code>BillyClassifier</code> that is fit using the specific
combination of hyperparameters in <code>best_params_</code> is
guaranteed to have the best accuracy on unseen testing data among all
combinations of hyperparameters in <code>hyp_grid</code>.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_3" aria-expanded="true" aria-controls="collapse4_3">
Click to view the solution.
</button>
</h2>
<div id="collapse4_3" class="accordion-collapse collapse"
aria-labelledby="heading4_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> Option B</p>
<p>When performing cross validation, we select the combination of
hyperparameters that had the highest <strong>average validation
accuracy</strong> across all four folds of the data. That is, by
definition, how <code>best_params_</code> came to be. None of the other
options are guaranteed to be true.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-5">Problem 5</h2>
<p>We will aim to build a classifier that takes in demographic
information about a state from a particular year and predicts whether or
not the state’s mean math score is higher than its mean verbal score
that year.</p>
<p>In honor of the
<a href="https://www.reddit.com/r/UCSD/comments/11o0w9r/chicken_event/">rotisserie
chicken event</a> on UCSD’s campus in March of 2023,
<code>sklearn</code> released a new classifier class called
<code>ChickenClassifier</code>.</p>
<p><br></p>
<h3 id="problem-5.1">Problem 5.1</h3>
<p><code>ChickenClassifier</code>s have many hyperparameters, one of
which is <code>height</code>. As we increase the value of
<code>height</code>, the model variance of the resulting
<code>ChickenClassifier</code> also increases.</p>
<p>First, we consider the training and testing accuracy of a
<code>ChickenClassifier</code> trained using various values of
<code>height</code>. Consider the plot below.</p>
<center><img src='../assets/images/disc10/accuracy.png' width=30%></center>
<ul>
<li>Note that <strong>accuracy</strong> is a metric that measures how
well a classifier performs by comparing the number of correct
predictions to the total number of predictions.</li>
</ul>
<p>Which of the following depicts <strong>training accuracy
vs. <code>height</code></strong>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Option 1</p></li>
<li><p><input type="radio" disabled="" /> Option 2</p></li>
<li><p><input type="radio" disabled="" /> Option 3</p></li>
</ul>
<p>Which of the following depicts <strong>testing accuracy
vs. <code>height</code></strong>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Option 1</p></li>
<li><p><input type="radio" disabled="" /> Option 2</p></li>
<li><p><input type="radio" disabled="" /> Option 3</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_1" aria-expanded="true" aria-controls="collapse5_1">
Click to view the solution.
</button>
</h2>
<div id="collapse5_1" class="accordion-collapse collapse"
aria-labelledby="heading5_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> Option 2 depicts training accuracy
vs. <code>height</code>; Option 3 depicts testing accuract
vs. <code>height</code></p>
<p>We are told that as <code>height</code> increases, the model variance
(complexity) also increases.</p>
<p>As we increase the complexity of our classifier, it will do a better
job of fitting to the training set because it’s able to “memorize” the
patterns in the training set. As such, as <code>height</code> increases,
training accuracy increases, which we see in Option 2.</p>
<p>However, after a certain point, increasing <code>height</code> will
make our classifier overfit too closely to our training set and not
general enough to match the patterns in other similar datasets, meaning
that after a certain point, increasing <code>height</code> will actually
decrease our classifier’s accuracy on our testing set. The only option
that shows accuracy increase and then decrease is Option 3.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><code>ChickenClassifier</code>s have another hyperparameter,
<code>color</code>, for which there are four possible values:
<code>"yellow"</code>, <code>"brown"</code>, <code>"red"</code>, and
<code>"orange"</code>. To find the optimal value of <code>color</code>,
we perform <span class="math inline">k</span>-fold cross-validation with
<span class="math inline">k=4</span>. The results are given in the table
below.</p>
<center><img src='../assets/images/disc10/CV.png' width=30%></center>
<p><br></p>
<h3 id="problem-5.2">Problem 5.2</h3>
<p>Which value of <code>color</code> has the best average validation
accuracy?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>"yellow"</code></p></li>
<li><p><input type="radio" disabled="" /> <code>"brown"</code></p></li>
<li><p><input type="radio" disabled="" /> <code>"red"</code></p></li>
<li><p><input type="radio" disabled="" /> <code>"orange"</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_2" aria-expanded="true" aria-controls="collapse5_2">
Click to view the solution.
</button>
</h2>
<div id="collapse5_2" class="accordion-collapse collapse"
aria-labelledby="heading5_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>"red"</code></p>
<p>From looking at the results of the k-fold cross validation, we see
that the color red has the highest, and therefore the best, validation
accuracy as it has the highest row mean (across all 4 folds).</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.3">Problem 5.3</h3>
<p>True or False: It is possible for a hyperparameter value to have the
best average validation accuracy across all folds, but not have the best
validation accuracy in any one particular fold.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_3" aria-expanded="true" aria-controls="collapse5_3">
Click to view the solution.
</button>
</h2>
<div id="collapse5_3" class="accordion-collapse collapse"
aria-labelledby="heading5_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> True</p>
<p>An example is shown below:</p>
<table>
<thead>
<tr>
<th>color</th>
<th>Fold 1</th>
<th>Fold 2</th>
<th>Fold 3</th>
<th>Fold 4</th>
<th>average</th>
</tr>
</thead>
<tbody>
<tr>
<td>color 1</td>
<td>0.8</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.2</td>
</tr>
<tr>
<td>color 2</td>
<td>0</td>
<td>0.6</td>
<td>0</td>
<td>0</td>
<td>0.15</td>
</tr>
<tr>
<td>color 3</td>
<td>0</td>
<td>0</td>
<td>0.1</td>
<td>0</td>
<td>0.025</td>
</tr>
<tr>
<td>color 4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.2</td>
<td>0.05</td>
</tr>
<tr>
<td>color 5</td>
<td>0.7</td>
<td>0.5</td>
<td>0.01</td>
<td>0.1</td>
<td>0.3275</td>
</tr>
</tbody>
</table>
<p>In the example, color 5 has the highest average validation accuracy
across all folds, but is not the best in any one fold.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.4">Problem 5.4</h3>
<p>Now, instead of finding the best <code>height</code> and best
<code>color</code> individually, we decide to perform a grid search that
uses <span class="math inline">k</span>-fold cross-validation to find
the combination of <code>height</code> and <code>color</code> with the
best average validation accuracy.</p>
<p>For the purposes of this question, assume that:</p>
<ul>
<li>We are performing <span class="math inline">k</span>-fold cross
validation.</li>
<li>Our training set contains <span class="math inline">n</span> rows,
where <span class="math inline">n</span> is greater than 5 and is a
multiple of <span class="math inline">k</span>.</li>
<li>There are <span class="math inline">h_1</span> possible values of
<code>height</code> and <span class="math inline">h_2</span> possible
values of <code>color</code>.</li>
</ul>
<p>Consider the following three subparts:</p>
<ul>
<li>A. What is the size of each fold?</li>
<li>B. How many times is row 5 in the training set used for
training?</li>
<li>C. How many times is row 5 in the training set used for
validation?</li>
</ul>
<p>Choose from the following options.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">\frac{k}{n}</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">\frac{n}{k}</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">\frac{n}{k} \cdot (k - 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">h_1h_2k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">h_1h_2(k-1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">\frac{nh_1h_2}{k}</span></p></li>
<li><p><input type="radio" disabled="" /> None of the above</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_4" aria-expanded="true" aria-controls="collapse5_4">
Click to view the solution.
</button>
</h2>
<div id="collapse5_4" class="accordion-collapse collapse"
aria-labelledby="heading5_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> A: Option 3 (<span class="math inline">\frac{n}{k}</span>), B: Option 6 (<span class="math inline">h_1h_2(k-1)</span>), C: Option 8 (None of the
above)</p>
<p><br/></p>
<h5 id="a.-what-is-the-size-of-each-fold">A. What is the size of each
fold?</h5>
<p>The training set is divided into <span class="math inline">k</span>
folds of equal size, resulting in <span class="math inline">k</span>
folds with size <span class="math inline">\frac{n}{k}</span>.</p>
<p><br/></p>
<h5 id="b.-how-many-times-is-row-5-in-the-training-set-used-for-training">B.
How many times is row 5 in the training set used for training?</h5>
<p>For each combination of hyperparameters, row 5 is <span class="math inline">k - 1</span> times for training and <span class="math inline">1</span> time for validation. There are <span class="math inline">h_1 \cdot h_2</span> combinations of
hyperparameters, so row 5 is used for training <span class="math inline">h_1 \cdot h_2 \cdot (k-1)</span> times.</p>
<p><br/></p>
<h5 id="c.-how-many-times-is-row-5-in-the-training-set-used-for-validation">C.
How many times is row 5 in the training set used for validation?</h5>
<p>Building off of the explanation for the previous subpart, row 5 is
used for validation 1 times for each combination of hyperparameters, so
the correct expression would be <span class="math inline">h_1 \cdot
h_2</span>, which is not a provided option.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-6">Problem 6</h2>
<p>Suppose you fit four different models to predict whether someone has
an income greater than $100,000 a year using their purchase history. You
split the data into a training and test set and use 3-fold
cross-validation. The table below shows all the calculated accuracies
for each model (higher accuracy is better).</p>
<center><img src="../assets/images/disc10/train-valid-test.png" style="width: 40%; height: auto;"></center>
<p><br></p>
<h3 id="problem-6.1">Problem 6.1</h3>
<p>Which model has the lowest model bias?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Model A</p></li>
<li><p><input type="radio" disabled="" /> Model B</p></li>
<li><p><input type="radio" disabled="" /> Model C</p></li>
<li><p><input type="radio" disabled="" /> Model D</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_1" aria-expanded="true" aria-controls="collapse6_1">
Click to view the solution.
</button>
</h2>
<div id="collapse6_1" class="accordion-collapse collapse"
aria-labelledby="heading6_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> Model D</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-6.2">Problem 6.2</h3>
<p>Which model most severely underfits the data?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Model A</p></li>
<li><p><input type="radio" disabled="" /> Model B</p></li>
<li><p><input type="radio" disabled="" /> Model C</p></li>
<li><p><input type="radio" disabled="" /> Model D</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_2" aria-expanded="true" aria-controls="collapse6_2">
Click to view the solution.
</button>
</h2>
<div id="collapse6_2" class="accordion-collapse collapse"
aria-labelledby="heading6_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> Model A</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-6.3">Problem 6.3</h3>
<p>Which model most severely overfits the data?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Model A</p></li>
<li><p><input type="radio" disabled="" /> Model B</p></li>
<li><p><input type="radio" disabled="" /> Model C</p></li>
<li><p><input type="radio" disabled="" /> Model D</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_3" aria-expanded="true" aria-controls="collapse6_3">
Click to view the solution.
</button>
</h2>
<div id="collapse6_3" class="accordion-collapse collapse"
aria-labelledby="heading6_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> Model D</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-6.4">Problem 6.4</h3>
<p>Which model should you pick overall?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Model A</p></li>
<li><p><input type="radio" disabled="" /> Model B</p></li>
<li><p><input type="radio" disabled="" /> Model C</p></li>
<li><p><input type="radio" disabled="" /> Model D</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_4" aria-expanded="true" aria-controls="collapse6_4">
Click to view the solution.
</button>
</h2>
<div id="collapse6_4" class="accordion-collapse collapse"
aria-labelledby="heading6_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> Model B</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="section"><span class="math display"> </span></h2>
<h4
id="feedback-find-an-error-still-confused-have-a-suggestion-let-us-know-here.">👋
Feedback: Find an error? Still confused? Have a suggestion? Let us know
<a href="https://forms.gle/xK4DpWXh9rq8AKP37">here</a>.</h4>
<hr />
</body>
</html>
