<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Visualization, Missing Values, More Practice</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../assets/theme.css" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">Visualization, Missing Values, More Practice</h1>
</header>
<p><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<!-- add after bootstrap.min.css -->
<link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"/>
<!-- add after bootstrap.min.js or bootstrap.bundle.min.js -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script></p>
<!-- for difficulty gauges-->
<script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-B947E6J6H4"></script> -->
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  // gtag('js', new Date());

  // gtag('config', 'G-B947E6J6H4');
</script>
<p><a href="../index.html">← return to study.practicaldsc.org</a></p>
<hr />
<p>The problems in this worksheet are taken from past exams in similar
classes. Work on them <strong>on paper</strong>, since the exams you
take in this course will also be on paper. <br><br>We encourage you to
complete this worksheet in a live discussion section. Solutions will be
made available after all discussion sections have concluded. You don’t
need to submit your answers anywhere.<br><br><b>Note: We do not plan to
cover all problems here in the live discussion section</b>; the problems
we don’t cover can be used for extra practice.</p>
<hr />
<h2 id="problem-1">Problem 1</h2>
<p>The DataFrame <code>games</code> contains information about a sample
of popular games, including board games, dice games, and card games. The
data comes from Board Game Geek, a popular website and vibrant online
community for game enthusiasts.</p>
<p>The columns of games are as follows.</p>
<ul>
<li><code>"Name"</code> (<code>str</code>): The name of the game.</li>
<li><code>"Mechanics"</code> (<code>str</code>): A sequence of
descriptors for how the game is played. A game can have several
descriptors, each of which is separated by a comma.</li>
<li><code>"Domains"</code> (<code>str</code>): A sequence of domains to
which the game belongs. A game can belong to multiple domains.</li>
<li><code>"Play Time"</code> (<code>int</code>): The average play time
of the game, in minutes, as suggested by the game’s creators.</li>
<li><code>"Complexity"</code> (<code>float</code>): The average
complexity of the game, on a scale of 1 to 5 points, as reported by
Board Game Geek community members.</li>
<li><code>"Rating"</code> (<code>str</code>): The average rating of the
game, on a scale of 1 to 10 points, as rated by Board Game Geek
community members. Note that while this data should be numerical, it is
actually stored as a string, because some entries use a comma in place
of a decimal point. For example 8,79 actually represents the number
8.79.</li>
<li><code>"BGG Rank"</code> (<code>int</code>): The rank of the game in
Board Game Geek’s database. The formula for how this rank is calculated
is not publicly known, but it likely includes many factors, such as
<code>"Rating"</code>, number of registered owners of the game, and
number of reviews.</li>
</ul>
<p>The first few rows of <code>games</code> are shown below (though
<code>games</code> has many more rows than pictured here).</p>
<center><img src='../assets/images/disc04/preview.jpg' width=100%></center>
<p><br></p>
<p>Assume that we have already run <code>import pandas as pd</code> and
<code>import numpy as np</code>.</p>
<p>Notice that <code>"Strategy Games"</code> and
<code>"Thematic Games"</code> are two of the possible domains, and that
a game can belong to multiple domains.</p>
<p>Define the variables strategy and thematic follows.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>strategy <span class="op">=</span> games[<span class="st">&quot;Domains&quot;</span>].<span class="bu">str</span>.contains(<span class="st">&quot;Strategy Games&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>thematic <span class="op">=</span> games[<span class="st">&quot;Domains&quot;</span>].<span class="bu">str</span>.contains(<span class="st">&quot;Thematic Games&quot;</span>)</span></code></pre></div>
<p>Many of the games in the <code>games</code> DataFrame belong to more
than one domain. We want to identify the number of games that belong to
only one domain. Select all of the options below that would correctly
calculate the number of games that belong to only one domain.</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> <code>(games["Domains"].str.split(" ").apply(len) == 2).sum()</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>(games["Domains"].apply(len) == 1).sum()</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>games[games["Domains"].str.split(",").str.len() == 1].value_counts("Name").sum()</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>games[games["Domains"].str.split(",").str.len() == 1].shape[0]</code></p></li>
</ul>
<hr />
<h2 id="problem-2">Problem 2</h2>
<p>In September 2020, Governor Gavin Newsom announced that by 2035, all
new vehicles sold in California must be zero-emissions vehicles.
Electric vehicles (EVs) are among the most popular zero-emissions
vehicles (though other examples include plug-in hybrids and hydrogen
fuel cell vehicles).</p>
<center><img src='../assets/images/disc04/data22.png' width=20%></center>
<p><br></p>
<p>The DataFrame <code>evs</code> consists of <strong>32</strong> rows,
each of which contains information about a different EV model.</p>
<ul>
<li><code>"Brand"</code> (str): The vehicle’s manufacturer.</li>
<li><code>"Model"</code> (str): The vehicle’s model name.</li>
<li><code>"BodyStyle"</code> (str): The vehicle’s body style.</li>
<li><code>"Seats"</code> (int): The vehicle’s number of seats.</li>
<li><code>"TopSpeed"</code> (int): The vehicle’s top speed, in
kilometers per hour.</li>
<li><code>"Range"</code> (int): The vehicle’s range, or distance it can
travel on a single charge, in kilometers.</li>
</ul>
<p>The first few rows of <code>evs</code> are shown below (though
remember, <code>evs</code> has 32 rows total).</p>
<center><img src='../assets/images/disc04/form22.png' width=60%></center>
<p><br></p>
<p><strong>Throughout this problem, we will refer to <code>evs</code>
repeatedly.</strong></p>
<p>Assume that:</p>
<ul>
<li>The only four values in the <code>"Brand"</code> column are
<code>"Tesla"</code>, <code>"BMW"</code>, <code>"Audi"</code>, and
<code>"Nissan"</code>.</li>
<li>We have already run <code>import pandas as pd</code> and
<code>import numpy as np</code>.</li>
</ul>
<p><strong>Tip:</strong> Open this page in another tab, so that it is
easy to refer to this data description as you work through the exam.</p>
<p><br></p>
<h3 id="problem-2.1">Problem 2.1</h3>
<p>Which of the following types of visualizations could use to visualize
the distribution of <code>"Range"</code>? Select all that apply.</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> Bar chart</p></li>
<li><p><input type="checkbox" disabled="" /> Histogram</p></li>
<li><p><input type="checkbox" disabled="" /> Scatter plot</p></li>
<li><p><input type="checkbox" disabled="" /> Line plot</p></li>
<li><p><input type="checkbox" disabled="" /> Box plot</p></li>
<li><p><input type="checkbox" disabled="" /> None of the above</p></li>
</ul>
<p><br></p>
<h3 id="problem-2.2">Problem 2.2</h3>
<p>Teslas, on average, tend to have higher <code>"Range"</code>s than
BMWs. In which of the following visualizations would we be able to see
this pattern? Select all that apply.</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> A bar chart that shows the distribution of <code>"Brand"</code></p></li>
<li><p><input type="checkbox" disabled="" /> A bar chart that shows the average <code>"Range"</code> for each
<code>"Brand"</code></p></li>
<li><p><input type="checkbox" disabled="" /> An overlaid histogram showing the distribution of
<code>"Range"</code> for each <code>"Brand"</code></p></li>
<li><p><input type="checkbox" disabled="" /> A scatter plot with <code>"TopSpeed"</code> on the <span class="math inline">x</span>-axis and <code>"Range"</code> on the <span class="math inline">y</span>-axis</p></li>
</ul>
<p><br></p>
<h3 id="problem-2.3">Problem 2.3</h3>
<p>Kyle thinks <code>"Seats"</code> is a categorical feature because it
can be used to categorize EVs by size. For instance, EVs with 4 seats
are small, EVs with 5 seats are medium, and EVs with 6 or more seats are
large.</p>
<p>Is Kyle correct?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes</p></li>
<li><p><input type="radio" disabled="" /> No</p></li>
</ul>
<p>Justify your answer in <strong>one sentence</strong>. Your answer
must fit in the box below.</p>
<p><br></p>
<hr />
<h2 id="problem-3">Problem 3</h2>
<p>The seat-back TV on one of Biff the Wolverine’s more recent flights
was very dirty and was full of fingerprints. The fingerprints made an
interesting pattern. We’ve stored the x and y positions of each
fingerprint in the DataFrame <code>fingerprints</code>, and created the
following scatterplot using</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fingerprints.plot(kind<span class="op">=</span><span class="st">&#39;scatter&#39;</span>, x<span class="op">=</span><span class="st">&#39;x&#39;</span>, y<span class="op">=</span><span class="st">&#39;y&#39;</span>)</span></code></pre></div>
<center><img src='../assets/images/disc04/mt-hist.png' width=20%></center>
<p><br></p>
<h3 id="problem-3.1">Problem 3.1</h3>
<p>True or False: The histograms that result from the following two
lines of code will look very similar.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># When we say bins=np.arange(0, 8, 2),</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we mean that the bins are [0, 2), [2, 4), [4, 6].</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>fingerprints.plot(kind<span class="op">=</span><span class="st">&#39;hist&#39;</span>, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                  y<span class="op">=</span><span class="st">&#39;x&#39;</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                  density<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                  bins<span class="op">=</span>np.arange(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">2</span>))</span></code></pre></div>
<p>and</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>fingerprints.plot(kind<span class="op">=</span><span class="st">&#39;hist&#39;</span>, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                  y<span class="op">=</span><span class="st">&#39;y&#39;</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                  density<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                  bins<span class="op">=</span>np.arange(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">2</span>))</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<p><br></p>
<h3 id="problem-3.2">Problem 3.2</h3>
<p>Below, we’ve drawn a histogram using the line of code</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fingerprints.plot(kind<span class="op">=</span><span class="st">&#39;hist&#39;</span>, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                  y<span class="op">=</span><span class="st">&#39;x&#39;</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                  density<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                  bins<span class="op">=</span>np.arange(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">2</span>))</span></code></pre></div>
<p>However, our Jupyter Notebook was corrupted, and so the resulting
histogram doesn’t quite look right. While the height of the first bar is
correct, the histogram doesn’t contain the second or third bars, and the
y-axis is replaced with letters.</p>
<center><img src='../assets/images/disc04/mt-hist-2.png' width=30%></center>
<p>Which of the four options on the y-axis is closest to where the
height of the middle bar should be?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> A</p></li>
<li><p><input type="radio" disabled="" /> B</p></li>
<li><p><input type="radio" disabled="" /> C</p></li>
<li><p><input type="radio" disabled="" /> D</p></li>
</ul>
<p>Which of the four options on the y-axis is closest to where the
height of the rightmost bar should be?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> A</p></li>
<li><p><input type="radio" disabled="" /> B</p></li>
<li><p><input type="radio" disabled="" /> C</p></li>
<li><p><input type="radio" disabled="" /> D</p></li>
</ul>
<p><br></p>
<hr />
<h2 id="problem-4">Problem 4</h2>
<p>Pranavi proposes the following imputation scheme.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> impute(s):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> s.fillna(np.random.choice(s[s.notna()]))</span></code></pre></div>
<p><br></p>
<h3 id="problem-4.1">Problem 4.1</h3>
<p><strong>True or False:</strong> <code>impute</code> performs
probabilistic imputation, using the same definition of probabilistic
imputation we learned about in class.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<p><br></p>
<h3 id="problem-4.2">Problem 4.2</h3>
<p>Consider the following expressions and values.</p>
<pre><code>    &gt;&gt;&gt; vals.isna().mean()
    0.2
    &gt;&gt;&gt; vals.describe().loc[[&quot;min&quot;, &quot;mean&quot;, &quot;max&quot;]]
    min     2.0
    mean    4.0
    max     7.0
    dtype: float64</code></pre>
<p>Given the above, what is the <strong>maximum</strong> possible value
of <code>impute(vals).mean()</code>? Give your answer as a number
rounded to one decimal place.</p>
<p><br></p>
<h3 id="problem-4.3">Problem 4.3</h3>
<p>Which of the following statements below will always evaluate to
<code>True</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>vals.std() &lt; impute(vals).std()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>vals.std() &lt;= impute(vals).std()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>vals.std() == impute(vals).std()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>vals.std() &gt;= impute(vals).std()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>vals.std() &gt; impute(vals).std()</code></p></li>
<li><p><input type="radio" disabled="" /> None of the above</p></li>
</ul>
<p><br></p>
<hr />
<h2 id="problem-5">Problem 5</h2>
<p>Suppose we have a DataFrame, <code>dogs</code>, in which each row
corresponds to a different dog owned by someone in Ann Arbor. There are
several columns in the DataFrame, including <code>"birth_year"</code>
(the dog’s year of birth) and <code>"Breed"</code> (the dog’s
breed).</p>
<p>Using the <code>"birth_year"</code> column in <code>dogs</code>,
Tahseen computes the age of each dog and stores it a new
<code>"age"</code> column of <code>dogs</code>. He also categorizes dogs
into three “breed classes” based on their breed –
<code>"Retriever"</code>, <code>"Terrier"</code>, or
<code>"Other"</code> – and stores these in a new <code>"class"</code>
column of <code>dogs</code>.</p>
<p>The following bar chart shows the distribution of breed classes by
missingness of age:</p>
<center><img src="../../assets/images/disc04/dist-missingness.png" width=400></center>
<p>The following bar chart shows the mean observed age for each breed
class:</p>
<center><img src="../../assets/images/disc04/mean-ages.png" width=400></center>
<p><br></p>
<h3 id="problem-5.1">Problem 5.1</h3>
<p>Let <span class="math inline">O</span> be the mean of the observed
ages in <code>dogs</code>, that is, the mean of the ages that aren’t
missing. Let <span class="math inline">T</span> be the true mean of the
ages in <code>dogs</code>, that is, the mean we’d compute if none of the
ages were missing.</p>
<p>What is the relationship between <span class="math inline">O</span>
and <span class="math inline">T</span>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">O &lt; T</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">O \approx T</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">O = T</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">O &gt; T</span></p></li>
</ul>
<p><br></p>
<p>Consider the following strategy for imputing missing ages.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fill_missing(dogs):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dogs.assign(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    age<span class="op">=</span>dogs.groupby(<span class="st">&quot;class&quot;</span>)[<span class="st">&quot;age&quot;</span>]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>            .transform(<span class="kw">lambda</span> x: x.fillna(x.value_counts().idxmax()))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><br></p>
<h3 id="problem-5.2">Problem 5.2</h3>
<p>In one sentence, describe this imputation strategy.</p>
<p><br></p>
<h3 id="problem-5.3">Problem 5.3</h3>
<p><code>small_dogs</code> is a subset of <code>dogs</code> shown in its
entirety below.</p>
<center><img src="../../assets/images/disc04/with-miss.png" width=200></center>
<p>If we call <code>fill_missing</code> on <code>small_dogs</code>, what
values would the four null values in the <code>"age"</code> column of
<code>small_dogs</code> be replaced with?</p>
<ul>
<li>row 2: ___</li>
<li>row 3: ___</li>
<li>row 4: ___</li>
<li>row 7: ___</li>
</ul>
<p><br></p>
<hr />
<h2 id="problem-6">Problem 6</h2>
<p>The EECS 398 staff are looking into hotels — some in San Diego, for
their family to stay at for graduation (and to eat Mexican food), and
some elsewhere, for summer trips.</p>
<p>Each row of <code>hotels</code> contains information about a
different hotel in San Diego. Specifically, for each hotel, we have:</p>
<ul>
<li><code>"Hotel Name" (str)</code>: The name of the hotel.
<strong>Assume hotel names are unique.</strong></li>
<li><code>"Location" (str):</code> The hotel’s neighborhood in San
Diego.</li>
<li><code>"Chain" (str):</code> The chain the hotel is a part of; either
<code>"Hilton", "Marriott", "Hyatt", or "Other".</code> A hotel chain is
a group of hotels owned or operated by a shared company.</li>
<li><code>"Number of Rooms" (int)</code>: The number of rooms the hotel
has.</li>
</ul>
<p>The first few rows of <code>hotels</code> are shown below, but hotels
has many more rows than are shown.</p>
<center><img src="../../assets/images/disc04/hotels.png" width=750></center>
<p>Now, consider the variable <code>summed</code>, defined below.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>summed <span class="op">=</span> hotels.groupby(<span class="st">&quot;Chain&quot;</span>)[<span class="st">&quot;Number of Rooms&quot;</span>].<span class="bu">sum</span>().idxmax()</span></code></pre></div>
<p><br></p>
<h3 id="problem-6.1">Problem 6.1</h3>
<p>What is <code>type(summed)</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>int</code></p></li>
<li><p><input type="radio" disabled="" /> <code>str</code></p></li>
<li><p><input type="radio" disabled="" /> <code>Series</code></p></li>
<li><p><input type="radio" disabled="" /> <code>DataFrame</code></p></li>
<li><p><input type="radio" disabled="" /> <code>DataFrameGroupBy</code></p></li>
</ul>
<p><br></p>
<h3 id="problem-6.2">Problem 6.2</h3>
<p>In one sentence, explain what the value of <code>summed</code> means.
Phrase your explanation as if you had to give it to someone who is not a
data science major; that is, don’t say something like “it is the result
of grouping <code>hotels</code> by <code>"Chain"</code>, selecting the
<code>"Number of Rooms"</code> column, …”, but instead, give the value
context.</p>
<p><br></p>
<h3 id="problem-6.3">Problem 6.3</h3>
<p>Consider the variable <code>curious</code>, defined below.</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>curious <span class="op">=</span> frame[<span class="st">&quot;Chain&quot;</span>].value_counts().idxmax()</span></code></pre></div>
<p>Fill in the blank: <code>curious</code> is guaranteed to be equal to
<code>summed</code> only if <code>frame</code> has one row for every
____ in San Diego.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> hotel</p></li>
<li><p><input type="radio" disabled="" /> hotel chain</p></li>
<li><p><input type="radio" disabled="" /> hotel room</p></li>
<li><p><input type="radio" disabled="" /> neighborhood</p></li>
</ul>
<p><br></p>
<h3 id="problem-6.4">Problem 6.4</h3>
<p>Fill in the blanks so that <code>popular_areas</code> is an array of
the names of the unique neighborhoods that have at least 5 hotels and at
least 1000 hotel rooms.</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> <span class="kw">lambda</span> df: __(i)__</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    popular_areas <span class="op">=</span> hotels.groupby(__(ii)__).__(iii)__.__(iv)__</span></code></pre></div>
<ol type="1">
<li><p>What goes in blank (i)?</p></li>
<li><p>What goes in blank (ii)?</p></li>
</ol>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>"Hotel Name"</code></p></li>
<li><p><input type="radio" disabled="" /> <code>"Location"</code></p></li>
<li><p><input type="radio" disabled="" /> <code>"Chain"</code></p></li>
<li><p><input type="radio" disabled="" /> <code>"Number of Rooms"</code></p></li>
</ul>
<ol start="3" type="1">
<li>What goes in blank (iii)?</li>
</ol>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>agg(f)</code></p></li>
<li><p><input type="radio" disabled="" /> <code>filter(f)</code></p></li>
<li><p><input type="radio" disabled="" /> <code>transform(f)</code></p></li>
</ul>
<ol start="4" type="1">
<li>What goes in blank (iv)?</li>
</ol>
<p><br></p>
<h3 id="problem-6.5">Problem 6.5</h3>
<p>Consider the code below.</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>    cond1 <span class="op">=</span> hotels[<span class="st">&quot;Chain&quot;</span>] <span class="op">==</span> <span class="st">&quot;Marriott&quot;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    cond2 <span class="op">=</span> hotels[<span class="st">&quot;Location&quot;</span>] <span class="op">==</span> <span class="st">&quot;Coronado&quot;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    combined <span class="op">=</span> hotels[cond1].merge(hotels[cond2], on<span class="op">=</span><span class="st">&quot;Hotel Name&quot;</span>, how<span class="op">=</span>???)</span></code></pre></div>
<ol type="1">
<li>If we replace <code>???</code> with <code>"inner"</code> in the code
above, which of the following will be equal to
<code>combined.shape[0]</code>?</li>
</ol>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>min(cond1.sum(), cond2.sum())</code></p></li>
<li><p><input type="radio" disabled="" /> <code>(cond1 &amp; cond2).sum()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>cond1.sum() + cond2.sum()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>cond1.sum() + cond2.sum() - (cond1 &amp; cond2).sum()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>cond1.sum() + (cond1 &amp; cond2).sum()</code></p></li>
</ul>
<ol start="2" type="1">
<li>If we replace <code>???</code> with <code>"outer"</code> in the code
above, which of the following will be equal to
<code>combined.shape[0]</code>?</li>
</ol>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>min(cond1.sum(), cond2.sum())</code></p></li>
<li><p><input type="radio" disabled="" /> <code>(cond1 &amp; cond2).sum()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>cond1.sum() + cond2.sum()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>cond1.sum() + cond2.sum() - (cond1 &amp; cond2).sum()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>cond1.sum() + (cond1 &amp; cond2).sum()</code></p></li>
</ul>
<p><br></p>
<hr />
<h2 id="problem-7">Problem 7</h2>
<p>Let’s consider admissions at UC San Diego and UC Santa Barbara for
two high schools in particular.</p>
<center><img src='../assets/images/disc04/simpson.png' width=40%></center>
<p>For instance, the above table tells us that 200 students from La
Jolla Private applied to UC San Diego, and 50 were admitted.</p>
<p>What is the largest possible integer value of <span
class="math inline">N</span> such that:</p>
<ul>
<li><p>UC Santa Barbara has a strictly higher admit rate for
<strong>both</strong> La Jolla Private and Sun God Memorial High
individually, but</p></li>
<li><p>UC San Diego has a strictly higher admit rate overall?</p></li>
</ul>
<hr />
<h2 id="problem-8">Problem 8</h2>
<p>Suppose Charlie and Norah each have separate DataFrames for their
contacts, called <code>charlie</code> and <code>norah</code>,
respectively. These DataFrames have the same column names and format as
your DataFrame, <code>contacts</code>.</p>
<p>As illustrated in the diagram below, Charlie has 172 contacts in
total, whereas Norah has 88 contacts. 12 of these contacts are shared,
meaning they appear in both <code>charlie</code> and
<code>norah</code>.</p>
<center><img src="../../assets/images/disc04/venn_diagram.png" width=400></center>
<p><br></p>
<h3 id="problem-8.1">Problem 8.1</h3>
<p>What does the following expression evaluate to?</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>charlie.merge(norah, left_index<span class="op">=</span><span class="va">True</span>, right_index<span class="op">=</span><span class="va">True</span>).shape[<span class="dv">0</span>]    </span></code></pre></div>
<p><br></p>
<h3 id="problem-8.2">Problem 8.2</h3>
<p>One day, when updating her phone’s operating system, Norah
accidentally duplicates the 12 contacts she has in common with Charlie.
Now, the <code>norah</code> DataFrame has 100 rows.</p>
<p>What does the following expression evaluate to?</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>norah.merge(norah, left_index<span class="op">=</span><span class="va">True</span>, right_index<span class="op">=</span><span class="va">True</span>).shape[<span class="dv">0</span>]   </span></code></pre></div>
<p><br></p>
<hr />
<h2 id="problem-9">Problem 9</h2>
<p>In this problem, we will be using the following DataFrame
<code>students</code>, which contains various information about high
school students and the university/universities they applied to.</p>
<center><img src='../assets/images/disc04/students.png' width=65%></center>
<p>The columns are:</p>
<ul>
<li><code>'Name' (str)</code>: the name of the student.</li>
<li><code>'High School' (str)</code>: the High School that the student
attended.</li>
<li><code>'Email' (str)</code>: the email of the student.</li>
<li><code>'GPA' (float)</code>: the GPA of the student.</li>
<li><code>'AP' (int)</code>: the number of AP exams that the student
took.</li>
<li><code>'University' (str)</code>: the name of the university that the
student applied to.</li>
<li><code>'Admit' (str)</code>: the acceptance status of the student
(where ‘Y’ denotes that they were accepted to the university and ‘N’
denotes that they were not).</li>
</ul>
<p>The rows of <code>'student'</code> are arranged in no particular
order. The first eight rows of <code>'student'</code> are shown above
(though <code>'student'</code> has many more rows than pictured
here).</p>
<p><br></p>
<h3 id="problem-9.1">Problem 9.1</h3>
<p>Fill in the blank so that the result evaluates to a Series indexed by
<code>"Email"</code> that contains a <strong>list</strong> of the
universities that each student <strong>was admitted to</strong>. If a
student wasn’t admitted to any universities, they should have an empty
list.</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>    students.groupby(<span class="st">&quot;Email&quot;</span>).<span class="bu">apply</span>(_____)</span></code></pre></div>
<p>What goes in the blank?</p>
<p><br></p>
<h3 id="problem-9.2">Problem 9.2</h3>
<p>Which of the following blocks of code correctly assign
<code>max_AP</code> to the maximum number of APs taken by a student who
was rejected by UC San Diego?</p>
<p>Option 1:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>cond1 <span class="op">=</span> students[<span class="st">&quot;Admit&quot;</span>] <span class="op">==</span> <span class="st">&quot;N&quot;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>cond2 <span class="op">=</span> students[<span class="st">&quot;University&quot;</span>] <span class="op">==</span> <span class="st">&quot;UC San Diego&quot;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>max_AP <span class="op">=</span> students.loc[cond1 <span class="op">&amp;</span> cond2, <span class="st">&quot;APs&quot;</span>].sort_values().iloc[<span class="op">-</span><span class="dv">1</span>]</span></code></pre></div>
<p>Option 2:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cond1 <span class="op">=</span> students[<span class="st">&quot;Admit&quot;</span>] <span class="op">==</span> <span class="st">&quot;N&quot;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>cond2 <span class="op">=</span> students[<span class="st">&quot;University&quot;</span>] <span class="op">==</span> <span class="st">&quot;UC San Diego&quot;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>d3 <span class="op">=</span> students.groupby([<span class="st">&quot;University&quot;</span>, <span class="st">&quot;Admit&quot;</span>]).<span class="bu">max</span>().reset_index()</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>max_AP <span class="op">=</span> d3.loc[cond1 <span class="op">&amp;</span> cond2, <span class="st">&quot;APs&quot;</span>].iloc[<span class="dv">0</span>]</span></code></pre></div>
<p>Option 3:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> students.pivot_table(index<span class="op">=</span><span class="st">&quot;Admit&quot;</span>, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                            columns<span class="op">=</span><span class="st">&quot;University&quot;</span>, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                            values<span class="op">=</span><span class="st">&quot;APs&quot;</span>, </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                            aggfunc<span class="op">=</span><span class="st">&quot;max&quot;</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>max_AP <span class="op">=</span> p.loc[<span class="st">&quot;N&quot;</span>, <span class="st">&quot;UC San Diego&quot;</span>]</span></code></pre></div>
<p>Option 4:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .last() returns the element at the end of a Series it is called on</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>groups <span class="op">=</span> students.sort_values([<span class="st">&quot;APs&quot;</span>, <span class="st">&quot;Admit&quot;</span>]).groupby(<span class="st">&quot;University&quot;</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>max_AP <span class="op">=</span> groups[<span class="st">&quot;APs&quot;</span>].last()[<span class="st">&quot;UC San Diego&quot;</span>]</span></code></pre></div>
<p><strong>Select all that apply.</strong> There is at least one correct
option.</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> Option 1</p></li>
<li><p><input type="checkbox" disabled="" /> Option 2</p></li>
<li><p><input type="checkbox" disabled="" /> Option 3</p></li>
<li><p><input type="checkbox" disabled="" /> Option 4</p></li>
</ul>
<p><br></p>
<h3 id="problem-9.3">Problem 9.3</h3>
<p>Currently, <code>students</code> has a lot of repeated information —
for instance, if a student applied to 10 universities, their GPA appears
10 times in <code>students</code>.</p>
<p>We want to generate a DataFrame that contains a single row for each
student, indexed by <code>"Email"</code>, that contains their
<code>"Name"</code>, <code>"High School"</code>, <code>"GPA"</code>, and
<code>"APs"</code>.</p>
<p>One attempt to create such a DataFrame is below.</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>students.groupby(<span class="st">&quot;Email&quot;</span>).aggregate({<span class="st">&quot;Name&quot;</span>: <span class="st">&quot;max&quot;</span>,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;High School&quot;</span>: <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;GPA&quot;</span>: <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;APs&quot;</span>: <span class="st">&quot;max&quot;</span>})</span></code></pre></div>
<p>There is exactly one issue with the line of code above. <strong>In
one sentence</strong>, explain what needs to be changed about the line
of code above so that the desired DataFrame is created.</p>
<p><br></p>
<h3 id="problem-9.4">Problem 9.4</h3>
<p>Consider the following snippet of code.</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>pivoted <span class="op">=</span> students.assign(Admit<span class="op">=</span>students[<span class="st">&quot;Admit&quot;</span>] <span class="op">==</span> <span class="st">&quot;Y&quot;</span>) <span class="op">\</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                    .pivot_table(index<span class="op">=</span><span class="st">&quot;High School&quot;</span>, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                                columns<span class="op">=</span><span class="st">&quot;University&quot;</span>, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                                values<span class="op">=</span><span class="st">&quot;Admit&quot;</span>, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                                aggfunc<span class="op">=</span><span class="st">&quot;sum&quot;</span>)</span></code></pre></div>
<p>Some of the rows and columns of <code>pivoted</code> are shown
below.</p>
<center><img src='../assets/images/disc04/pivot.png' width=55%></center>
<p>No students from Warren High were admitted to Columbia or Stanford.
However,<br />
<code>pivoted.loc["Warren High", "Columbia"]</code> and
<code>pivoted.loc["Warren High", "Stanford"]</code> evaluate to
different values. What is the reason for this difference?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Some students from Warren High applied to Stanford, and some others
applied to Columbia, but none applied to both.</p></li>
<li><p><input type="radio" disabled="" /> Some students from Warren High applied to Stanford but none applied
to Columbia.</p></li>
<li><p><input type="radio" disabled="" /> Some students from Warren High applied to Columbia but none applied
to Stanford.</p></li>
<li><p><input type="radio" disabled="" /> The students from Warren High that applied to both Columbia and
Stanford were all rejected from Stanford, but at least one was admitted
to Columbia.</p></li>
<li><p><input type="radio" disabled="" /> When using <code>pivot_table</code>, <code>pandas</code> was not able
to sum strings of the form <code>"Y"</code>, <code>"N"</code>, and
<code>"W"</code>, so the values in <code>pivoted</code> are
unreliable.</p></li>
</ul>
<p><br></p>
<hr />
<h2 id="problem-10">Problem 10</h2>
<p>For each day in May 2022, the DataFrame <code>streams</code> contains
the number of streams for each of the “Top 200" songs on Spotify that
day — that is, the number of streams for the 200 songs with the most
streams on Spotify that day. The columns in <code>streams</code> are as
follows:</p>
<ul>
<li><p><code>"date"</code>: the date the song was streamed</p></li>
<li><p><code>"artist_names"</code>: name(s) of the artists who created
the song</p></li>
<li><p><code>"track_name"</code>: name of the song</p></li>
<li><p><code>"streams"</code>: the number of times the song was streamed
on Spotify that day</p></li>
</ul>
<p>The first few rows of <code>streams</code> are shown below. Since
there were 31 days in May and 200 songs per day, <code>streams</code>
has 6200 rows in total.</p>
<center><img src='../assets/images/disc04/streams.png' width=50%></center>
<p>Note that:</p>
<ul>
<li><p><code>streams</code> is already sorted in a very particular way —
it is sorted by <code>"date"</code> in reverse chronological
(decreasing) order, and, within each <code>"date"</code>, by
<code>"streams"</code> in increasing order.</p></li>
<li><p>Many songs will appear multiple times in <code>streams</code>,
because many songs were in the Top 200 on more than one day.</p></li>
</ul>
<p><br></p>
<h3 id="problem-10.1">Problem 10.1</h3>
<p>Complete the implementation of the function <code>song_by_day</code>,
which takes in an integer <code>day</code> between 1 and 31
corresponding to a day in May, and an integer <code>n</code>, and
returns the song that had the <code>n</code>-th most streams on
<code>day</code>. For instance,<br />
<code>song_by_day(31, 199)</code> should evaluate to
<code>"pepas"</code>, because <code>"pepas"</code> was the 199th most
streamed song on May 31st.</p>
<p><strong>Note:</strong> You are not allowed to sort within
<code>song_by_day</code> — remember, <code>streams</code> is already
sorted.</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> song_by_day(day, n):</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    day_str <span class="op">=</span> <span class="ss">f&quot;2022-05-</span><span class="sc">{</span><span class="bu">str</span>(day)<span class="sc">.</span>zfill(<span class="dv">2</span>)<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    day_only <span class="op">=</span> streams[__(a)__].iloc[__(b)__]</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> __(c)__</span></code></pre></div>
<p>What goes in each of the blanks?</p>
<p><br></p>
<h3 id="problem-10.2">Problem 10.2</h3>
<p>Below, we define a DataFrame <code>pivoted</code>.</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>pivoted <span class="op">=</span> streams.pivot_table(index<span class="op">=</span><span class="st">&quot;track_name&quot;</span>, columns<span class="op">=</span><span class="st">&quot;date&quot;</span>, </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                                values<span class="op">=</span><span class="st">&quot;streams&quot;</span>, aggfunc<span class="op">=</span>np.<span class="bu">max</span>)</span></code></pre></div>
<p>After defining <code>pivoted</code>, we define a Series
<code>mystery</code> below.</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mystery <span class="op">=</span> <span class="dv">31</span> <span class="op">-</span> pivoted.<span class="bu">apply</span>(<span class="kw">lambda</span> s: s.isna().<span class="bu">sum</span>(), axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<p><code>mystery.loc["pepas"]</code> evaluates to 23. In one sentence,
describe the relationship between the number 23 and the song
<code>"pepas"</code> in the context of the <code>streams</code> dataset.
For instance, a correctly formatted but incorrect answer is “I listened
to the song <code>"pepas"</code> 23 times today."</p>
<p><br></p>
<h3 id="problem-10.3">Problem 10.3</h3>
<p>In defining <code>pivoted</code>, we set the keyword argument
<code>aggfunc</code> to <code>np.max</code>. Which of the following
functions could we have used instead of <code>np.max</code> without
changing the values in <code>pivoted</code>? <strong>Select all that
apply.</strong></p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> <code>np.mean</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>np.median</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>len</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>lambda df: df.iloc[0]</code></p></li>
<li><p><input type="checkbox" disabled="" /> None of the above</p></li>
</ul>
<p><br></p>
<h3 id="problem-10.4">Problem 10.4</h3>
<p>Below, we define another DataFrame <code>another_mystery</code>.</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>another_mystery <span class="op">=</span> (streams.groupby(<span class="st">&quot;date&quot;</span>).last()</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                            .groupby([<span class="st">&quot;artist_names&quot;</span>, <span class="st">&quot;track_name&quot;</span>])</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                            .count().reset_index())</span></code></pre></div>
<p><code>another_mystery</code> has 5 rows. In one sentence, describe
the significance of the number 5 in the context of the
<code>streams</code> dataset. For instance, a correctly formatted but
incorrect answer is “There are 5 unique artists in
<code>streams</code>." Your answer should not include the word”row".</p>
<p><br></p>
<hr />
<h2 id="problem-11">Problem 11</h2>
<p>Build on the previous problem.</p>
<p>Suppose the DataFrame <code>today</code> consists of 15 rows — 3 rows
for each of 5 different <code>"artist_names"</code>. For each artist, it
contains the <code>"track_name"</code> for their three most-streamed
songs today. For instance, there may be one row for
<code>"olivia rodrigo"</code> and <code>"favorite crime"</code>, one row
for <code>"olivia rodrigo"</code> and <code>"drivers license"</code>,
and one row for <code>"olivia rodrigo"</code> and
<code>"deja vu"</code>.</p>
<p>Another DataFrame, <code>genres</code>, is shown below in its
entirety.</p>
<center><img src='../assets/images/disc04/genres.png' width=25%></center>
<p><br></p>
<h3 id="problem-11.1">Problem 11.1</h3>
<p>Suppose we perform an <strong>inner</strong> merge between
<code>today</code> and <code>genres</code> on
<code>"artist_names"</code>. If the five <code>"artist_names"</code> in
<code>today</code> are the same as the five <code>"artist_names"</code>
in <code>genres</code>, what fraction of the rows in the merged
DataFrame will contain <code>"Pop"</code> in the <code>"genre"</code>
column? Give your answer as a simplified fraction.</p>
<p><br></p>
<h3 id="problem-11.2">Problem 11.2</h3>
<p>Suppose we perform an <strong>inner</strong> merge between
<code>today</code> and <code>genres</code> on
<code>"artist_names"</code>. Furthermore, suppose that the only
overlapping <code>"artist_names"</code> between <code>today</code> and
<code>genres</code> are <code>"drake"</code> and
<code>"olivia rodrigo"</code>. What fraction of the rows in the merged
DataFrame will contain <code>"Pop"</code> in the <code>"genre"</code>
column? Give your answer as a simplified fraction.</p>
<p><br></p>
<h3 id="problem-11.3">Problem 11.3</h3>
<p>Suppose we perform an <strong>outer</strong> merge between
<code>today</code> and <code>genres</code> on
<code>"artist_names"</code>. Furthermore, suppose that the only
overlapping <code>"artist_names"</code> between <code>today</code> and
<code>genres</code> are <code>"drake"</code> and
<code>"olivia rodrigo"</code>. What fraction of the rows in the merged
DataFrame will contain <code>"Pop"</code> in the <code>"genre"</code>
column? Give your answer as a simplified fraction.</p>
<p><br></p>
<hr />
<h2 id="problem-12">Problem 12</h2>
<p>Recall the <code>evs</code> DataFrame.</p>
<p>The first few rows of <code>evs</code> are shown below (though
remember, <code>evs</code> has 32 rows total).</p>
<center><img src='../assets/images/disc04/form22.png' width=60%></center>
<p><br></p>
<p>Below, we provide the a DataFrame that contains the distribution of
“BodyStyle” for all “Brands” in <code>evs</code>, other than Nissan.</p>
<center><img src='../assets/images/disc04/midq6.png' width=50%></center>
<p>Suppose we’ve run the following few lines of code.</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>tesla <span class="op">=</span> evs[evs.get(<span class="st">&quot;Brand&quot;</span>) <span class="op">==</span> <span class="st">&quot;Tesla&quot;</span>]</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>bmw <span class="op">=</span> evs[evs.get(<span class="st">&quot;Brand&quot;</span>) <span class="op">==</span> <span class="st">&quot;BMW&quot;</span>]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>audi <span class="op">=</span> evs[evs.get(<span class="st">&quot;Brand&quot;</span>) <span class="op">==</span> <span class="st">&quot;Audi&quot;</span>]</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>combo <span class="op">=</span> tesla.merge(bmw, on<span class="op">=</span><span class="st">&quot;BodyStyle&quot;</span>).merge(audi, on<span class="op">=</span><span class="st">&quot;BodyStyle&quot;</span>)</span></code></pre></div>
<p>How many rows does the DataFrame <code>combo</code> have?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> 21</p></li>
<li><p><input type="radio" disabled="" /> 24</p></li>
<li><p><input type="radio" disabled="" /> 35</p></li>
<li><p><input type="radio" disabled="" /> 65</p></li>
<li><p><input type="radio" disabled="" /> 72</p></li>
<li><p><input type="radio" disabled="" /> 96</p></li>
</ul>
<hr />
<h2 id="section"><span class="math display"> </span></h2>
<h4
id="feedback-find-an-error-still-confused-have-a-suggestion-let-us-know-here.">👋
Feedback: Find an error? Still confused? Have a suggestion? Let us know
<a href="https://forms.gle/xK4DpWXh9rq8AKP37">here</a>.</h4>
<hr />
</body>
</html>
