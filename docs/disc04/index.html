<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Grouping, Pivoting, and Merging</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../assets/theme.css" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">Grouping, Pivoting, and Merging</h1>
</header>
<p><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<!-- add after bootstrap.min.css -->
<link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"/>
<!-- add after bootstrap.min.js or bootstrap.bundle.min.js -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script></p>
<!-- for difficulty gauges-->
<script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-B947E6J6H4"></script> -->
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  // gtag('js', new Date());

  // gtag('config', 'G-B947E6J6H4');
</script>
<p><a href="../index.html">‚Üê return to study.practicaldsc.org</a></p>
<hr />
<p>The problems in this worksheet are taken from past exams in similar
classes. Work on them <strong>on paper</strong>, since the exams you
take in this course will also be on paper. <br><br>We encourage you to
complete this worksheet in a live discussion section. Solutions will be
made available after all discussion sections have concluded. You don‚Äôt
need to submit your answers anywhere.<br><br><b>Note: We do not plan to
cover all problems here in the live discussion section</b>; the problems
we don‚Äôt cover can be used for extra practice.</p>
<hr />
<h2 id="problem-1">Problem 1</h2>
<p>The <code>laptops</code> DataFrame contains information on various
factors that influence the pricing of laptops. Each row represents a
laptop, and the columns are:</p>
<ul>
<li><code>"Mfr" (str)</code>: the company that manufactures the laptop,
like ‚ÄúApple‚Äù or ‚ÄúDell‚Äù.</li>
<li><code>"Model" (str)</code>: the model name of the laptop, such as
‚ÄúMacBook Pro‚Äù.</li>
<li><code>"OS" (str)</code>: the operating system, such as ‚ÄúmacOS‚Äù or
‚ÄúWindows 11‚Äù.</li>
<li><code>"Screen Size" (float)</code>: the diagonal length of the
screen, in inches.</li>
<li><code>"Price" (float)</code>: the price of the laptop, in
dollars.</li>
</ul>
<p><br></p>
<h3 id="problem-1.1">Problem 1.1</h3>
<p><strong>Without using <code>groupby</code></strong>, write an
expression that evaluates to the average price of laptops with the
<code>"macOS"</code> operating system (the same quantity as above).</p>
<p><br></p>
<p><br></p>
<h3 id="problem-1.2">Problem 1.2</h3>
<p><strong>Using <code>groupby</code></strong>, write an expression that
evaluates to the average price of laptops with the <code>"macOS"</code>
operating system.</p>
<p><br></p>
<hr />
<h2 id="problem-2">Problem 2</h2>
<p>You are given a DataFrame called <code>books</code> that contains
columns <code>'author'</code> (string), <code>'title'</code> (string),
<code>'num_chapters'</code> (int), and <code>'publication_year'</code>
(int).</p>
<p>Suppose that after doing <code>books.groupby('author').max()</code>,
one row says</p>
<table>
<thead>
<tr>
<th>author</th>
<th>title</th>
<th>num_chapters</th>
<th>publication_year</th>
</tr>
</thead>
<tbody>
<tr>
<td>Charles Dickens</td>
<td>Oliver Twist</td>
<td>53</td>
<td>1838</td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="problem-2.1">Problem 2.1</h3>
<p>Based on this data, can you conclude that Charles Dickens is the
alphabetically last of all author names in this dataset?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes</p></li>
<li><p><input type="radio" disabled="" /> No</p></li>
</ul>
<p><br></p>
<h3 id="problem-2.2">Problem 2.2</h3>
<p>Based on this data, can you conclude that Charles Dickens wrote
<em>Oliver Twist</em>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes</p></li>
<li><p><input type="radio" disabled="" /> No</p></li>
</ul>
<p><br></p>
<h3 id="problem-2.3">Problem 2.3</h3>
<p>Based on this data, can you conclude that <em>Oliver Twist</em> has
53 chapters?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes</p></li>
<li><p><input type="radio" disabled="" /> No</p></li>
</ul>
<p><br></p>
<h3 id="problem-2.4">Problem 2.4</h3>
<p>Based on this data, can you conclude that Charles Dickens wrote a
book with 53 chapters that was published in 1838?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes</p></li>
<li><p><input type="radio" disabled="" /> No</p></li>
</ul>
<p><br></p>
<hr />
<h2 id="problem-3">Problem 3</h2>
<p>The DataFrame <code>items</code> describes various items available to
collect or purchase using bells, the currency used in the game
<em>Animal Crossing: New Horizons</em>.</p>
<p>For each item, we have:</p>
<ul>
<li><code>"Item" (str)</code>: The name of the item.</li>
<li><code>"Cost" (int)</code>: The cost of the item in bells. Items that
cost 0 bells cannot be purchased and must be collected through other
means (such as crafting).</li>
<li><code>"Location" (str)</code>: The store or action through which the
item can be obtained.</li>
</ul>
<p>The first 6 rows of <code>items</code> are below, though
<code>items</code> has more rows than are shown here.</p>
<center><img src="../assets/images/disc04/items.png" width=500></center>
<p>The DataFrame <code>keepers</code> has 5 rows, each of which
represent a different shopkeeper in the <em>Animal Crossing: New
Horizons</em> universe.</p>
<p><code>keepers</code> is shown below in its entirety.</p>
<center><img src="../../assets/images/disc04/keepers1.png" width=350></center>
<p><br></p>
<p>How many rows are in the following DataFrame? Give your answer as an
integer.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>keepers.merge(items.iloc[:<span class="dv">6</span>], </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>              left_on<span class="op">=</span><span class="st">&quot;Store&quot;</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>              right_on<span class="op">=</span><span class="st">&quot;Location&quot;</span>)</span></code></pre></div>
<hr />
<h2 id="problem-4">Problem 4</h2>
<p>Suppose we create a DataFrame called <code>midwest</code> containing
Nishant‚Äôs flights departing from DTW, ORD, and MKE. <code>midwest</code>
has 10 rows; the bar chart below shows how many of these 10 flights
departed from each airport.</p>
<center><img src='../assets/images/disc04/midwest.png' width=30%></center>
<p><br></p>
<p>Consider the DataFrame that results from merging <code>midwest</code>
with itself, as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>double_merge <span class="op">=</span> midwest.merge(midwest, left_on<span class="op">=</span><span class="st">&#39;FROM&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;FROM&#39;</span>)</span></code></pre></div>
<p>How many rows does <code>double_merge</code> have?</p>
<hr />
<h2 id="problem-5">Problem 5</h2>
<p>In this problem, we will be using the following DataFrame
<code>students</code>, which contains various information about high
school students and the university/universities they applied to.</p>
<center><img src='../assets/images/disc04/students.png' width=65%></center>
<p>The columns are:</p>
<ul>
<li><code>'Name' (str)</code>: the name of the student.</li>
<li><code>'High School' (str)</code>: the High School that the student
attended.</li>
<li><code>'Email' (str)</code>: the email of the student.</li>
<li><code>'GPA' (float)</code>: the GPA of the student.</li>
<li><code>'AP' (int)</code>: the number of AP exams that the student
took.</li>
<li><code>'University' (str)</code>: the name of the university that the
student applied to.</li>
<li><code>'Admit' (str)</code>: the acceptance status of the student
(where ‚ÄòY‚Äô denotes that they were accepted to the university and ‚ÄòN‚Äô
denotes that they were not).</li>
</ul>
<p>The rows of <code>'student'</code> are arranged in no particular
order. The first eight rows of <code>'student'</code> are shown above
(though <code>'student'</code> has many more rows than pictured
here).</p>
<p><br></p>
<h3 id="problem-5.1">Problem 5.1</h3>
<p>Fill in the blank so that the result evaluates to a Series indexed by
<code>"Email"</code> that contains a <strong>list</strong> of the
universities that each student <strong>was admitted to</strong>. If a
student wasn‚Äôt admitted to any universities, they should have an empty
list.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>    students.groupby(<span class="st">&quot;Email&quot;</span>).<span class="bu">apply</span>(_____)</span></code></pre></div>
<p>What goes in the blank?</p>
<p><br></p>
<h3 id="problem-5.2">Problem 5.2</h3>
<p>Which of the following blocks of code correctly assign
<code>max_AP</code> to the maximum number of APs taken by a student who
was rejected by UC San Diego?</p>
<p>Option 1:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>cond1 <span class="op">=</span> students[<span class="st">&quot;Admit&quot;</span>] <span class="op">==</span> <span class="st">&quot;N&quot;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>cond2 <span class="op">=</span> students[<span class="st">&quot;University&quot;</span>] <span class="op">==</span> <span class="st">&quot;UC San Diego&quot;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>max_AP <span class="op">=</span> students.loc[cond1 <span class="op">&amp;</span> cond2, <span class="st">&quot;APs&quot;</span>].sort_values().iloc[<span class="op">-</span><span class="dv">1</span>]</span></code></pre></div>
<p>Option 2:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>cond1 <span class="op">=</span> students[<span class="st">&quot;Admit&quot;</span>] <span class="op">==</span> <span class="st">&quot;N&quot;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>cond2 <span class="op">=</span> students[<span class="st">&quot;University&quot;</span>] <span class="op">==</span> <span class="st">&quot;UC San Diego&quot;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>d3 <span class="op">=</span> students.groupby([<span class="st">&quot;University&quot;</span>, <span class="st">&quot;Admit&quot;</span>]).<span class="bu">max</span>().reset_index()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>max_AP <span class="op">=</span> d3.loc[cond1 <span class="op">&amp;</span> cond2, <span class="st">&quot;APs&quot;</span>].iloc[<span class="dv">0</span>]</span></code></pre></div>
<p>Option 3:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> students.pivot_table(index<span class="op">=</span><span class="st">&quot;Admit&quot;</span>, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                            columns<span class="op">=</span><span class="st">&quot;University&quot;</span>, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                            values<span class="op">=</span><span class="st">&quot;APs&quot;</span>, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                            aggfunc<span class="op">=</span><span class="st">&quot;max&quot;</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>max_AP <span class="op">=</span> p.loc[<span class="st">&quot;N&quot;</span>, <span class="st">&quot;UC San Diego&quot;</span>]</span></code></pre></div>
<p>Option 4:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .last() returns the element at the end of a Series it is called on</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>groups <span class="op">=</span> students.sort_values([<span class="st">&quot;APs&quot;</span>, <span class="st">&quot;Admit&quot;</span>]).groupby(<span class="st">&quot;University&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>max_AP <span class="op">=</span> groups[<span class="st">&quot;APs&quot;</span>].last()[<span class="st">&quot;UC San Diego&quot;</span>]</span></code></pre></div>
<p><strong>Select all that apply.</strong> There is at least one correct
option.</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> Option 1</p></li>
<li><p><input type="checkbox" disabled="" /> Option 2</p></li>
<li><p><input type="checkbox" disabled="" /> Option 3</p></li>
<li><p><input type="checkbox" disabled="" /> Option 4</p></li>
</ul>
<p><br></p>
<h3 id="problem-5.3">Problem 5.3</h3>
<p>Currently, <code>students</code> has a lot of repeated information ‚Äî
for instance, if a student applied to 10 universities, their GPA appears
10 times in <code>students</code>.</p>
<p>We want to generate a DataFrame that contains a single row for each
student, indexed by <code>"Email"</code>, that contains their
<code>"Name"</code>, <code>"High School"</code>, <code>"GPA"</code>, and
<code>"APs"</code>.</p>
<p>One attempt to create such a DataFrame is below.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>students.groupby(<span class="st">&quot;Email&quot;</span>).aggregate({<span class="st">&quot;Name&quot;</span>: <span class="st">&quot;max&quot;</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;High School&quot;</span>: <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;GPA&quot;</span>: <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;APs&quot;</span>: <span class="st">&quot;max&quot;</span>})</span></code></pre></div>
<p>There is exactly one issue with the line of code above. <strong>In
one sentence</strong>, explain what needs to be changed about the line
of code above so that the desired DataFrame is created.</p>
<p><br></p>
<h3 id="problem-5.4">Problem 5.4</h3>
<p>Consider the following snippet of code.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>pivoted <span class="op">=</span> students.assign(Admit<span class="op">=</span>students[<span class="st">&quot;Admit&quot;</span>] <span class="op">==</span> <span class="st">&quot;Y&quot;</span>) <span class="op">\</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                    .pivot_table(index<span class="op">=</span><span class="st">&quot;High School&quot;</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                                columns<span class="op">=</span><span class="st">&quot;University&quot;</span>, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                                values<span class="op">=</span><span class="st">&quot;Admit&quot;</span>, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                                aggfunc<span class="op">=</span><span class="st">&quot;sum&quot;</span>)</span></code></pre></div>
<p>Some of the rows and columns of <code>pivoted</code> are shown
below.</p>
<center><img src='../assets/images/disc04/pivot.png' width=40%></center>
<p>No students from Warren High were admitted to Columbia or Stanford.
However,<br />
<code>pivoted.loc["Warren High", "Columbia"]</code> and
<code>pivoted.loc["Warren High", "Stanford"]</code> evaluate to
different values. What is the reason for this difference?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Some students from Warren High applied to Stanford, and some others
applied to Columbia, but none applied to both.</p></li>
<li><p><input type="radio" disabled="" /> Some students from Warren High applied to Stanford but none applied
to Columbia.</p></li>
<li><p><input type="radio" disabled="" /> Some students from Warren High applied to Columbia but none applied
to Stanford.</p></li>
<li><p><input type="radio" disabled="" /> The students from Warren High that applied to both Columbia and
Stanford were all rejected from Stanford, but at least one was admitted
to Columbia.</p></li>
<li><p><input type="radio" disabled="" /> When using <code>pivot_table</code>, <code>pandas</code> was not able
to sum strings of the form <code>"Y"</code>, <code>"N"</code>, and
<code>"W"</code>, so the values in <code>pivoted</code> are
unreliable.</p></li>
</ul>
<p><br></p>
<hr />
<h2 id="problem-6">Problem 6</h2>
<p>The DataFrame <code>dogs</code>, contains one row for every
registered pet dog in Zurich, Switzerland in 2017.</p>
<p>The first few rows of <code>dogs</code> are shown below, but
<code>dogs</code> has many more rows than are shown.</p>
<center><img src="../assets/images/disc04/df.png" width=750></center>
<p><br></p>
<ul>
<li><code>"owner_id" (int)</code>: A unique ID for each owner. Note
that, for example, there are two rows in the preview for
<code>4215</code>, meaning that owner has at least 2 dogs.
<strong>Assume that if an <code>"owner_id"</code> appears in
<code>dogs</code> multiple times, the corresponding
<code>"owner_age"</code>, <code>"owner_sex"</code>, and
<code>"district"</code> are always the same.</strong></li>
<li><code>"owner_age" (str)</code>: The age group of the owner; either
<code>"11-20"</code>, <code>"21-30"</code>, ‚Ä¶, or <code>"91-100"</code>
(9 possibilities in total).</li>
<li><code>"owner_sex" (str)</code>: The birth sex of the owner; either
<code>"m"</code> (male) or <code>"f"</code> (female).</li>
<li><code>"district" (int)</code>: The city district the owner lives in;
a positive integer between <code>1</code> and <code>12</code>
(inclusive).</li>
<li><code>"primary_breed" (str)</code>: The primary breed of the
dog.</li>
<li><code>"secondary_breed" (str)</code>: The secondary breed of the
dog. If this column is not null, the dog is a ‚Äúmixed breed‚Äù dog;
otherwise, the dog is a ‚Äúpurebred‚Äù dog.</li>
<li><code>"dog_sex" (str)</code>: The birth sex of the dog; either
<code>"m"</code> (male) or <code>"f"</code> (female).</li>
<li><code>"birth_year" (int)</code>: The birth year of the dog.</li>
</ul>
<p>In this question, assume that there are more than 12 districts in
<code>dogs</code>.</p>
<p>Suppose we merge the <code>dogs</code> DataFrame with itself as
follows.</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># on=&quot;x&quot; is the same as specifying both left_on=&quot;x&quot; and right_on=&quot;x&quot;.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>double <span class="op">=</span> dogs.merge(dogs, on<span class="op">=</span><span class="st">&quot;district&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sort_index sorts a Series in increasing order of its index.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>square <span class="op">=</span> double[<span class="st">&quot;district&quot;</span>].value_counts().value_counts().sort_index()</span></code></pre></div>
<p>The first few rows of <code>square</code> are shown below.</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     <span class="dv">5500</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      <span class="dv">215</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>       <span class="dv">40</span></span></code></pre></div>
<p><br></p>
<h3 id="problem-6.1">Problem 6.1</h3>
<p>In <code>dogs</code>, there are 12 rows with a
<code>"district"</code> of <code>8</code>. How many rows of
<code>double</code> have a <code>"district"</code> of <code>8</code>?
Give your answer as a positive integer.</p>
<p><br></p>
<h3 id="problem-6.2">Problem 6.2</h3>
<p>What does the following expression evaluate to? Give your answer as a
positive integer.</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dogs.groupby(<span class="st">&quot;district&quot;</span>).<span class="bu">filter</span>(<span class="kw">lambda</span> df: df.shape[<span class="dv">0</span>] <span class="op">==</span> <span class="dv">3</span>).shape[<span class="dv">0</span>]</span></code></pre></div>
<p><em>Hint: Unlike in 5.1, your answer to 5.2 depends on the values in
<code>square</code>.</em></p>
<p><br></p>
<hr />
<h2 id="problem-7">Problem 7</h2>
<p>Kyle and Yutong are trying to decide where they‚Äôll study on campus
and start flipping a Michigan-themed coin, with a picture of the
Michigan Union on the heads side and a picture of the Shapiro
Undergraduate Library (aka the UgLi) on the tails side.</p>
<center><img src='../assets/images/disc04_new/michigan_union.png' width=400></center>
<p><br></p>
<p>Kyle flips the coin 21 times and sees 13 heads and 8 tails. He stores
this information in a DataFrame named <code>kyle</code> that has 21 rows
and 2 columns, such that:</p>
<ul>
<li><p>The <code>"flips"</code> column contains <code>"Heads"</code> 13
times and <code>"Tails"</code> 8 times.</p></li>
<li><p>The <code>"Markley"</code> column contains <code>"Kyle"</code> 21
times.</p></li>
</ul>
<p>Then, Yutong flips the coin 11 times and sees 4 heads and 7 tails.
She stores this information in a DataFrame named <code>yutong</code>
that has 11 rows and 2 columns, such that:</p>
<ul>
<li><p>The <code>"flips"</code> column contains <code>"Heads"</code> 4
times and <code>"Tails"</code> 7 times.</p></li>
<li><p>The <code>"MoJo"</code> column contains <code>"Yutong"</code> 11
times.</p></li>
</ul>
<p><br></p>
<h3 id="problem-7.1">Problem 7.1</h3>
<p>How many rows are in the following DataFrame? Give your answer as an
integer.</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>    kyle.merge(yutong, on<span class="op">=</span><span class="st">&quot;flips&quot;</span>)</span></code></pre></div>
<p><em>Hint: The answer is less than 200.</em></p>
<p><br></p>
<h3 id="problem-7.2">Problem 7.2</h3>
<p>Let <span class="math inline">A</span> be your answer to the previous
part. Now, suppose that:</p>
<ul>
<li><p><code>kyle</code> contains an additional row, whose
<code>"flips"</code> value is <code>"Total"</code> and whose
<code>"Markley"</code> value is 21.</p></li>
<li><p><code>yutong</code> contains an additional row, whose
<code>"flips"</code> value is <code>"Total"</code> and whose
<code>"MoJo"</code> value is 11.</p></li>
</ul>
<p>Suppose we again merge <code>kyle</code> and <code>yutong</code> on
the <code>"flips"</code> column. In terms of <span
class="math inline">A</span>, how many rows are in the new merged
DataFrame?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">A</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">A+1</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">A+2</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">A+4</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">A+231</span></p></li>
</ul>
<p><br></p>
<hr />
<h2 id="problem-8">Problem 8</h2>
<p>The <code>h</code> table records addresses within San Diego. Only 50
addresses are recorded. The index of the dataframe contains the numbers
1-50 as unique integers.</p>
<ul>
<li><code>"number" (int)</code>: Street address number</li>
<li><code>"street" (str)</code>: Street name</li>
</ul>
<center><img src="../assets/images/disc04/h.png" width=400></center>
<p>Fill in the Python code to create a DataFrame containing the
proportion of 4-digit address numbers for each unique street in
<code>h</code>.</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> foo(x):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    lengths <span class="op">=</span> __(a)__</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (lengths <span class="op">==</span> <span class="dv">4</span>).mean()</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>h.groupby(__(b)__).__(c)__(foo)</span></code></pre></div>
<hr />
<h2 id="problem-9">Problem 9</h2>
<p>Define <code>small_students</code> to be the DataFrame with 8 rows
and 2 columns shown directly below, and define <code>districts</code> to
be the DataFrame with 3 rows and 2 columns shown below
<code>small_students</code>.</p>
<!-- <p style="display: flex; justify-content: left; gap: 20px;">
    <img src='../assets/images/disc03/small_students.png' width=30%>
</p>
<p style="display: flex; justify-content: right; gap: 20px;">
    <img src='../assets/images/disc03/districts.png' width=30%>
</p> -->
<p align="center">
    <img src='../assets/images/disc04/small_students.png' width=30% style="display:inline-block; margin-right:20px;">
    <img src='../assets/images/disc04/districts.png' width=30% style="display:inline-block;">
</p>
<p>Consider the DataFrame <code>merged</code>, defined below.</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> small_students.merge(districts, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                                left_on<span class="op">=</span><span class="st">&quot;High School&quot;</span>, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                                right_on<span class="op">=</span><span class="st">&quot;school&quot;</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                                how<span class="op">=</span><span class="st">&quot;outer&quot;</span>)</span></code></pre></div>
<p>How many total <code>NaN</code> values does <code>merged</code>
contain? Give your answer as an integer.</p>
<hr />
<h2 id="problem-10">Problem 10</h2>
<p>The DataFrame <code>tv_excl</code> contains all of the information we
have for TV shows that are available to stream <em>exclusively</em> on a
single streaming service. The <code>"Service"</code> column contains the
name of the one streaming service that the TV show is available for
streaming on.</p>
<p>The first few rows of <code>tv_excl</code> are shown below (though,
of course, <code>tv_excl</code> has many more rows than are pictured
here). Note that <em>Being Erica</em> is not in <code>tv_excl</code>,
since it is available to stream on multiple services.</p>
<center><img src='../assets/images/disc04/tv-excl.png' width=50%></center>
<p>The DataFrame <code>counts</code>, shown in full below, contains the
number of TV shows for every combination of <code>"Age"</code> and
<code>"Service"</code>.</p>
<center><img src='../assets/images/disc04/pivot.png' width=30%></center>
<p>Given the above information, what does the following expression
evaluate to?</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>tv_excl.groupby([<span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Service&quot;</span>]).<span class="bu">sum</span>().shape[<span class="dv">0</span>]</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> 4</p></li>
<li><p><input type="radio" disabled="" /> 5</p></li>
<li><p><input type="radio" disabled="" /> 12</p></li>
<li><p><input type="radio" disabled="" /> 16</p></li>
<li><p><input type="radio" disabled="" /> 18</p></li>
<li><p><input type="radio" disabled="" /> 20</p></li>
<li><p><input type="radio" disabled="" /> 25</p></li>
</ul>
<hr />
<h2 id="problem-11">Problem 11</h2>
<p>The DataFrame <code>flights</code> contains information about recent
flights, with each row representing a specific flight and the following
columns:</p>
<ul>
<li><code>"flight num" (str)</code>: The unique code of the flight,
consisting of a two-character airline designator followed by 1 to 4
digits (e.g., <code>"UA1989"</code>).</li>
<li><code>"airline" (str)</code>: The airline name (e.g.,
<code>"United"</code>).</li>
<li><code>"departure" (str)</code>: The code for the airport from which
the flight departs (e.g., <code>"SAN"</code>).</li>
<li><code>"arrival" (str)</code>: The code for the airport at which the
flight arrives (e.g., <code>"LAX"</code>).</li>
</ul>
<p>Suppose we have another DataFrame <code>more_flights</code> which
contains the same columns as <code>flights</code>, but different rows.
Define <code>merged</code> as follows.</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>        merged <span class="op">=</span> flights.merge(more_flights, on <span class="op">=</span> <span class="st">&quot;airline&quot;</span>)</span></code></pre></div>
<p>Suppose that in <code>merged</code>, there are 108 flights where the
airline is <code>"United"</code>, and in <code>more_flights</code>,
there are 12 flights where the airline is <code>"United"</code>. If
<code>flights</code> has 15 rows in total, how many of these rows are
<strong>not</strong> for <code>"United"</code> flights? Give your answer
as an integer.</p>
<hr />
<h2 id="problem-12">Problem 12</h2>
<p>For your convenience, the first few rows of <code>tv</code> are shown
again below.</p>
<center><img src='../assets/images/disc04/data-info-wi23-mt.png' width=65%></center>
<p>For the purposes of this question only, suppose we have also access
to another similar DataFrame, <code>movies</code>, which contains
information about a variety of movies. The information we have for each
movie in <code>movies</code> is the same as the information we have for
each TV show in <code>tv</code>, except for IMDb ratings, which are
missing from <code>movies</code>.</p>
<p>The first few rows of <code>movies</code> are shown below (though
<code>movies</code> has many more rows than are pictured here).</p>
<center><img src='../assets/images/disc04/movies-dinfo-wi23-mt.png' width=65%></center>
<p><br></p>
<h3 id="problem-12.1">Problem 12.1</h3>
<p>The function <code>total_null</code>, defined below, takes in a
DataFrame and returns the total number of null values in the
DataFrame.</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>total_null <span class="op">=</span> <span class="kw">lambda</span> df: df.isna().<span class="bu">sum</span>().<span class="bu">sum</span>()</span></code></pre></div>
<p>Consider the function <code>delta</code>, defined below.</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> delta(a, b):</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    tv_a <span class="op">=</span> tv.head(a)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    movies_b <span class="op">=</span> movies.head(b)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    together <span class="op">=</span> pd.concat([tv_a, movies_b])</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total_null(together) <span class="op">-</span> total_null(tv_a) <span class="op">-</span> total_null(movies_b)</span></code></pre></div>
<p>Which of the following functions is equivalent to
<code>delta</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>lambda a, b: a</code></p></li>
<li><p><input type="radio" disabled="" /> <code>lambda a, b: b</code></p></li>
<li><p><input type="radio" disabled="" /> <code>lambda a, b: 9 * a</code></p></li>
<li><p><input type="radio" disabled="" /> <code>lambda a, b: 8 * b</code></p></li>
<li><p><input type="radio" disabled="" /> <code>lambda a, b: min(9 * a, 8 * b)</code></p></li>
</ul>
<p><br></p>
<h3 id="problem-12.2">Problem 12.2</h3>
<p>Fill in the blank to complete the implementation of the function
<code>size_of_merge</code>, which takes a string <code>col</code>,
corresponding to the name of a <strong>single</strong> column that is
shared between <code>tv</code> and <code>movies</code>, and returns the
<strong>number of rows in</strong> the DataFrame
<code>tv.merge(movies, on=col)</code>.</p>
<ul>
<li><p>For instance, <code>size_of_merge("Year")</code> should return
the number of rows in <code>tv.merge(movies, on="Year")</code>.</p></li>
<li><p>The purpose of this question is to have you think conceptually
about how merges work. As such, <strong>solutions containing
<code>merge</code> or <code>concat</code> will receive 0
points.</strong></p></li>
</ul>
<p><strong>What goes in the blank below?</strong></p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> size_of_merge(col):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (____).<span class="bu">sum</span>()</span></code></pre></div>
<p><strong><em>Hint</em></strong>: Consider the behavior below.</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> s1 <span class="op">=</span> pd.Series({<span class="st">&#39;a&#39;</span>: <span class="dv">2</span>, <span class="st">&#39;b&#39;</span>: <span class="dv">3</span>})</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> s2 <span class="op">=</span> pd.Series({<span class="st">&#39;c&#39;</span>: <span class="dv">4</span>, <span class="st">&#39;a&#39;</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">&#39;b&#39;</span>: <span class="dv">4</span>})</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> s1 <span class="op">*</span> s2</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>a    <span class="op">-</span><span class="fl">2.0</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>b    <span class="fl">12.0</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>c     NaN</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>dtype: float64</span></code></pre></div>
<p><br></p>
<hr />
<h2 id="problem-13">Problem 13</h2>
<p>For each day in May 2022, the DataFrame <code>streams</code> contains
the number of streams for each of the ‚ÄúTop 200" songs on Spotify that
day ‚Äî that is, the number of streams for the 200 songs with the most
streams on Spotify that day. The columns in <code>streams</code> are as
follows:</p>
<ul>
<li><p><code>"date"</code>: the date the song was streamed</p></li>
<li><p><code>"artist_names"</code>: name(s) of the artists who created
the song</p></li>
<li><p><code>"track_name"</code>: name of the song</p></li>
<li><p><code>"streams"</code>: the number of times the song was streamed
on Spotify that day</p></li>
</ul>
<p>The first few rows of <code>streams</code> are shown below. Since
there were 31 days in May and 200 songs per day, <code>streams</code>
has 6200 rows in total.</p>
<center><img src='../assets/images/disc04/streams.png' width=50%></center>
<p>Note that:</p>
<ul>
<li><p><code>streams</code> is already sorted in a very particular way ‚Äî
it is sorted by <code>"date"</code> in reverse chronological
(decreasing) order, and, within each <code>"date"</code>, by
<code>"streams"</code> in increasing order.</p></li>
<li><p>Many songs will appear multiple times in <code>streams</code>,
because many songs were in the Top 200 on more than one day.</p></li>
</ul>
<p><br></p>
<h3 id="problem-13.1">Problem 13.1</h3>
<p>Complete the implementation of the function <code>song_by_day</code>,
which takes in an integer <code>day</code> between 1 and 31
corresponding to a day in May, and an integer <code>n</code>, and
returns the song that had the <code>n</code>-th most streams on
<code>day</code>. For instance,<br />
<code>song_by_day(31, 199)</code> should evaluate to
<code>"pepas"</code>, because <code>"pepas"</code> was the 199th most
streamed song on May 31st.</p>
<p><strong>Note:</strong> You are not allowed to sort within
<code>song_by_day</code> ‚Äî remember, <code>streams</code> is already
sorted.</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> song_by_day(day, n):</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    day_str <span class="op">=</span> <span class="ss">f&quot;2022-05-</span><span class="sc">{</span><span class="bu">str</span>(day)<span class="sc">.</span>zfill(<span class="dv">2</span>)<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    day_only <span class="op">=</span> streams[__(a)__].iloc[__(b)__]</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> __(c)__</span></code></pre></div>
<p>What goes in each of the blanks?</p>
<p><br></p>
<h3 id="problem-13.2">Problem 13.2</h3>
<p>Below, we define a DataFrame <code>pivoted</code>.</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>pivoted <span class="op">=</span> streams.pivot_table(index<span class="op">=</span><span class="st">&quot;track_name&quot;</span>, columns<span class="op">=</span><span class="st">&quot;date&quot;</span>, </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                                values<span class="op">=</span><span class="st">&quot;streams&quot;</span>, aggfunc<span class="op">=</span>np.<span class="bu">max</span>)</span></code></pre></div>
<p>After defining <code>pivoted</code>, we define a Series
<code>mystery</code> below.</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mystery <span class="op">=</span> <span class="dv">31</span> <span class="op">-</span> pivoted.<span class="bu">apply</span>(<span class="kw">lambda</span> s: s.isna().<span class="bu">sum</span>(), axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<p><code>mystery.loc["pepas"]</code> evaluates to 23. In one sentence,
describe the relationship between the number 23 and the song
<code>"pepas"</code> in the context of the <code>streams</code> dataset.
For instance, a correctly formatted but incorrect answer is ‚ÄúI listened
to the song <code>"pepas"</code> 23 times today."</p>
<p><br></p>
<h3 id="problem-13.3">Problem 13.3</h3>
<p>In defining <code>pivoted</code>, we set the keyword argument
<code>aggfunc</code> to <code>np.max</code>. Which of the following
functions could we have used instead of <code>np.max</code> without
changing the values in <code>pivoted</code>? <strong>Select all that
apply.</strong></p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> <code>np.mean</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>np.median</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>len</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>lambda df: df.iloc[0]</code></p></li>
<li><p><input type="checkbox" disabled="" /> None of the above</p></li>
</ul>
<p><br></p>
<h3 id="problem-13.4">Problem 13.4</h3>
<p>Below, we define another DataFrame <code>another_mystery</code>.</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>another_mystery <span class="op">=</span> (streams.groupby(<span class="st">&quot;date&quot;</span>).last()</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                            .groupby([<span class="st">&quot;artist_names&quot;</span>, <span class="st">&quot;track_name&quot;</span>])</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                            .count().reset_index())</span></code></pre></div>
<p><code>another_mystery</code> has 5 rows. In one sentence, describe
the significance of the number 5 in the context of the
<code>streams</code> dataset. For instance, a correctly formatted but
incorrect answer is ‚ÄúThere are 5 unique artists in
<code>streams</code>." Your answer should not include the word‚Äùrow".</p>
<p><br></p>
<hr />
<h2 id="section"><span class="math display"> </span></h2>
<h4
id="feedback-find-an-error-still-confused-have-a-suggestion-let-us-know-here.">üëã
Feedback: Find an error? Still confused? Have a suggestion? Let us know
<a href="https://forms.gle/xK4DpWXh9rq8AKP37">here</a>.</h4>
<hr />
</body>
</html>
