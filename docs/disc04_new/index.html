<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Grouping, Pivoting, and Merging</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../assets/theme.css" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">Grouping, Pivoting, and Merging</h1>
</header>
<p><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<!-- add after bootstrap.min.css -->
<link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"/>
<!-- add after bootstrap.min.js or bootstrap.bundle.min.js -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script></p>
<!-- for difficulty gauges-->
<script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-B947E6J6H4"></script> -->
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  // gtag('js', new Date());

  // gtag('config', 'G-B947E6J6H4');
</script>
<p><a href="../index.html">← return to study.practicaldsc.org</a></p>
<hr />
<p>The problems in this worksheet are taken from past exams in similar
classes. Work on them <strong>on paper</strong>, since the exams you
take in this course will also be on paper. <br><br>We encourage you to
complete this worksheet in a live discussion section. Solutions will be
made available after all discussion sections have concluded. You don’t
need to submit your answers anywhere.<br><br><b>Note: We do not plan to
cover all problems here in the live discussion section</b>; the problems
we don’t cover can be used for extra practice.</p>
<hr />
<h2 id="problem-1">Problem 1</h2>
<p>The <code>laptops</code> DataFrame contains information on various
factors that influence the pricing of laptops. Each row represents a
laptop, and the columns are:</p>
<ul>
<li><code>"Mfr" (str)</code>: the company that manufactures the laptop,
like “Apple” or “Dell”.</li>
<li><code>"Model" (str)</code>: the model name of the laptop, such as
“MacBook Pro”.</li>
<li><code>"OS" (str)</code>: the operating system, such as “macOS” or
“Windows 11”.</li>
<li><code>"Screen Size" (float)</code>: the diagonal length of the
screen, in inches.</li>
<li><code>"Price" (float)</code>: the price of the laptop, in
dollars.</li>
</ul>
<p><br></p>
<h3 id="problem-1.1">Problem 1.1</h3>
<p><strong>Without using <code>groupby</code></strong>, write an
expression that evaluates to the average price of laptops with the
<code>"macOS"</code> operating system (the same quantity as above).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_1" aria-expanded="true" aria-controls="collapse1_1">
Click to view the solution.
</button>
</h2>
<div id="collapse1_1" class="accordion-collapse collapse"
aria-labelledby="heading1_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong>
<code>laptops.loc[laptops["OS"] == "macOS", "Price"].mean()</code></p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-1.2">Problem 1.2</h3>
<p><strong>Using <code>groupby</code></strong>, write an expression that
evaluates to the average price of laptops with the <code>"macOS"</code>
operating system.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_2" aria-expanded="true" aria-controls="collapse1_2">
Click to view the solution.
</button>
</h2>
<div id="collapse1_2" class="accordion-collapse collapse"
aria-labelledby="heading1_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong>
<code>laptops.groupby("OS")["Price"].mean().loc["macOS"]</code></p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-2">Problem 2</h2>
<p>You are given a DataFrame called <code>books</code> that contains
columns <code>'author'</code> (string), <code>'title'</code> (string),
<code>'num_chapters'</code> (int), and <code>'publication_year'</code>
(int).</p>
<p>Suppose that after doing <code>books.groupby('author').max()</code>,
one row says</p>
<table>
<thead>
<tr>
<th>author</th>
<th>title</th>
<th>num_chapters</th>
<th>publication_year</th>
</tr>
</thead>
<tbody>
<tr>
<td>Charles Dickens</td>
<td>Oliver Twist</td>
<td>53</td>
<td>1838</td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="problem-2.1">Problem 2.1</h3>
<p>Based on this data, can you conclude that Charles Dickens is the
alphabetically last of all author names in this dataset?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes</p></li>
<li><p><input type="radio" disabled="" /> No</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_1" aria-expanded="true" aria-controls="collapse2_1">
Click to view the solution.
</button>
</h2>
<div id="collapse2_1" class="accordion-collapse collapse"
aria-labelledby="heading2_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> No</p>
<p>When we group by <code>'author'</code>, all books by the same author
get aggregated together into a single row. The aggregation function is
applied separately to each other column besides the column we’re
grouping by. Since we’re grouping by <code>'author'</code> here, the
<code>'author'</code> column never has the <code>max()</code> function
applied to it. Instead, each unique value in the <code>'author'</code>
column becomes a value in the index of the grouped DataFrame. We are
told that the Charles Dickens row is just one row of the output, but we
don’t know anything about the other rows of the output, or the other
authors. We can’t say anything about where Charles Dickens falls when
authors are ordered alphabetically (but it’s probably not last!)</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.2">Problem 2.2</h3>
<p>Based on this data, can you conclude that Charles Dickens wrote
<em>Oliver Twist</em>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes</p></li>
<li><p><input type="radio" disabled="" /> No</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_2" aria-expanded="true" aria-controls="collapse2_2">
Click to view the solution.
</button>
</h2>
<div id="collapse2_2" class="accordion-collapse collapse"
aria-labelledby="heading2_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> Yes</p>
<p>Grouping by <code>'author'</code> collapses all books written by the
same author into a single row. Since we’re applying the
<code>max()</code> function to aggregate these books, we can conclude
that <em>Oliver Twist</em> is alphabetically last among all books in the
<code>books</code> DataFrame written by Charles Dickens. So Charles
Dickens did write <em>Oliver Twist</em> based on this data.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.3">Problem 2.3</h3>
<p>Based on this data, can you conclude that <em>Oliver Twist</em> has
53 chapters?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes</p></li>
<li><p><input type="radio" disabled="" /> No</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_3" aria-expanded="true" aria-controls="collapse2_3">
Click to view the solution.
</button>
</h2>
<div id="collapse2_3" class="accordion-collapse collapse"
aria-labelledby="heading2_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> No</p>
<p>The key to this problem is that <code>groupby</code> applies the
aggregation function, <code>max()</code> in this case, independently to
each column. The output should be interpreted as follows:</p>
<ul>
<li>Among all books in <code>books</code> written by Charles Dickens,
<em>Oliver Twist</em> is the title that is alphabetically last.</li>
<li>Among all books in <code>books</code> written by Charles Dickens, 53
is the greatest number of chapters.</li>
<li>Among all books in <code>books</code> written by Charles Dickens,
1838 is the latest year of publication.</li>
</ul>
<p>However, the book titled <em>Oliver Twist</em>, the book with 53
chapters, and the book published in 1838 are not necessarily all the
same book. We cannot conclude, based on this data, that <em>Oliver
Twist</em> has 53 chapters.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.4">Problem 2.4</h3>
<p>Based on this data, can you conclude that Charles Dickens wrote a
book with 53 chapters that was published in 1838?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes</p></li>
<li><p><input type="radio" disabled="" /> No</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_4" aria-expanded="true" aria-controls="collapse2_4">
Click to view the solution.
</button>
</h2>
<div id="collapse2_4" class="accordion-collapse collapse"
aria-labelledby="heading2_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> No</p>
<p>As explained in the previous question, the <code>max()</code>
function is applied separately to each column, so the book written by
Charles Dickens with 53 chapters may not be the same book as the book
written by Charles Dickens published in 1838.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-3">Problem 3</h2>
<p>The DataFrame <code>items</code> describes various items available to
collect or purchase using bells, the currency used in the game
<em>Animal Crossing: New Horizons</em>.</p>
<p>For each item, we have:</p>
<ul>
<li><code>"Item" (str)</code>: The name of the item.</li>
<li><code>"Cost" (int)</code>: The cost of the item in bells. Items that
cost 0 bells cannot be purchased and must be collected through other
means (such as crafting).</li>
<li><code>"Location" (str)</code>: The store or action through which the
item can be obtained.</li>
</ul>
<p>The first 6 rows of <code>items</code> are below, though
<code>items</code> has more rows than are shown here.</p>
<center><img src="../assets/images/disc04_new/items.png" width=500></center>
<p>The DataFrame <code>keepers</code> has 5 rows, each of which
represent a different shopkeeper in the <em>Animal Crossing: New
Horizons</em> universe.</p>
<p><code>keepers</code> is shown below in its entirety.</p>
<center><img src="../../assets/images/disc04_new/keepers1.png" width=350></center>
<p><br></p>
<p>How many rows are in the following DataFrame? Give your answer as an
integer.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>keepers.merge(items.iloc[:<span class="dv">6</span>], </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>              left_on<span class="op">=</span><span class="st">&quot;Store&quot;</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>              right_on<span class="op">=</span><span class="st">&quot;Location&quot;</span>)</span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3" aria-expanded="true" aria-controls="collapse3">
Click to view the solution.
</button>
</h2>
<div id="collapse3" class="accordion-collapse collapse"
aria-labelledby="heading3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: 10</p>
<p>Since the type of join is not specified, this is an inner join. Each
row in <code>keepers</code> is merged with each row in
<code>items</code> only if <code>'Store'</code> in <code>keepers</code>
equals <code>'Location'</code> in <code>items</code>. Each row in
<code>keepers</code> has the following number of merges: row 0 has 1,
row 1 has 3, row 2 has 3, row 3 has 0 (there are no rows in
<code>items</code> with <code>'Location'</code> equal to ‘Kicks Shoe
Store’), and row 4 has 3.</p>
<p><span class="math display">1 + 3 + 3 + 0 + 3 = 10</span></p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-4">Problem 4</h2>
<p>Suppose we create a DataFrame called <code>midwest</code> containing
Nishant’s flights departing from DTW, ORD, and MKE. <code>midwest</code>
has 10 rows; the bar chart below shows how many of these 10 flights
departed from each airport.</p>
<center><img src='../assets/images/disc04_new/midwest.png' width=30%></center>
<p><br></p>
<p>Consider the DataFrame that results from merging <code>midwest</code>
with itself, as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>double_merge <span class="op">=</span> midwest.merge(midwest, left_on<span class="op">=</span><span class="st">&#39;FROM&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;FROM&#39;</span>)</span></code></pre></div>
<p>How many rows does <code>double_merge</code> have?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4" aria-expanded="true" aria-controls="collapse4">
Click to view the solution.
</button>
</h2>
<div id="collapse4" class="accordion-collapse collapse"
aria-labelledby="heading4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> 38</p>
<p>There are two flights from DTW. When we merge <code>midwest</code>
with itself on the <code>'FROM'</code> column, each of these flights
gets paired up with each of these flights, for a total of four rows in
the output. That is, the first flight from DTW gets paired with both the
first and second flights from DTW. Similarly, the second flight from DTW
gets paired with both the first and second flights from DTW.</p>
<p>Following this logic, each of the five flights from ORD gets paired
with each of the five flights from ORD, for an additional 25 rows in the
output. For MKE, there will be 9 rows in the output. The total is
therefore <span class="math inline">2^2 + 5^2 + 3^2 = 4 + 25 + 9 =
38</span> rows.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-5">Problem 5</h2>
<p>The DataFrame <code>dogs</code>, contains one row for every
registered pet dog in Zurich, Switzerland in 2017.</p>
<p>The first few rows of <code>dogs</code> are shown below, but
<code>dogs</code> has many more rows than are shown.</p>
<center><img src="../assets/images/disc04_new/df.png" width=750></center>
<p><br></p>
<ul>
<li><code>"owner_id" (int)</code>: A unique ID for each owner. Note
that, for example, there are two rows in the preview for
<code>4215</code>, meaning that owner has at least 2 dogs.
<strong>Assume that if an <code>"owner_id"</code> appears in
<code>dogs</code> multiple times, the corresponding
<code>"owner_age"</code>, <code>"owner_sex"</code>, and
<code>"district"</code> are always the same.</strong></li>
<li><code>"owner_age" (str)</code>: The age group of the owner; either
<code>"11-20"</code>, <code>"21-30"</code>, …, or <code>"91-100"</code>
(9 possibilities in total).</li>
<li><code>"owner_sex" (str)</code>: The birth sex of the owner; either
<code>"m"</code> (male) or <code>"f"</code> (female).</li>
<li><code>"district" (int)</code>: The city district the owner lives in;
a positive integer between <code>1</code> and <code>12</code>
(inclusive).</li>
<li><code>"primary_breed" (str)</code>: The primary breed of the
dog.</li>
<li><code>"secondary_breed" (str)</code>: The secondary breed of the
dog. If this column is not null, the dog is a “mixed breed” dog;
otherwise, the dog is a “purebred” dog.</li>
<li><code>"dog_sex" (str)</code>: The birth sex of the dog; either
<code>"m"</code> (male) or <code>"f"</code> (female).</li>
<li><code>"birth_year" (int)</code>: The birth year of the dog.</li>
</ul>
<p>In this question, assume that there are more than 12 districts in
<code>dogs</code>.</p>
<p>Suppose we merge the <code>dogs</code> DataFrame with itself as
follows.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># on=&quot;x&quot; is the same as specifying both left_on=&quot;x&quot; and right_on=&quot;x&quot;.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>double <span class="op">=</span> dogs.merge(dogs, on<span class="op">=</span><span class="st">&quot;district&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sort_index sorts a Series in increasing order of its index.</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>square <span class="op">=</span> double[<span class="st">&quot;district&quot;</span>].value_counts().value_counts().sort_index()</span></code></pre></div>
<p>The first few rows of <code>square</code> are shown below.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     <span class="dv">5500</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      <span class="dv">215</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>       <span class="dv">40</span></span></code></pre></div>
<p><br></p>
<h3 id="problem-5.1">Problem 5.1</h3>
<p>In <code>dogs</code>, there are 12 rows with a
<code>"district"</code> of <code>8</code>. How many rows of
<code>double</code> have a <code>"district"</code> of <code>8</code>?
Give your answer as a positive integer.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_1" aria-expanded="true" aria-controls="collapse5_1">
Click to view the solution.
</button>
</h2>
<div id="collapse5_1" class="accordion-collapse collapse"
aria-labelledby="heading5_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <span class="math inline">144</span></p>
<p>When we merge <code>dogs</code> with <code>dogs</code> on
<code>"district"</code>, each <code>8</code> in the first
<code>dogs</code> DataFrame will be combined with each <code>8</code> in
the second <code>dogs</code> DataFrame. Since there are 12 in the first
and 12 in the second, there are <span class="math inline">12 \cdot 12 =
144</span> combinations.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.2">Problem 5.2</h3>
<p>What does the following expression evaluate to? Give your answer as a
positive integer.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dogs.groupby(<span class="st">&quot;district&quot;</span>).<span class="bu">filter</span>(<span class="kw">lambda</span> df: df.shape[<span class="dv">0</span>] <span class="op">==</span> <span class="dv">3</span>).shape[<span class="dv">0</span>]</span></code></pre></div>
<p><em>Hint: Unlike in 5.1, your answer to 5.2 depends on the values in
<code>square</code>.</em></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_2" aria-expanded="true" aria-controls="collapse5_2">
Click to view the solution.
</button>
</h2>
<div id="collapse5_2" class="accordion-collapse collapse"
aria-labelledby="heading5_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <span class="math inline">120</span></p>
<p><code>square</code> is telling us that:</p>
<ul>
<li>There are 5500 districts that appeared just 1x in
<code>dogs</code>.</li>
<li>There are 215 districts that appeared 2x in <code>dogs</code> (2x,
not 4x, because of the logic explained in the 5a rubric item).</li>
<li>There are 40 districts that appeared 3x in <code>dogs</code>.</li>
</ul>
<p>The expression given in this question is keeping all of the rows
corresponding to districts that appear 3 times. There are 40 districts
that appear 3 times. So, the total number of rows in this DataFrame is
<span class="math inline">40 \cdot 3 = 120</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-6">Problem 6</h2>
<p>Kyle and Yutong are trying to decide where they’ll study on campus
and start flipping a Michigan-themed coin, with a picture of the
Michigan Union on the heads side and a picture of the Shapiro
Undergraduate Library (aka the UgLi) on the tails side.</p>
<center><img src='../assets/images/disc04_new/michigan_union.png' width=400></center>
<p><br></p>
<p>Kyle flips the coin 21 times and sees 13 heads and 8 tails. He stores
this information in a DataFrame named <code>kyle</code> that has 21 rows
and 2 columns, such that:</p>
<ul>
<li><p>The <code>"flips"</code> column contains <code>"Heads"</code> 13
times and <code>"Tails"</code> 8 times.</p></li>
<li><p>The <code>"Markley"</code> column contains <code>"Kyle"</code> 21
times.</p></li>
</ul>
<p>Then, Yutong flips the coin 11 times and sees 4 heads and 7 tails.
She stores this information in a DataFrame named <code>yutong</code>
that has 11 rows and 2 columns, such that:</p>
<ul>
<li><p>The <code>"flips"</code> column contains <code>"Heads"</code> 4
times and <code>"Tails"</code> 7 times.</p></li>
<li><p>The <code>"MoJo"</code> column contains <code>"Yutong"</code> 11
times.</p></li>
</ul>
<p><br></p>
<h3 id="problem-6.1">Problem 6.1</h3>
<p>How many rows are in the following DataFrame? Give your answer as an
integer.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>    kyle.merge(yutong, on<span class="op">=</span><span class="st">&quot;flips&quot;</span>)</span></code></pre></div>
<p><em>Hint: The answer is less than 200.</em></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_1" aria-expanded="true" aria-controls="collapse6_1">
Click to view the solution.
</button>
</h2>
<div id="collapse6_1" class="accordion-collapse collapse"
aria-labelledby="heading6_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: 108</p>
<p>Since we used the argument <code>on="flips</code>, rows from
<code>kyle</code> and <code>yutong</code> will be combined whenever they
have matching values in their <code>"flips"</code> columns.</p>
<p>For the <code>kyle</code> DataFrame:</p>
<ul>
<li>There are 13 rows with <code>"Heads"</code> in the
<code>"flips"</code> column.</li>
<li>There are 8 rows with <code>"Tails"</code> in the
<code>"flips"</code> column.</li>
</ul>
<p>For the <code>yutong</code> DataFrame:</p>
<ul>
<li>There are 4 rows with <code>"Heads"</code> in the
<code>"flips"</code> column.</li>
<li>There are 7 rows with <code>"Tails"</code> in the
<code>"flips"</code> column.</li>
</ul>
<p>The merged DataFrame will also only have the values
<code>"Heads"</code> and <code>"Tails"</code> in its
<code>"flips"</code> column.</p>
<ul>
<li>The 13 <code>"Heads"</code> rows from <code>kyle</code> will each
pair with the 4 <code>"Heads"</code> rows from <code>yutong</code>. This
results in <span class="math inline">13 \cdot 4 = 52</span> rows with
<code>"Heads"</code></li>
<li>The 8 <code>"Tails"</code> rows from <code>kyle</code> will each
pair with the 7 <code>"Tails"</code> rows from <code>yutong</code>. This
results in <span class="math inline">8 \cdot 7 = 56</span> rows with
<code>"Tails"</code>.</li>
</ul>
<p>Then, the total number of rows in the merged DataFrame is <span class="math inline">52 + 56 = 108</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-6.2">Problem 6.2</h3>
<p>Let <span class="math inline">A</span> be your answer to the previous
part. Now, suppose that:</p>
<ul>
<li><p><code>kyle</code> contains an additional row, whose
<code>"flips"</code> value is <code>"Total"</code> and whose
<code>"Markley"</code> value is 21.</p></li>
<li><p><code>yutong</code> contains an additional row, whose
<code>"flips"</code> value is <code>"Total"</code> and whose
<code>"MoJo"</code> value is 11.</p></li>
</ul>
<p>Suppose we again merge <code>kyle</code> and <code>yutong</code> on
the <code>"flips"</code> column. In terms of <span
class="math inline">A</span>, how many rows are in the new merged
DataFrame?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">A</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">A+1</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">A+2</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">A+4</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">A+231</span></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_2" aria-expanded="true" aria-controls="collapse6_2">
Click to view the solution.
</button>
</h2>
<div id="collapse6_2" class="accordion-collapse collapse"
aria-labelledby="heading6_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <span class="math inline">A+1</span></p>
<p>The additional row in each DataFrame has a unique
<code>"flips"</code> value of <code>"Total"</code>. When we merge on the
<code>"flips"</code> column, this unique value will only create a single
new row in the merged DataFrame, as it pairs the <code>"Total"</code>
from <code>kyle</code> with the <code>"Total"</code> from
<code>yutong</code>. The rest of the rows are the same as in the
previous merge, and as such, they will contribute the same number of
rows, <span class="math inline">A</span>, to the merged DataFrame. Thus,
the total number of rows in the new merged DataFrame will be <span class="math inline">A</span> (from the original matching rows) plus 1
(from the new <code>"Total"</code> rows), which sums up to <span class="math inline">A+1</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-7">Problem 7</h2>
<p>The <code>h</code> table records addresses within San Diego. Only 50
addresses are recorded. The index of the dataframe contains the numbers
1-50 as unique integers.</p>
<ul>
<li><code>"number" (int)</code>: Street address number</li>
<li><code>"street" (str)</code>: Street name</li>
</ul>
<center><img src="../assets/images/disc04_new/h.png" width=400></center>
<p>Fill in the Python code to create a DataFrame containing the
proportion of 4-digit address numbers for each unique street in
<code>h</code>.</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> foo(x):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    lengths <span class="op">=</span> __(a)__</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (lengths <span class="op">==</span> <span class="dv">4</span>).mean()</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>h.groupby(__(b)__).__(c)__(foo)</span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7" aria-expanded="true" aria-controls="collapse7">
Click to view the solution.
</button>
</h2>
<div id="collapse7" class="accordion-collapse collapse"
aria-labelledby="heading7" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong></p>
<p>(a): <code>x.astype(str).str.len()</code></p>
<p>(b): <code>'street'</code></p>
<p>(c): <code>agg</code></p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-8">Problem 8</h2>
<p>Define <code>small_students</code> to be the DataFrame with 8 rows
and 2 columns shown directly below, and define <code>districts</code> to
be the DataFrame with 3 rows and 2 columns shown below
<code>small_students</code>.</p>
<!-- <p style="display: flex; justify-content: left; gap: 20px;">
    <img src='../assets/images/disc03/small_students.png' width=30%>
</p>
<p style="display: flex; justify-content: right; gap: 20px;">
    <img src='../assets/images/disc03/districts.png' width=30%>
</p> -->
<p align="center">
    <img src='../assets/images/disc04_new/small_students.png' width=30% style="display:inline-block; margin-right:20px;">
    <img src='../assets/images/disc04_new/districts.png' width=30% style="display:inline-block;">
</p>
<p>Consider the DataFrame <code>merged</code>, defined below.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> small_students.merge(districts, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                                left_on<span class="op">=</span><span class="st">&quot;High School&quot;</span>, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                                right_on<span class="op">=</span><span class="st">&quot;school&quot;</span>, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                                how<span class="op">=</span><span class="st">&quot;outer&quot;</span>)</span></code></pre></div>
<p>How many total <code>NaN</code> values does <code>merged</code>
contain? Give your answer as an integer.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading8">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse8" aria-expanded="true" aria-controls="collapse8">
Click to view the solution.
</button>
</h2>
<div id="collapse8" class="accordion-collapse collapse"
aria-labelledby="heading8" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>4</p>
<p><code>merged</code> is shown below.</p>
<center><img src="../assets/images/disc03/merge-ans-1.png" width="45%"/></center>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-9">Problem 9</h2>
<p>The DataFrame <code>tv_excl</code> contains all of the information we
have for TV shows that are available to stream <em>exclusively</em> on a
single streaming service. The <code>"Service"</code> column contains the
name of the one streaming service that the TV show is available for
streaming on.</p>
<p>The first few rows of <code>tv_excl</code> are shown below (though,
of course, <code>tv_excl</code> has many more rows than are pictured
here). Note that <em>Being Erica</em> is not in <code>tv_excl</code>,
since it is available to stream on multiple services.</p>
<center><img src='../assets/images/disc04_new/tv-excl.png' width=65%></center>
<p>The DataFrame <code>counts</code>, shown in full below, contains the
number of TV shows for every combination of <code>"Age"</code> and
<code>"Service"</code>.</p>
<center><img src='../assets/images/disc04_new/pivot.png' width=40%></center>
<p>Given the above information, what does the following expression
evaluate to?</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tv_excl.groupby([<span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Service&quot;</span>]).<span class="bu">sum</span>().shape[<span class="dv">0</span>]</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> 4</p></li>
<li><p><input type="radio" disabled="" /> 5</p></li>
<li><p><input type="radio" disabled="" /> 12</p></li>
<li><p><input type="radio" disabled="" /> 16</p></li>
<li><p><input type="radio" disabled="" /> 18</p></li>
<li><p><input type="radio" disabled="" /> 20</p></li>
<li><p><input type="radio" disabled="" /> 25</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading9">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse9" aria-expanded="true" aria-controls="collapse9">
Click to view the solution.
</button>
</h2>
<div id="collapse9" class="accordion-collapse collapse"
aria-labelledby="heading9" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: 18</p>
<p>Note that the DataFrame <code>counts</code> is a pivot table, created
using
<code>tv_excl.pivot_table(index="Age", columns="Service", aggfunc="size")</code>.
As we saw in lecture, pivot tables contain the same information as the
result of grouping on two columns.</p>
<p>The DataFrame <code>tv_excl.groupby(["Age", "Service"]).sum()</code>
will have one row for every unique combination of <code>"Age"</code> and
<code>"Service"</code> in <code>tv_excl</code>. (The same is true even
if we used a different aggregation method, like <code>.mean()</code> or
<code>.max()</code>.) As <code>counts</code> shows us,
<code>tv_excl</code> contains every possible combination of a single
element in {<code>"13+"</code>, <code>"16+"</code>, <code>"18+"</code>,
<code>"7+"</code>, <code>"all"</code>} with a single element in
{<code>"Disney+"</code>, <code>"Hulu"</code>, <code>"Netflix"</code>,
<code>"Prime Video"</code>}, except for (<code>"13+"</code>,
<code>"Disney+"</code>) and (<code>"18+"</code>,
<code>"Disney+"</code>), which were not present in <code>tv_excl</code>;
if they were, they would have non-null values in
<code>counts</code>.</p>
<p>As such, <code>tv_excl.groupby(["Age", "Service"]).sum()</code> will
have <span class="math inline">20 - 2 = 18</span> rows, and
<code>tv_excl.groupby(["Age", "Service"]).sum().shape[0]</code>
evaluates to 18.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-10">Problem 10</h2>
<p>The DataFrame <code>flights</code> contains information about recent
flights, with each row representing a specific flight and the following
columns:</p>
<ul>
<li><code>"flight num" (str)</code>: The unique code of the flight,
consisting of a two-character airline designator followed by 1 to 4
digits (e.g., <code>"UA1989"</code>).</li>
<li><code>"airline" (str)</code>: The airline name (e.g.,
<code>"United"</code>).</li>
<li><code>"departure" (str)</code>: The code for the airport from which
the flight departs (e.g., <code>"SAN"</code>).</li>
<li><code>"arrival" (str)</code>: The code for the airport at which the
flight arrives (e.g., <code>"LAX"</code>).</li>
</ul>
<p>Suppose we have another DataFrame <code>more_flights</code> which
contains the same columns as <code>flights</code>, but different rows.
Define <code>merged</code> as follows.</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>        merged <span class="op">=</span> flights.merge(more_flights, on <span class="op">=</span> <span class="st">&quot;airline&quot;</span>)</span></code></pre></div>
<p>Suppose that in <code>merged</code>, there are 108 flights where the
airline is <code>"United"</code>, and in <code>more_flights</code>,
there are 12 flights where the airline is <code>"United"</code>. If
<code>flights</code> has 15 rows in total, how many of these rows are
<strong>not</strong> for <code>"United"</code> flights? Give your answer
as an integer.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading10">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse10" aria-expanded="true" aria-controls="collapse10">
Click to view the solution.
</button>
</h2>
<div id="collapse10" class="accordion-collapse collapse"
aria-labelledby="heading10" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> 6</p>
<p>We are merging dataframes <code>flights</code> and
<code>more_flights</code> according to the airline each flight belongs
to. All the <code>"United"</code> flights in <code>more_flights</code>
will be merged with all the <code>"United"</code> flights in
<code>flights</code>, which we know gives us 108 total flights. We also
know that there are 12 <code>"United"</code> flights in
<code>more_flights</code>. To find the number of <code>"United"</code>
flights in <code>flights</code>, we simply need to divide the total
number of <code>"United"</code> flights in <code>merged</code> by the
number of <code>"United"</code> flights in <code>more_flights</code>,
which is 108/12 = 9. If <code>flights</code> has a total of 15 rows,
then the total number of non-United rows is equal to 15 - 9 = 6.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-11">Problem 11</h2>
<p>For your convenience, the first few rows of <code>tv</code> are shown
again below.</p>
<center><img src='../assets/images/disc04_new/data-info-wi23-mt.png' width=65%></center>
<p>For the purposes of this question only, suppose we have also access
to another similar DataFrame, <code>movies</code>, which contains
information about a variety of movies. The information we have for each
movie in <code>movies</code> is the same as the information we have for
each TV show in <code>tv</code>, except for IMDb ratings, which are
missing from <code>movies</code>.</p>
<p>The first few rows of <code>movies</code> are shown below (though
<code>movies</code> has many more rows than are pictured here).</p>
<center><img src='../assets/images/disc04_new/movies-dinfo-wi23-mt.png' width=65%></center>
<p><br></p>
<h3 id="problem-11.1">Problem 11.1</h3>
<p>The function <code>total_null</code>, defined below, takes in a
DataFrame and returns the total number of null values in the
DataFrame.</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>total_null <span class="op">=</span> <span class="kw">lambda</span> df: df.isna().<span class="bu">sum</span>().<span class="bu">sum</span>()</span></code></pre></div>
<p>Consider the function <code>delta</code>, defined below.</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> delta(a, b):</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    tv_a <span class="op">=</span> tv.head(a)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    movies_b <span class="op">=</span> movies.head(b)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    together <span class="op">=</span> pd.concat([tv_a, movies_b])</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total_null(together) <span class="op">-</span> total_null(tv_a) <span class="op">-</span> total_null(movies_b)</span></code></pre></div>
<p>Which of the following functions is equivalent to
<code>delta</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>lambda a, b: a</code></p></li>
<li><p><input type="radio" disabled="" /> <code>lambda a, b: b</code></p></li>
<li><p><input type="radio" disabled="" /> <code>lambda a, b: 9 * a</code></p></li>
<li><p><input type="radio" disabled="" /> <code>lambda a, b: 8 * b</code></p></li>
<li><p><input type="radio" disabled="" /> <code>lambda a, b: min(9 * a, 8 * b)</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading11_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse11_1" aria-expanded="true" aria-controls="collapse11_1">
Click to view the solution.
</button>
</h2>
<div id="collapse11_1" class="accordion-collapse collapse"
aria-labelledby="heading11_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <code>lambda a, b: b</code></p>
<p>Let’s understand what each function does.</p>
<ul>
<li><code>total_null</code> just counts all the null values in a
DataFrame.</li>
<li><code>delta</code> concatenates the first <code>a</code> rows of
<code>tv</code> with the first <code>b</code> rows of
<code>movies</code> <strong>vertically</strong>, that is, on top of one
another (over axis 0). It then returns the difference between the total
number of null values in the concatenated DataFrame and the total number
of null values in the first <code>a</code> rows of <code>tv</code> and
first <code>b</code> rows of <code>movies</code> – in other words, it
returns <strong>the number of null values that were added as a result of
the concatenation</strong>.</li>
</ul>
<p>The key here is recognizing that <code>tv</code> and
<code>movies</code> have all of the same column names,
<strong>except</strong> <code>movies</code> doesn’t have an
<code>"IMDb"</code> column. As a result, when we concatenate, the
<code>"IMDb"</code> column will contain null values for every row that
was originally from <code>movies</code>. Since <code>b</code> rows from
<code>movies</code> are in the concatenated DataFrame, <code>b</code>
new null values are introduced as a result of the concatenation, and
thus <code>lambda, a, b: b</code> does the same thing as
<code>delta</code>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-11.2">Problem 11.2</h3>
<p>Fill in the blank to complete the implementation of the function
<code>size_of_merge</code>, which takes a string <code>col</code>,
corresponding to the name of a <strong>single</strong> column that is
shared between <code>tv</code> and <code>movies</code>, and returns the
<strong>number of rows in</strong> the DataFrame
<code>tv.merge(movies, on=col)</code>.</p>
<ul>
<li><p>For instance, <code>size_of_merge("Year")</code> should return
the number of rows in <code>tv.merge(movies, on="Year")</code>.</p></li>
<li><p>The purpose of this question is to have you think conceptually
about how merges work. As such, <strong>solutions containing
<code>merge</code> or <code>concat</code> will receive 0
points.</strong></p></li>
</ul>
<p><strong>What goes in the blank below?</strong></p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> size_of_merge(col):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (____).<span class="bu">sum</span>()</span></code></pre></div>
<p><strong><em>Hint</em></strong>: Consider the behavior below.</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> s1 <span class="op">=</span> pd.Series({<span class="st">&#39;a&#39;</span>: <span class="dv">2</span>, <span class="st">&#39;b&#39;</span>: <span class="dv">3</span>})</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> s2 <span class="op">=</span> pd.Series({<span class="st">&#39;c&#39;</span>: <span class="dv">4</span>, <span class="st">&#39;a&#39;</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">&#39;b&#39;</span>: <span class="dv">4</span>})</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> s1 <span class="op">*</span> s2</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>a    <span class="op">-</span><span class="fl">2.0</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>b    <span class="fl">12.0</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>c     NaN</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>dtype: float64</span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading11_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse11_2" aria-expanded="true" aria-controls="collapse11_2">
Click to view the solution.
</button>
</h2>
<div id="collapse11_2" class="accordion-collapse collapse"
aria-labelledby="heading11_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>:
<code>tv[col].value_counts() * movies[col].value_counts()</code></p>
<p><code>tv.merge(movies, on=col)</code> contains one row for every
“match” between <code>tv[col]</code> and <code>movies[col]</code>.
Suppose, for example, that <code>col="Year"</code>. If
<code>tv["Year"]</code> contains 30 values equal to 2019, and
<code>movies["Year"]</code> contains 5 values equal to 2019,
<code>tv.merge(movies, on="Year")</code> will contain <span class="math inline">30 \cdot 5 = 150</span> rows in which the
<code>"Year"</code> value is equal to 2019 – one for every combination
of a 2019 row in <code>tv</code> and a 2019 row in
<code>movies</code>.</p>
<p><code>tv["Year"].value_counts()</code> and
<code>movies["Year"].value_counts()</code> contain, respectively, the
frequencies of the unique values in <code>tv["Year"]</code> and
<code>movies["Year"]</code>. Using the 2019 example from above,
<code>tv["Year"].value_counts() * movies["Year"].value_counts()</code>
will contain a row whose index is 2019 and whose value is 150, with
similar other entries for the other years in the two Series. (The hint
is meant to demonstrate the fact that no matter how the two Series are
sorted, the product is done element-wise by matching up indexes.) Then,
<code>(tv["Year"].value_counts() * movies["Year"].value_counts()).sum()</code>
will sum these products across all years, ignoring null values.</p>
<p>As such, the answer we were looking for is
<code>tv[col].value_counts() * movies[col].value_counts()</code>
(remember, <code>"Year"</code> was just an example for this
explanation).</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="section"><span class="math display"> </span></h2>
<h4
id="feedback-find-an-error-still-confused-have-a-suggestion-let-us-know-here.">👋
Feedback: Find an error? Still confused? Have a suggestion? Let us know
<a href="https://forms.gle/xK4DpWXh9rq8AKP37">here</a>.</h4>
<hr />
</body>
</html>
