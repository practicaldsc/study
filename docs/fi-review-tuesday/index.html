<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Final Review: Post-Midterm Content</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../assets/theme.css" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">Final Review: Post-Midterm Content</h1>
</header>
<p><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<!-- add after bootstrap.min.css -->
<link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"/>
<!-- add after bootstrap.min.js or bootstrap.bundle.min.js -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script></p>
<!-- for difficulty gauges-->
<script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-B947E6J6H4"></script> -->
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  // gtag('js', new Date());

  // gtag('config', 'G-B947E6J6H4');
</script>
<p><a href="../index.html">← return to study.practicaldsc.org</a></p>
<hr />
<p>The problems in this worksheet are taken from past exams in similar
classes. Work on them <strong>on paper</strong>, since the exams you
take in this course will also be on paper. <br><br>We encourage you to
attempt these problems <strong>before</strong> Tuesday’s exam review
session, so that we have enough time to walk through the solutions to
all of the problems. <br><br>We will enable the solutions here after the
review session, though you can find the written solutions to these
problems in other discussion worksheets.</p>
<hr />
<h2 id="problem-1">Problem 1</h2>
<p>Consider a dataset of <span class="math inline">n</span> values,
<span class="math inline">y_1, y_2, ..., y_n</span>, all of which are
non-negative. We’re interested in fitting a constant model, <span
class="math inline">H(x) = h</span>, to the data, using the new
“Wolverine” loss function:</p>
<p><span class="math display">L_\text{wolverine}(y_i, h) = w_i \left(
y_i^2 - h^2  \right)^2</span></p>
<p>Here, <span class="math inline">w_i</span> corresponds to the
“weight” assigned to the data point <span
class="math inline">y_i</span>, the idea being that different data
points can be weighted differently when finding the optimal constant
prediction, <span class="math inline">h^*</span>.</p>
<p>For example, for the dataset <span class="math inline">y_1 = 1, y_2 =
5, y_3 = 2</span>, we will end up with different values of <span
class="math inline">h^*</span> when we use the weights <span
class="math inline">w_1 = w_2 = w_3 = 1</span> and when we use weights
<span class="math inline">w_1 = 8, w_2 = 4, w_3 = 3</span>.</p>
<p><br></p>
<h3 id="problem-1.1">Problem 1.1</h3>
<p>Find <span class="math inline">\frac{\partial
L_\text{wolverine}}{\partial h}</span>, the derivative of the Wolverine
loss function with respect to <span class="math inline">h</span>. Show
your work.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_1" aria-expanded="true" aria-controls="collapse1_1">
Click to view the solution.
</button>
</h2>
<div id="collapse1_1" class="accordion-collapse collapse"
aria-labelledby="heading1_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">\frac{\partial L}{\partial h} =
-4w_ih(y_i^2 -h^2)</span></p>
<p>To solve this problem we simply take the derivative of <span class="math inline">L_\text{wolverine}(y_i, h) = w_i( y_i^2 - h^2
)^2</span>.</p>
<p>We can use the chain rule to find the derivative. The chain rule is:
<span class="math inline">\frac{\partial}{\partial
h}[f(g(h))]=f'(g(h))g'(h)</span>.</p>
<p>Note that <span class="math inline">(y_i^2 -h^2)^2</span> is the area
we care about inside of <span class="math inline">L_\text{wolverine}(y_i, h) = w_i( y_i^2 - h^2
)^2</span> because that is where <span class="math inline">h</span> is!.
In this case <span class="math inline">f(h) = h^2</span> and <span class="math inline">g(h) = y_i^2 - h^2</span>. We can then take the
derivative of both to get: <span class="math inline">f'(h) =
2h</span> and <span class="math inline">g'(x) = -2h</span>.</p>
<p>This tells us the derivative is: <span class="math inline">\frac{\partial L}{\partial h} = (w_i) * 2(y_i^2
-h^2) * (-2h)</span>, which can be simplified to <span class="math inline">\frac{\partial L}{\partial h} = -4w_ih(y_i^2
-h^2)</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.2">Problem 1.2</h3>
<p>Prove that the constant prediction that minimizes average loss for
the Wolverine loss function is:</p>
<p><span class="math display">h^* = \sqrt{\frac{\sum_{i = 1}^n w_i
y_i^2}{\sum_{i = 1}^n w_i}}</span></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_2" aria-expanded="true" aria-controls="collapse1_2">
Click to view the solution.
</button>
</h2>
<div id="collapse1_2" class="accordion-collapse collapse"
aria-labelledby="heading1_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>The recipe for average loss is to find the derivative of the risk
function, set it equal to zero, and solve for <span class="math inline">h^*</span>.</p>
<p>We know that average loss follows the equation <span class="math inline">R(L(y_i, h)) = \frac{1}{n} \sum_{i=1}^n L(y_i,
h)</span>. This means that <span class="math inline">R_\text{wolverine}(h) = \frac{1}{n} \sum_{i = 1}^n
w_i (y_i^2 - h^2)^2</span>.</p>
<p>Recall we have already found the derivative of <span class="math inline">L_\text{wolverine}(y_i, h) = w_i ( y_i^2 -
h^2)^2</span>. Which means that <span class="math inline">\frac{\partial
R}{\partial h}(h) = \frac{1}{n} \sum_{i = 1}^n \frac{\partial
L}{\partial h}(h)</span>. So we can set <span class="math inline">\frac{\partial}{\partial h}(h) R_\text{wolverine}(h)
= \frac{1}{n} \sum_{i = 1}^n -4hw_i(y_i^2 -h^2)</span>.</p>
<p>We can now do the last two steps: <span class="math display">\begin{align*}
0 &amp;= \frac{1}{n} \sum_{i = 1}^n -4hw_i(y_i^2 -h^2)\\
0&amp;= \frac{-4h}{n} \sum_{i = 1}^n w_ih(y_i^2 -h^2)\\
0&amp;= \sum_{i = 1}^n w_i(y_i^2 -h^2)\\
0&amp;= \sum_{i = 1}^n w_iy_i^2 -w_ih^2\\
0&amp;= \sum_{i = 1}^n w_iy_i^2 - \sum_{i = 1}^n w_ih^2\\
\sum_{i = 1}^n w_ih^2 &amp;= \sum_{i = 1}^n w_iy_i^2\\
h^2\sum_{i = 1}^n w_i &amp;= \sum_{i = 1}^n w_iy_i^2\\
h^2 &amp;= \frac{\sum_{i = 1}^n w_iy_i^2}{\sum_{i = 1}^n w_i}\\
h^* &amp;= \sqrt{\frac{\sum_{i = 1}^n w_iy_i^2}{\sum_{i = 1}^n w_i}}
\end{align*}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.3">Problem 1.3</h3>
<p>For a dataset of non-negative values <span class="math inline">y_1,
y_2, ..., y_n</span> with weights <span class="math inline">w_1, 1, ...,
1</span>, evaluate: <span class="math display">\displaystyle \lim_{w_1
\rightarrow \infty} h^*</span></p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> The maximum of <span class="math inline">y_1, y_2, ...,
y_n</span></p></li>
<li><p><input type="radio" disabled="" /> The mean of <span class="math inline">y_1, y_2, ...,
y_{n-1}</span></p></li>
<li><p><input type="radio" disabled="" /> The mean of <span class="math inline">y_2, y_3, ..., y_n</span></p></li>
<li><p><input type="radio" disabled="" /> The mean of <span class="math inline">y_2, y_3, ..., y_n</span>,
multiplied by <span class="math inline">\frac{n}{n-1}</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">y_1</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">y_n</span></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_3" aria-expanded="true" aria-controls="collapse1_3">
Click to view the solution.
</button>
</h2>
<div id="collapse1_3" class="accordion-collapse collapse"
aria-labelledby="heading1_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">y_1</span></p>
<p>Recall from part b <span class="math inline">h^* =
\sqrt{\frac{\sum_{i = 1}^n w_i y_i^2}{\sum_{i = 1}^n w_i}}</span>.</p>
<p>The problem is asking us <span class="math inline">\lim_{w_1
\rightarrow \infty} \sqrt{\frac{\sum_{i = 1}^n w_i y_i^2}{\sum_{i = 1}^n
w_i}}</span>.</p>
<p>We can further rewrite the problem to get something like this: <span class="math inline">\lim_{w_1 \rightarrow \infty} \sqrt{\frac{w_1 y_1^2
+ \sum_{i=1}^{n-1}y_i^2}{w_1 + (n-1)}}</span>. Note that <span class="math inline">\frac{\sum_{i=1}^{n-1}y_i^2}{n-1}</span> is
insignificant because it is a constant. Constants compared to infinity
can be ignored. We now have something like <span class="math inline">\sqrt{\frac{w_1y_1^2}{w_1}}</span>. We can cancel
out the <span class="math inline">w_1</span> to get <span class="math inline">\sqrt{y_1^2}</span>, which becomes <span class="math inline">y_1</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-2">Problem 2</h2>
<p>Suppose we want to fit a hypothesis function of the form:</p>
<p><span class="math display">H(x) = w_0 + w_1 x^2</span></p>
<p>Note that this is <em>not</em> the simple linear regression
hypothesis function, <span class="math inline">H(x) = w_0 +
w_1x</span>.</p>
<p>To do so, we will find the optimal parameter vector <span
class="math inline">\vec{w}^* = \begin{bmatrix} w_0^* \\ w_1^*
\end{bmatrix}</span> that satisfies the normal equations. The first 5
rows of our dataset are as follows, though note that our dataset has
<span class="math inline">n</span> rows in total.</p>
<!-- | x  | y |
|----|---|
| 2  | 4 |
| -1 | 4 |
| 3  | 4 |
| -7 | 4 |
| 3  | 4 | -->
<table style="border: 1px solid black; border-collapse: collapse; margin: auto; text-align: center;">
  <tr>
    <th style="border: 1px solid black; padding: 8px;">x</th>
    <th style="border: 1px solid black; padding: 8px;">y</th>
  </tr>
  <tr>
    <td style="border: 1px solid black; padding: 8px;">2</td>
    <td style="border: 1px solid black; padding: 8px;">4</td>
  </tr>
  <tr>
    <td style="border: 1px solid black; padding: 8px;">-1</td>
    <td style="border: 1px solid black; padding: 8px;">4</td>
  </tr>
  <tr>
    <td style="border: 1px solid black; padding: 8px;">3</td>
    <td style="border: 1px solid black; padding: 8px;">4</td>
  </tr>
  <tr>
    <td style="border: 1px solid black; padding: 8px;">-7</td>
    <td style="border: 1px solid black; padding: 8px;">4</td>
  </tr>
  <tr>
    <td style="border: 1px solid black; padding: 8px;">3</td>
    <td style="border: 1px solid black; padding: 8px;">4</td>
  </tr>
</table>
<p>Suppose that <span class="math inline">x_1, x_2, ..., x_n</span> have
a mean of <span class="math inline">\bar{x} = 2</span> and a variance of
<span class="math inline">\sigma_x^2 = 10</span>.</p>
<p><br></p>
<h3 id="problem-2.1">Problem 2.1</h3>
<p>Write out the first 5 rows of the design matrix, <span
class="math inline">X</span>.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_1" aria-expanded="true" aria-controls="collapse2_1">
Click to view the solution.
</button>
</h2>
<div id="collapse2_1" class="accordion-collapse collapse"
aria-labelledby="heading2_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">X = \begin{bmatrix} 1 &amp; 4 \\ 1 &amp; 1
\\ 1 &amp; 9 \\ 1 &amp; 49 \\ 1 &amp; 9 \end{bmatrix}</span></p>
<p>Recall our hypothesis function is <span class="math inline">H(x) =
w_0 + w_1x^2</span>. Since there is a <span class="math inline">w_0</span> present our <span class="math inline">X</span> matrix should contain a column of ones.
This means that our first column will be ones. Our second column should
be <span class="math inline">x^2</span>. This means we take each
datapoint <span class="math inline">x</span> and square it inside of
<span class="math inline">X</span>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 84%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.2">Problem 2.2</h3>
<p>Suppose, just in part (b), that after solving the normal equations,
we find <span class="math inline">\vec{w}^* = \begin{bmatrix} 2 \\ -5
\end{bmatrix}</span>. What is the predicted <span
class="math inline">y</span> value for <span class="math inline">x =
2</span>? Give your answer as an integer with no variables. Show your
work.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_2" aria-expanded="true" aria-controls="collapse2_2">
Click to view the solution.
</button>
</h2>
<div id="collapse2_2" class="accordion-collapse collapse"
aria-labelledby="heading2_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">(2)(1)+(-5)(4)=-18</span></p>
<p>To find the predicted <span class="math inline">y</span> value all
you need to do is plug <span class="math inline">x = 2</span> into the
hypothesis function <span class="math inline">H(x) = w_0 +
w_1x^2</span>, or take the dot product of <span class="math inline">\vec{w}^*</span> with <span class="math inline">\begin{bmatrix}1 \\ 2^2\end{bmatrix}</span>.</p>
<p><span class="math display">\begin{align*}
&amp;\begin{bmatrix} 2 \\ -5 \end{bmatrix} \cdot \begin{bmatrix} 1 \\ 4
\end{bmatrix}\\
&amp;(2)(1)+(-5)(4)\\
&amp;2 - 20\\
&amp;-18
\end{align*}</span></p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 78%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.3">Problem 2.3</h3>
<p>Let <span class="math inline">X_\text{tri} = 3 X</span>. Using the
fact that <span class="math inline">\sum_{i = 1}^n x_i^2 = n \sigma_x^2
+ n \bar{x}^2</span>, determine the value of the bottom-left value in
the matrix <span class="math inline">X_\text{tri}^T X_\text{tri}</span>,
i.e. the value in the second row and first column. Give your answer as
an expression involving <span class="math inline">n</span>. Show your
work.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_3" aria-expanded="true" aria-controls="collapse2_3">
Click to view the solution.
</button>
</h2>
<div id="collapse2_3" class="accordion-collapse collapse"
aria-labelledby="heading2_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">126n</span></p>
<p>To figure out a pattern it can be easier to use variables instead of
numbers. Like so:</p>
<p><span class="math display">
X = \begin{bmatrix} 1 &amp; x_1^2 \\ 1 &amp; x_2^2 \\ \vdots &amp;
\vdots \\ 1 &amp; x_n^2 \end{bmatrix}
</span></p>
<p>We can now create <span class="math inline">X_{\text{tri}}</span>:</p>
<p><span class="math display">
X_{\text{tri}} = \begin{bmatrix} 3 &amp; 3x_1^2 \\ 3 &amp; 3x_2^2 \\
\vdots &amp; \vdots \\ 3 &amp; 3x_n^2 \end{bmatrix}
</span></p>
<p>We want to know what the bottom left value of <span class="math inline">X_\text{tri}^T X_\text{tri}</span> is. We figure
this out with matrix multiplication!</p>
<p><span class="math display">\begin{align*}
X_\text{tri}^T X_\text{tri} &amp;= \begin{bmatrix} 3 &amp; 3 &amp; ...
&amp; 3\\ 3x_1^2 &amp; 3x_2^2 &amp; ... &amp; 3x_n^2 \end{bmatrix}
\begin{bmatrix} 3 &amp; 3x_1^2 \\ 3 &amp; 3x_2^2 \\ \vdots &amp; \vdots
\\ 3 &amp; 3x_n^2 \end{bmatrix}\\
&amp;= \begin{bmatrix} \sum_{i = 1}^n 3(3) &amp; \sum_{i = 1}^n
3(3x_i^2) \\ \sum_{i = 1}^n 3(3x_i^2) &amp; \sum_{i = 1}^n
(3x_i^2)(3x_i^2)\end{bmatrix}\\
&amp;= \begin{bmatrix} \sum_{i = 1}^n 9 &amp; \sum_{i = 1}^n 9x_i^2 \\
\sum_{i = 1}^n 9x_i^2 &amp; \sum_{i = 1}^n (3x_i^2)^2 \end{bmatrix}
\end{align*}</span></p>
<p>We can see that the bottom left element should be <span class="math inline">\sum_{i = 1}^n 9x_i^2</span>.</p>
<p>From here we can use the fact given to us in the directions: <span class="math inline">\sum_{i = 1}^n x_i^2 = n \sigma_x^2 + n
\bar{x}^2</span>.</p>
<p><span class="math display">\begin{align*}
&amp;\sum_{i = 1}^n 9x_i^2\\
&amp;9\sum_{i = 1}^n x_i^2\\
&amp;\text{Notice now we can replace $\sum_{i = 1}^n x_i^2$ with $n
\sigma_x^2 + n \bar{x}^2$.}\\
&amp;9(n \sigma_x^2 + n \bar{x}^2)\\
&amp;\text{We know that $\sigma_x^2 = 10$ and $\bar x = 2$ fron the
directions before part a.}\\
&amp;9(10n + 2^2n)\\
&amp;9(10n + 4n)\\
&amp;9(14n) = 126n
\end{align*}</span></p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 39%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-3">Problem 3</h2>
<p>Suppose we have one qualitative variable that that we convert to
numerical values using one- hot encoding. We’ve shown the first four
rows of the resulting design matrix below:</p>
<center><img src='../assets/images/disc10/matrix.png' width=400></center>
<p><br></p>
<h3 id="problem-3.1">Problem 3.1</h3>
<p>Say we train a linear model <span class="math inline">m_1</span> on
these data. Then, we replace all of the 1 values in column
<strong>a</strong> with 3’s and all of the 1 values in column
<strong>b</strong> with 2’s and train a new linear model <span
class="math inline">m_2</span>. Neither <span
class="math inline">m_1</span> nor <span class="math inline">m_2</span>
have an intercept term. On the training data, the average squared loss
for <span class="math inline">m_1</span> will be ________ that of <span
class="math inline">m_2</span>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> greater than</p></li>
<li><p><input type="radio" disabled="" /> less than</p></li>
<li><p><input type="radio" disabled="" /> equal to</p></li>
<li><p><input type="radio" disabled="" /> impossible to tell</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_1" aria-expanded="true" aria-controls="collapse3_1">
Click to view the solution.
</button>
</h2>
<div id="collapse3_1" class="accordion-collapse collapse"
aria-labelledby="heading3_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<p>The answer is <code>equal to</code>.</p>
<p>Note that we can just re-scale our weights accordingly. Any model we
can get with <span class="math inline">m_1</span> we can also get with
<span class="math inline">m_2</span> (and vice versa).</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.2">Problem 3.2</h3>
<p>To account for the intercept term, we add a column of all ones to our
design matrix from part a. That is, the resulting design matrix has four
columns: <strong>a</strong> with 3’s instead of 1’s, <strong>b</strong>
with 2’s instead of 1’s, <strong>c</strong>, and a column of all ones.
What is the rank of the new design matrix with these four columns?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> 1</p></li>
<li><p><input type="radio" disabled="" /> 2</p></li>
<li><p><input type="radio" disabled="" /> 3</p></li>
<li><p><input type="radio" disabled="" /> 4</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_2" aria-expanded="true" aria-controls="collapse3_2">
Click to view the solution.
</button>
</h2>
<div id="collapse3_2" class="accordion-collapse collapse"
aria-labelledby="heading3_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<p>The answer is <code>3</code>.</p>
<p>Note that the column <strong>c</strong> = intercept column −<span class="math inline">\frac{1}{3}</span><strong>a</strong> + <span class="math inline">\frac{1}{2}</span><strong>b</strong>. Hence, there
is a linear dependence relationship, meaning that one of the columns is
redundant and that the rank of the new design matrix is 3.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.3">Problem 3.3</h3>
<p>Suppose we divide our sampling frame into three clusters of people,
numbered 1, 2, and 3. After we survey people, along with our survey
results, we save their cluster number as a new feature in our design
matrix. Before training a model, what should we do with the cluster
column? (Note: This part is independent of parts a and b.)</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Leave as is</p></li>
<li><p><input type="radio" disabled="" /> One-hot encode it</p></li>
<li><p><input type="radio" disabled="" /> Normalize it</p></li>
<li><p><input type="radio" disabled="" /> Use bag of words</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_3" aria-expanded="true" aria-controls="collapse3_3">
Click to view the solution.
</button>
</h2>
<div id="collapse3_3" class="accordion-collapse collapse"
aria-labelledby="heading3_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<p>The cluster number is a categorical variable, so it should be one-hot
encoded.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-4">Problem 4</h2>
<p>One piece of information that may be useful as a feature is the
proportion of SAT test takers in a state in a given year that qualify
for free lunches in school. The Series <code>lunch_props</code> contains
8 values, each of which are either <code>"low"</code>,
<code>"medium"</code>, or <code>"high"</code>. Since we can’t use
strings as features in a model, we decide to encode these strings using
the following <code>Pipeline</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: The FunctionTransformer is only needed to change the result</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># of the OneHotEncoder from a &quot;sparse&quot; matrix to a regular matrix</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># so that it can be used with StandardScaler;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># it doesn&#39;t change anything mathematically.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>pl <span class="op">=</span> Pipeline([</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;ohe&quot;</span>, OneHotEncoder(drop<span class="op">=</span><span class="st">&quot;first&quot;</span>)),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;ft&quot;</span>, FunctionTransformer(<span class="kw">lambda</span> X: X.toarray())),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;ss&quot;</span>, StandardScaler())</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>])</span></code></pre></div>
<p>After calling <code>pl.fit(lunch_props)</code>,
<code>pl.transform(lunch_props)</code> evaluates to the following
array:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>array([[ <span class="fl">1.29099445</span>, <span class="op">-</span><span class="fl">0.37796447</span>],</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.77459667</span>, <span class="op">-</span><span class="fl">0.37796447</span>],</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.77459667</span>, <span class="op">-</span><span class="fl">0.37796447</span>],</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.77459667</span>,  <span class="fl">2.64575131</span>],</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">1.29099445</span>, <span class="op">-</span><span class="fl">0.37796447</span>],</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">1.29099445</span>, <span class="op">-</span><span class="fl">0.37796447</span>],</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.77459667</span>, <span class="op">-</span><span class="fl">0.37796447</span>],</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.77459667</span>, <span class="op">-</span><span class="fl">0.37796447</span>]])</span></code></pre></div>
<p>and <code>pl.named_steps["ohe"].get_feature_names()</code> evaluates
to the following array:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>array([<span class="st">&quot;x0_low&quot;</span>, <span class="st">&quot;x0_med&quot;</span>], dtype<span class="op">=</span><span class="bu">object</span>)</span></code></pre></div>
<p>Fill in the blanks: Given the above information, we can conclude that
<code>lunch_props</code> has <strong>(a)</strong> value(s) equal to
<code>"low"</code>, <strong>(b)</strong> value(s) equal to
<code>"medium"</code>, and <strong>(c)</strong> value(s) equal to
<code>"high"</code>. <em>(Note: You should write one positive integer in
each box such that the numbers add up to 8.)</em></p>
<p>What goes in the blanks?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4" aria-expanded="true" aria-controls="collapse4">
Click to view the solution.
</button>
</h2>
<div id="collapse4" class="accordion-collapse collapse"
aria-labelledby="heading4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> 3, 1, 4</p>
<p>The first column of the transformed array corresponds to the
standardized one-hot-encoded <code>low</code> column. There are 3 values
that are positive, which means there are 3 values that were originally
<code>1</code> in that column pre-standardization. This means that 3 of
the values in <code>lunch_props</code> were originally
<code>"low"</code>.</p>
<p>The second column of the transformed array corresponds to the
standardized one-hot-encoded <code>med</code> column. There is only 1
value in the transformed column that is positive, which means only 1 of
the values in <code>lunch_props</code> was originally
<code>"medium"</code>.</p>
<p>The Series <code>lunch_props</code> has 8 values, 3 of which were
identified as <code>"low"</code> in subpart 1, and 1 of which was
identified as <code>"medium"</code> in subpart 2. The number of values
being <code>"high"</code> must therefore be <span class="math inline">8
- 3 - 1 = 4</span>.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-5">Problem 5</h2>
<p>Consider the least squares regression model, <span
class="math inline">\vec{h} = X \vec{w}</span>. Assume that <span
class="math inline">X</span> and <span
class="math inline">\vec{h}</span> refer to the design matrix and
hypothesis vector for our training data, and <span
class="math inline">\vec y</span> is the true observation vector.</p>
<p>Let <span class="math inline">\vec{w}_\text{OLS}^*</span> be the
parameter vector that minimizes mean squared error without
regularization. Specifically:</p>
<p><span class="math inline">\vec{w}_\text{OLS}^*</span> = <span
class="math inline">\arg\underset{\vec{w}}{\min} \frac{1}{n} \| \vec{y}
- X \vec{w} \|^2_2</span></p>
<p>Let <span class="math inline">\vec{w}_\text{ridge}^*</span> be the
parameter vector that minimizes mean squared error with <span
class="math inline">L_2</span> regularization, using a non-negative
regularization hyperparameter <span class="math inline">\lambda</span>
(i.e. ridge regression). Specifically:</p>
<p><span class="math inline">\vec{w}_\text{ridge}^*</span> = <span
class="math inline">\arg\underset{\vec{w}}{\min} \frac{1}{n} \| \vec y -
X \vec{w} \|^2_2 + \lambda \sum_{j=1}^{p} w_j^2</span></p>
<p>For each of the following problems, fill in the blank.</p>
<p><br></p>
<h3 id="problem-5.1">Problem 5.1</h3>
<p>If we set <span class="math inline">\lambda</span> = 0, then <span
class="math inline">\Vert \vec{w}_\text{OLS}^* \Vert^2_2</span> is
<strong>____</strong> <span class="math inline">\Vert
\vec{w}_\text{ridge}^* \Vert^2_2</span></p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> less than</p></li>
<li><p><input type="radio" disabled="" /> equal to</p></li>
<li><p><input type="radio" disabled="" /> greater than</p></li>
<li><p><input type="radio" disabled="" /> impossible to tell</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_1" aria-expanded="true" aria-controls="collapse5_1">
Click to view the solution.
</button>
</h2>
<div id="collapse5_1" class="accordion-collapse collapse"
aria-labelledby="heading5_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<p>equal to</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.2">Problem 5.2</h3>
<p>For each of the remaining parts, you can assume that <span
class="math inline">\lambda</span> is set such that the predicted
response vectors for our two models (<span class="math inline">\vec{h} =
X \vec{w}_\text{OLS}^*</span> and <span class="math inline">\vec{h} = X
\vec{w}_\text{ridge}^*</span>) is different.</p>
<p>The <strong>training</strong> MSE of the model <span
class="math inline">\vec{h} = X \vec{w}_\text{OLS}^*</span> is
<strong>____</strong> than the model <span class="math inline">\vec{h} =
X \vec{w}_\text{ridge}^*</span>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> less than</p></li>
<li><p><input type="radio" disabled="" /> equal to</p></li>
<li><p><input type="radio" disabled="" /> greater than</p></li>
<li><p><input type="radio" disabled="" /> impossible to tell</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_2" aria-expanded="true" aria-controls="collapse5_2">
Click to view the solution.
</button>
</h2>
<div id="collapse5_2" class="accordion-collapse collapse"
aria-labelledby="heading5_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<p>less than</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.3">Problem 5.3</h3>
<p>Now, assume we’ve fit both models using our training data, and
evaluate both models on some unseen testing data.</p>
<p>The <strong>test</strong> MSE of the model <span
class="math inline">\vec{h} = X \vec{w}_\text{OLS}^*</span> is
<strong>____</strong> than the model <span class="math inline">\vec{h} =
X \vec{w}_\text{ridge}^*</span>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> less than</p></li>
<li><p><input type="radio" disabled="" /> equal to</p></li>
<li><p><input type="radio" disabled="" /> greater than</p></li>
<li><p><input type="radio" disabled="" /> impossible to tell</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_3" aria-expanded="true" aria-controls="collapse5_3">
Click to view the solution.
</button>
</h2>
<div id="collapse5_3" class="accordion-collapse collapse"
aria-labelledby="heading5_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<p>impossible to tell</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.4">Problem 5.4</h3>
<p>Assume that our design matrix <span class="math inline">X</span>
contains a column of all ones. The sum of the residuals of our model
<span class="math inline">\vec{h} = X \vec{w}_\text{ridge}^*</span>
<strong>____</strong>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> equal to 0</p></li>
<li><p><input type="radio" disabled="" /> not necessarily equal to 0</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_4" aria-expanded="true" aria-controls="collapse5_4">
Click to view the solution.
</button>
</h2>
<div id="collapse5_4" class="accordion-collapse collapse"
aria-labelledby="heading5_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<p>not necessarily equal to 0</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.5">Problem 5.5</h3>
<p>As we increase <span class="math inline">\lambda</span>, the bias of
the model <span class="math inline">\vec{h} = X
\vec{w}_\text{ridge}^*</span> tends to <strong>____</strong>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> increase</p></li>
<li><p><input type="radio" disabled="" /> stay the same</p></li>
<li><p><input type="radio" disabled="" /> decrease</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_5">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_5" aria-expanded="true" aria-controls="collapse5_5">
Click to view the solution.
</button>
</h2>
<div id="collapse5_5" class="accordion-collapse collapse"
aria-labelledby="heading5_5" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<p>increase</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.6">Problem 5.6</h3>
<p>As we increase <span class="math inline">\lambda</span>, the model
variance of the model <span class="math inline">\vec{h} = X
\vec{w}_\text{ridge}^*</span> tends to <strong>____</strong>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> increase</p></li>
<li><p><input type="radio" disabled="" /> stay the same</p></li>
<li><p><input type="radio" disabled="" /> decrease</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_6">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_6" aria-expanded="true" aria-controls="collapse5_6">
Click to view the solution.
</button>
</h2>
<div id="collapse5_6" class="accordion-collapse collapse"
aria-labelledby="heading5_6" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<p>decrease</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.7">Problem 5.7</h3>
<p>As we increase <span class="math inline">\lambda</span>, the
observation variance of the model <span class="math inline">\vec{h} = X
\vec{w}_\text{ridge}^*</span> tends to <strong>____</strong>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> increase</p></li>
<li><p><input type="radio" disabled="" /> stay the same</p></li>
<li><p><input type="radio" disabled="" /> decrease</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_7">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_7" aria-expanded="true" aria-controls="collapse5_7">
Click to view the solution.
</button>
</h2>
<div id="collapse5_7" class="accordion-collapse collapse"
aria-labelledby="heading5_7" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<p>stay the same</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-6">Problem 6</h2>
<p>Neerad wants to build a model that predicts the number of open rooms
a hotel has, given various other features. He has a training set with
1200 rows available to him for the purposes of training his model.</p>
<p><br></p>
<h3 id="problem-6.1">Problem 6.1</h3>
<p>Neerad fits a regression model using the <code>GPTRegression</code>
class. <code>GPTRegression</code> models have several hyperparameters
that can be tuned, including <code>context_length</code> and
<code>sentience</code>.</p>
<p>To choose between 5 possible values of the hyperparameter
<code>context_length</code>, Neerad performs <span
class="math inline">k</span>-fold cross-validation.</p>
<ol type="1">
<li>How many total times is a <code>GPTRegression</code> model fit?</li>
</ol>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">4k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">5k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">240k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">6000k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">4(k − 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">5(k − 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">240(k − 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">6000(k − 1)</span></p></li>
</ul>
<ol start="2" type="1">
<li>Suppose that every time a <code>GPTRegression</code> model is fit,
it appends the number of points in its training set to the list
<code>sizes</code>. Note that after performing cross- validation,
<code>len(sizes)</code> is equal to your answer to the previous
subpart.</li>
</ol>
<p>What is <code>sum(sizes)</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">4k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">5k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">240k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">6000k</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">4(k − 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">5(k − 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">240(k − 1)</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">6000(k − 1)</span></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_1" aria-expanded="true" aria-controls="collapse6_1">
Click to view the solution.
</button>
</h2>
<div id="collapse6_1" class="accordion-collapse collapse"
aria-labelledby="heading6_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<ol type="1">
<li><span class="math inline">5k</span></li>
<li><span class="math inline">6000(k-1)</span></li>
</ol>
<p>When we do <span class="math inline">k</span>-fold cross-validation
for one single hyperparameter value, we split the dataset into <span class="math inline">k</span> folds, and in each iteration <span class="math inline">i</span>, train the model on the remaining <span class="math inline">k-1</span> folds and evaluate on fold <span class="math inline">i</span>. Since every fold is left out and evaluated
on once, the model is fit in total <span class="math inline">k</span>
times. We do this once for every hyperparameter value we want to test,
so the total number of model fits required is <span class="math inline">5k</span>.</p>
<p>In part 2, we can note that each model fit is performed on the same
size of data – the size of the remaining <span class="math inline">k-1</span> folds when we hold out a single fold.
This size is <span class="math inline">1 - \frac{1}{k} =
\frac{k-1}{k}</span> times the size of the entire dataset, in this case,
<span class="math inline">1200 \cdot \frac{k-1}{k}</span>, and we fit a
model on a dataset of this size <span class="math inline">5k</span>
times. So, the sum of the training sizes for each model fit is:</p>
<p><span class="math display">5k \cdot \frac{k-1}{k} \cdot 1200 =
6000(k-1)</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-6.2">Problem 6.2</h3>
<p>The average training error and validation error for all 5 candidate
values of <code>context_length</code> are given below.</p>
<center><img src="../../assets/images/disc10/validation.png" width=600></center>
<p>Fill in the blanks: As <code>context_length</code> increases, model
complexity <code>__(i)__</code>. The optimal choice of
<code>context_length</code> is <code>__(ii)__</code>; if we choose a
<code>context_length</code> any higher than that, our model will
<code>__(iii)__</code>.</p>
<ol type="1">
<li>What goes in blank (i)?</li>
</ol>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> increases</p></li>
<li><p><input type="radio" disabled="" /> decreases</p></li>
</ul>
<ol start="2" type="1">
<li>What goes in blank (ii)?</li>
</ol>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> 0.1</p></li>
<li><p><input type="radio" disabled="" /> 1</p></li>
<li><p><input type="radio" disabled="" /> 10</p></li>
<li><p><input type="radio" disabled="" /> 100</p></li>
<li><p><input type="radio" disabled="" /> 1000</p></li>
</ul>
<ol start="3" type="1">
<li>What goes in blank (iii)?</li>
</ol>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> overfit the training data and have high bias</p></li>
<li><p><input type="radio" disabled="" /> underfit the training data and have high bias</p></li>
<li><p><input type="radio" disabled="" /> overfit the training data and have low bias</p></li>
<li><p><input type="radio" disabled="" /> underfit the training data and have low bias</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_2" aria-expanded="true" aria-controls="collapse6_2">
Click to view the solution.
</button>
</h2>
<div id="collapse6_2" class="accordion-collapse collapse"
aria-labelledby="heading6_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<ol type="1">
<li>decreases</li>
<li>100</li>
<li>underfit the training data and have high bias</li>
</ol>
<p>In part 1, we can see that as <code>context_length</code> increases,
the training error increases, and the model performs worse. In general,
higher model complexity leads to better model performance, so here,
increasing <code>context_length</code> is <em>reducing</em> model
complexity.</p>
<p>In part 2, we will choose a <code>context_length</code> of 100, since
this parameterization leads to the best validation performance. If we
increase <code>context_length</code> further, the validation error
increases.</p>
<p>In part 3, since increased <code>context_length</code> indicates
<em>less</em> complexity and worse training performance, increasing the
<code>context_length</code> further would lead to underfitting, as the
model would lack the expressiveness or number of parameters required to
capture the data. Since training error represents model bias, and since
high variance is associated with <em>over</em>fitting, a further
increase in <code>context_length</code> would mean a more biased
model.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-7">Problem 7</h2>
<p>Suppose we want to use logistic regression to classify whether a
person survived the sinking of the Titanic. The first 5 rows of our
dataset are given below.</p>
<p><span class="math display">\begin{array}{|c|c|c|c|}
\hline
&amp; \textbf{Age} &amp; \textbf{Survived} &amp; \textbf{Female} \\
\hline
0 &amp; 22.0 &amp; 0 &amp; 0 \\ \hline
1 &amp; 38.0 &amp; 1 &amp; 1 \\ \hline
2 &amp; 26.0 &amp; 1 &amp; 1 \\ \hline
3 &amp; 35.0 &amp; 1 &amp; 1 \\ \hline
4 &amp; 35.0 &amp; 0 &amp; 0 \\ \hline
\end{array}</span></p>
<p>Suppose after training our logistic regression model we get <span
class="math inline">\vec{w}^* = \begin{bmatrix}
-1.2 \\ -0.005 \\ 2.5
\end{bmatrix}</span>, where <span class="math inline">-1.2</span> is an
intercept term, <span class="math inline">-0.005</span> is the optimal
parameter corresponding to passenger’s age, and <span
class="math inline">2.5</span> is the optimal parameter corresponding to
sex (1 if female, 0 otherwise).</p>
<p><br></p>
<h3 id="problem-7.1">Problem 7.1</h3>
<p>Consider Sı̄lānah Iskandar Nāsı̄f Abı̄ Dāghir Yazbak, a 20 year old
female. What chance did she have to survive the sinking of the Titanic
according to our model? Give your answer as a probability in terms of
<span class="math inline">\sigma</span>. If there is not enough
information, write “not enough information.”</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7_1" aria-expanded="true" aria-controls="collapse7_1">
Click to view the solution.
</button>
</h2>
<div id="collapse7_1" class="accordion-collapse collapse"
aria-labelledby="heading7_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <span class="math inline">P(y = 1 |
\text{age} = 20, \text{female} = 1) = \sigma(1.2)</span></p>
<p>Our augmented feature vector is of the form <span class="math inline">\text{Aug}(\vec{x}) = \begin{bmatrix} 1 \\ 20 \\ 1
\end{bmatrix}</span>. Then <span class="math inline">\vec{w}^* \cdot
\text{Aug}(\vec x) = 1(-1.2) + 20(-0.005) + 1(2.5) = 1.2</span>, so:</p>
<p><span class="math display">P(y = 1 | \vec{x}) = \sigma \left(
\vec{w}^* \cdot \text{Aug}(\vec x) \right) = \boxed{\sigma
(1.2)}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-7.2">Problem 7.2</h3>
<p>Sı̄lānah Iskandar Nāsı̄f Abı̄ Dāghir Yazbak actually survived. What is
the cross-entropy loss for our prediction in the previous part?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7_2" aria-expanded="true" aria-controls="collapse7_2">
Click to view the solution.
</button>
</h2>
<div id="collapse7_2" class="accordion-collapse collapse"
aria-labelledby="heading7_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <span class="math inline">-\log (\sigma
(1.2))</span></p>
<p>Here <span class="math inline">y_i=1</span> and <span class="math inline">p_i = \sigma (1.2)</span>. The formula for cross
entropy loss is:</p>
<p><span class="math display">L_\text{ce}(y_i, p_i) = -y_i\log (p_i) -
(1 - y_i)\log (1 - p_i) = \boxed{-\log (\sigma (1.2))}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-7.3">Problem 7.3</h3>
<p>At what age would we predict that a female passenger is more likely
to have survived the Titanic than not? In other words, at what age is
the probability of survival for a female passenger greater than 0.5?</p>
<p><em>Hint: Since <span class="math inline">\sigma(0) = 0.5</span>, we
have that <span class="math inline">\sigma \left( \vec{w}^* \cdot
\text{Aug}(\vec x) \right) = 0.5 \implies \vec{w}^* \cdot
\text{Aug}(\vec x) = 0</span>.</em></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7_3" aria-expanded="true" aria-controls="collapse7_3">
Click to view the solution.
</button>
</h2>
<div id="collapse7_3" class="accordion-collapse collapse"
aria-labelledby="heading7_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: 260 years old</p>
<p>The probability that a female passenger of age <span class="math inline">a</span> survives the Titanic is:</p>
<p><span class="math display">P(y = 1 | \text{age} = a, \text{female} =
1) = \sigma(-1.2 - 0.005 a + 2.5) = \sigma(1.3 - 0.005a)</span></p>
<p>In order for <span class="math inline">\sigma(1.3 - 0.005a) =
0.5</span>, we need <span class="math inline">1.3 - 0.005a = 0</span>.
This means that:</p>
<p><span class="math display">0.005a = 1.3 \implies a =
\frac{1.3}{0.005} = 1.3 \cdot 200 = 260</span></p>
<p>So, a female passenger must be at least 260 years old in order for us
to predict that they are more likely to survive the Titanic than not.
Note that <span class="math inline">\text{age} = 260</span> can be
interpreted as a <strong>decision boundary</strong>; since we’ve fixed a
value for the <span class="math inline">\text{female}</span> feature,
there’s only one remaining feature, which is <span class="math inline">\text{age}</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-7.4">Problem 7.4</h3>
<p>Let <span class="math inline">m</span> be the <strong>odds</strong>
of a given non-female passenger’s survival according to our logistic
regression model, i.e., if the passenger had an 80% chance of survival,
<span class="math inline">m</span> would be 4, since their odds of
survival are <span class="math inline">\frac{0.8}{0.2} = 4</span>.</p>
<p>It turns out we can compute <span class="math inline">f</span>, the
odds of survival for a female passenger of the same age, in terms of
<span class="math inline">m</span>. Give an expression for <span
class="math inline">f</span> in terms of <span
class="math inline">m</span>.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7_4" aria-expanded="true" aria-controls="collapse7_4">
Click to view the solution.
</button>
</h2>
<div id="collapse7_4" class="accordion-collapse collapse"
aria-labelledby="heading7_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>Let <span class="math inline">p_m</span> be the probability that the
non-female passenger survives, and let <span class="math inline">p_f</span> be the probability that the female
passenger of the same age survives. Then, we have that:</p>
<p><span class="math display">p_m = \sigma(-1.2 - 0.005 \cdot \text{age}
+ 2.5 \cdot 0)</span></p>
<p><span class="math display">p_f = \sigma(-1.2 - 0.005 \cdot \text{age}
+ 2.5 \cdot 1)</span></p>
<p>Now, recall from <a href="https://practicaldsc.org/resources/lectures/lec24/lec24-filled.html#Aside:-Odds">Lecture
24</a> that:</p>
<ul>
<li>If <span class="math inline">p_i</span> is the probability of an
event, then the odds of the event are <span class="math inline">\frac{p_i}{1 - p_i}</span>.</li>
<li>If <span class="math inline">p_i = \sigma(t)</span>, then <span class="math inline">t = \sigma^{-1}(p_i) = \log \left( \frac{p_i}{1 -
p_i} \right)</span>. In other words, <strong>the inverse of <span class="math inline">p_i = \sigma(t)</span> is the log odds of <span class="math inline">p_i</span>, i.e. $^{-1}(p_i) = ( (p_i)
)</strong>.</li>
</ul>
<p>What does this all have to do with the question? Well, we can take
the two equations at the start of the solution and apply <span class="math inline">\sigma^{-1}</span> to both sides, yielding:</p>
<p><span class="math display">\sigma^{-1}(p_m) = -1.2 - 0.005 \cdot
\text{age} + 2.5 \cdot 0</span></p>
<p><span class="math display">\sigma^{-1}(p_f) = -1.2 - 0.005 \cdot
\text{age} + 2.5 \cdot 1</span></p>
<p>But, <span class="math inline">\sigma^{-1}(p_m) = \log \left(
\text{odds}(p_m) \right) = \log(m)</span> (using the definition in the
problem) and <span class="math inline">\sigma^{-1}(p_f) = \log \left(
\text{odds}(p_f) \right) = \log(f)</span>, so we have that:</p>
<p><span class="math display">\log(m) = -1.2 - 0.005 \cdot \text{age} +
2.5 \cdot 0</span></p>
<p><span class="math display">\log(f) = -1.2 - 0.005 \cdot \text{age} +
2.5 \cdot 1</span></p>
<p>Finally, if we raise both sides to the exponent <span class="math inline">e</span>, we’ll be able to directly write <span class="math inline">f</span> in terms of <span class="math inline">m</span>! Remember that <span class="math inline">e^{\log(m)} = m</span> and <span class="math inline">e^{\log(f)} = f</span>, assuming that we’re using
the natural logarithm. Then:</p>
<p><span class="math display">m = e^{-1.2 - 0.005 \cdot \text{age} + 2.5
\cdot 0}</span></p>
<p><span class="math display">f = e^{-1.2 - 0.005 \cdot \text{age} + 2.5
\cdot 1}</span></p>
<p>So, <span class="math inline">f</span> in terms of <span class="math inline">m</span> is:</p>
<p><span class="math display">\frac{f}{m} = \frac{e^{-1.2 - 0.005 \cdot
\text{age} + 2.5 \cdot 1}}{e^{-1.2 - 0.005 \cdot \text{age} + 2.5 \cdot
0}} = e^{2.5}</span></p>
<p>Or, in other words:</p>
<p><span class="math display">\boxed{f = e^{2.5}m}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-8">Problem 8</h2>
<p>We decide to build a classifier that takes in a state’s demographic
information and predicts whether, in a given year:</p>
<ul>
<li><p>The state’s mean math score was greater than its mean verbal
score (1), or</p></li>
<li><p>the state’s mean math score was less than or equal to its mean
verbal score (0).</p></li>
</ul>
<p><br></p>
<h3 id="problem-8.1">Problem 8.1</h3>
<p>The simplest possible classifier we could build is one that predicts
the same label (1 or 0) every time, independent of all other
features.</p>
<p>Consider the following statement:</p>
<p><em>If <code>a &gt; b</code>, then the constant classifier that
maximizes training accuracy predicts 1 every time; otherwise, it
predicts 0 every time.</em></p>
<p>For which combination of <code>a</code> and <code>b</code> is the
above statement <strong>not guaranteed</strong> to be true?</p>
<p><em>Note: Treat <code>sat</code> as our training set.</em></p>
<p>Option 1:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> (sat[<span class="st">&#39;Math&#39;</span>] <span class="op">&gt;</span> sat[<span class="st">&#39;Verbal&#39;</span>]).mean()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fl">0.5</span></span></code></pre></div>
<p>Option 2:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> (sat[<span class="st">&#39;Math&#39;</span>] <span class="op">-</span> sat[<span class="st">&#39;Verbal&#39;</span>]).mean()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">0</span></span></code></pre></div>
<p>Option 3:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> (sat[<span class="st">&#39;Math&#39;</span>] <span class="op">-</span> sat[<span class="st">&#39;Verbal&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>).mean()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fl">0.5</span></span></code></pre></div>
<p>Option 4:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> ((sat[<span class="st">&#39;Math&#39;</span>] <span class="op">/</span> sat[<span class="st">&#39;Verbal&#39;</span>]) <span class="op">&gt;</span> <span class="dv">1</span>).mean() <span class="op">-</span> <span class="fl">0.5</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">0</span></span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Option 1</p></li>
<li><p><input type="radio" disabled="" /> Option 2</p></li>
<li><p><input type="radio" disabled="" /> Option 3</p></li>
<li><p><input type="radio" disabled="" /> Option 4</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading8_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse8_1" aria-expanded="true" aria-controls="collapse8_1">
Click to view the solution.
</button>
</h2>
<div id="collapse8_1" class="accordion-collapse collapse"
aria-labelledby="heading8_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> Option 2</p>
<p>Conceptually, we’re looking for a combination of <code>a</code> and
<code>b</code> such that when <code>a &gt; b</code>, it’s true that
<strong>in more than 50% of states, the <code>"Math"</code> value is
larger than the <code>"Verbal"</code> value</strong>. Let’s look at all
four options through this lens:</p>
<ul>
<li>Option 1: <code>sat['Math'] &gt; sat['Verbal']</code> is a Series of
Boolean values, containing <code>True</code> for all states where the
<code>"Math"</code> value is larger than the <code>"Verbal"</code> value
and <code>False</code> for all other states. The mean of this series,
then, is the proportion of states satisfying this criteria, and since
<code>b</code> is <code>0.5</code>, <code>a &gt; b</code> is
<code>True</code> only when the bolded condition above is
<code>True</code>.</li>
<li>Option 3 is the same as Option 1 – note that <span class="math inline">x &gt; y</span> is equivalent to <span class="math inline">x - y &gt; 0</span>.</li>
<li>Option 4: <code>sat['Math'] / sat['Verbal']</code> is a Series that
contains values greater than 1 whenever a state’s <code>"Math"</code>
value is larger than its <code>"Verbal"</code> value and less than or
equal to 1 in all other cases. As in the other options that work,
<code>(sat['Math'] / sat['Verbal']) &gt; 1</code> is a Boolean Series
with <code>True</code> for all states with a larger <code>"Math"</code>
value than <code>"Verbal"</code> values; <code>a &gt; b</code> compares
the proportion of <code>True</code> values in this Series to 0.5. (Here,
<span class="math inline">p - 0.5 &gt; 0</span> is the same as <span class="math inline">p &gt; 0.5</span>.)</li>
</ul>
<p>Then, by process of elimination, Option 2 must be the correct option
– that is, it must be the only option that <strong>doesn’t</strong>
work. But why? <code>sat['Math'] - sat['Verbal']</code> is a Series
containing the difference between each state’s <code>"Math"</code> and
<code>"Verbal"</code> values, and <code>.mean()</code> computes the mean
of these differences. The issue is that here, we don’t care about
<em>how different</em> each state’s <code>"Math"</code> and
<code>"Verbal"</code> values are; rather, we just care about the
proportion of states with a bigger <code>"Math"</code> value than
<code>"Verbal"</code> value. It could be the case that 90% of states
have a larger <code>"Math"</code> value than <code>"Verbal"</code>
value, but one state has such a big <code>"Verbal"</code> value that it
makes the mean difference between <code>"Math"</code> and
<code>"Verbal"</code> scores negative. (A property you’ll learn about in
future probability courses is that this is equal to the difference in
the mean <code>"Math"</code> value for all states and the mean
<code>"Verbal"</code> value for all states – this is called the
“linearity of expectation” – but you don’t need to know that to answer
this question.)</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-8.2">Problem 8.2</h3>
<p>Suppose we train a classifier, named Classifier 1, and it achieves an
accuracy of <span class="math inline">\frac{5}{9}</span> on our training
set.</p>
<p>Typically, root mean squared error (RMSE) is used as a performance
metric for regression models, but mathematically, nothing is stopping us
from using it as a performance metric for classification models as
well.</p>
<p>What is the RMSE of Classifier 1 on our training set? Give your
answer as a <strong>simplified fraction</strong>.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading8_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse8_2" aria-expanded="true" aria-controls="collapse8_2">
Click to view the solution.
</button>
</h2>
<div id="collapse8_2" class="accordion-collapse collapse"
aria-labelledby="heading8_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <span class="math inline">\frac{2}{3}</span></p>
<p>An accuracy of <span class="math inline">\frac{5}{9}</span> means
that the model is such that out of 9 values, 5 are labeled correctly. By
extension, this means that 4 out of 9 are not labeled correctly as 0 or
1.</p>
<p>Remember, RMSE is defined as</p>
<p><span class="math display">\text{RMSE} = \sqrt{\frac{1}{n} \sum_{i =
1}^n (y_i - H(x_i))^2}</span></p>
<p>where <span class="math inline">y_i</span> represents the <span class="math inline">i</span>th actual value and <span class="math inline">H(x_i)</span> represents the <span class="math inline">i</span>th prediction. Here, <span class="math inline">y_i</span> is either 0 or 1 and $H(x_i) is also
either 0 or 1. We’re told that <span class="math inline">\frac{5}{9}</span> of the time, <span class="math inline">y_i</span> and <span class="math inline">H(x_i)</span> are the same; in those cases, <span class="math inline">(y_i - H(x_i))^2 = 0^2 = 0</span>. We’re also told
that <span class="math inline">\frac{4}{9}</span> of the time, <span class="math inline">y_i</span> and <span class="math inline">H(x_i)</span> are different; in those cases, <span class="math inline">(y_i - H(x_i))^2 = 1</span>. So,</p>
<p><span class="math display">\text{RMSE} = \sqrt{\frac{5}{9} \cdot 0 +
\frac{4}{9} \cdot 1} = \sqrt{\frac{4}{9}} = \frac{2}{3}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-8.3">Problem 8.3</h3>
<p>While Classifier 1’s accuracy on our training set is <span
class="math inline">\frac{5}{9}</span>, its accuracy on our test set is
<span class="math inline">\frac{1}{4}</span>. Which of the following
scenarios is most likely?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Classifier 1 overfit to our training set; we need to increase its
complexity.</p></li>
<li><p><input type="radio" disabled="" /> Classifier 1 overfit to our training set; we need to decrease its
complexity.</p></li>
<li><p><input type="radio" disabled="" /> Classifier 1 underfit to our training set; we need to increase its
complexity.</p></li>
<li><p><input type="radio" disabled="" /> Classifier 1 underfit to our training set; we need to decrease its
complexity.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading8_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse8_3" aria-expanded="true" aria-controls="collapse8_3">
Click to view the solution.
</button>
</h2>
<div id="collapse8_3" class="accordion-collapse collapse"
aria-labelledby="heading8_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> Option 2</p>
<p>Since the accuracy of Classifier 1 is much higher on the dataset used
to train it than the dataset it was tested on, it’s likely Classifer 1
overfit to the training set because it was too complex. To fix the
issue, we need to decrease its complexity, so that it focuses on
learning the general structure of the data in the training set and not
too much on the random noise in the training set.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p>For the remainder of this question, suppose we train another
classifier, named Classifier 2, again on our training set. Its
performance on the training set is described in the confusion matrix
below. Note that the columns of the confusion matrix have been
separately normalized so that each has a sum of 1.</p>
<center><img src='../assets/images/old-from-80/wi23-final/conf-matrix.png' width=30%></center>
<p><br></p>
<h3 id="problem-8.4">Problem 8.4</h3>
<p>Suppose <code>conf</code> is the DataFrame above. Which of the
following evaluates to a Series of length 2 whose only unique value is
the number <code>1</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>conf.sum(axis=0)</code></p></li>
<li><p><input type="radio" disabled="" /> <code>conf.sum(axis=1)</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading8_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse8_4" aria-expanded="true" aria-controls="collapse8_4">
Click to view the solution.
</button>
</h2>
<div id="collapse8_4" class="accordion-collapse collapse"
aria-labelledby="heading8_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> Option 1</p>
<p>Note that the columns of <code>conf</code> sum to 1 – <span class="math inline">0.9 + 0.1 = 1</span>, and <span class="math inline">0.4 + 0.6 = 1</span>. To create a Series with just
the value 1, then, we need to sum the columns of <code>conf</code>,
which we can do using <code>conf.sum(axis=0)</code>.
<code>conf.sum(axis=1)</code> would sum the rows of
<code>conf</code>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-8.5">Problem 8.5</h3>
<p>Fill in the blank: the ___ of Classifier 2 is guaranteed to be
0.6.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> precision</p></li>
<li><p><input type="radio" disabled="" /> recall</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading8_5">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse8_5" aria-expanded="true" aria-controls="collapse8_5">
Click to view the solution.
</button>
</h2>
<div id="collapse8_5" class="accordion-collapse collapse"
aria-labelledby="heading8_5" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> recall</p>
<p>The number 0.6 appears in the bottom-right corner of
<code>conf</code>. Since <code>conf</code> is column-normalized, the
value 0.6 represents the proportion of values in the second column that
were predicted to be 1. The second column contains values that were
actually 1, so 0.6 is really <strong>the proportion of values that were
actually 1 that were predicted to be 1</strong>, that is, <span class="math inline">\frac{\text{actually 1 and predicted
1}}{\text{actually 1}}</span>. This is the definition of recall!</p>
<p>If you’d like to think in terms of true positives, etc., then
remember that: - True Positives (TP) are values that were actually 1 and
were predicted to be 1. - True Negatives (TN) are values that were
actually 0 and were predicted to be 0. - False Positives (FP) are values
that were actually 0 and were predicted to be 1. - False Negatives (FN)
are values that were actually 1 and were predicted to be 0.</p>
<p>Recall is <span class="math inline">\frac{\text{TP}}{\text{TP} +
\text{FN}}</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p>For your convenience, we show the column-normalized confusion matrix
from the previous page below. You will need to use the specific numbers
in this matrix when answering the following subpart.</p>
<center><img src='../assets/images/old-from-80/wi23-final/conf-matrix.png' width=30%></center>
<p><br></p>
<h3 id="problem-8.6">Problem 8.6</h3>
<p>Suppose a fraction <span class="math inline">\alpha</span> of the
labels in the training set are actually 1 and the remaining <span
class="math inline">1 - \alpha</span> are actually 0. The accuracy of
Classifier 2 is 0.65. What is the value of <span
class="math inline">\alpha</span>? </p>
<p>Hint: If you’re unsure on how to proceed, here are some guiding
questions:</p>
<ul>
<li><p>Suppose the number of <span class="math inline">y</span>-values
that are actually 1 is <span class="math inline">A</span> and that the
number of <span class="math inline">y</span>-values that are actually 0
is <span class="math inline">B</span>. In terms of <span
class="math inline">A</span> and <span class="math inline">B</span>,
what is the accuracy of Classifier 2? Remember, you’ll need to refer to
the numbers in the confusion matrix above.</p></li>
<li><p>What is the relationship between <span
class="math inline">A</span>, <span class="math inline">B</span>, and
<span class="math inline">\alpha</span>? How does it simplify your
calculation for the accuracy in the previous step?</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading8_6">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse8_6" aria-expanded="true" aria-controls="collapse8_6">
Click to view the solution.
</button>
</h2>
<div id="collapse8_6" class="accordion-collapse collapse"
aria-labelledby="heading8_6" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <span class="math inline">\frac{5}{6}</span></p>
<p>Here is one way to solve this problem:</p>
<p>accuracy = <span class="math inline">\frac{TP + TN}{TP + TN + FP +
FN}</span></p>
<p>Given the values from the confusion matrix:</p>
<p>accuracy = <span class="math inline">\frac{0.6 \cdot \alpha + 0.9
\cdot (1 - \alpha)}{\alpha + (1 - \alpha)}</span><br/>
accuracy = <span class="math inline">\frac{0.6 \cdot \alpha + 0.9 - 0.9
\cdot \alpha}{1}</span><br/>
accuracy = <span class="math inline">0.9 - 0.3 \cdot \alpha</span></p>
<p>Therefore:</p>
<p>0.65 = <span class="math inline">0.9 - 0.3 \cdot \alpha</span><br/>
<span class="math inline">0.3 \cdot \alpha</span> = <span class="math inline">0.9 - 0.65</span><br/>
<span class="math inline">0.3 \cdot \alpha</span> = <span class="math inline">0.25</span><br/>
<span class="math inline">\alpha</span> = <span class="math inline">\frac{0.25}{0.3}</span><br/>
<span class="math inline">\alpha</span> = <span class="math inline">\frac{5}{6}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-9">Problem 9</h2>
<p>Let <span class="math inline">\vec{x} = \begin{bmatrix} x_1 \\ x_2
\end{bmatrix}</span>. Consider the function <span
class="math inline">g(\vec{x}) = (x_1 - 3)^2 + (x_1^2 -
x_2)^2</span>.</p>
<p><br></p>
<h3 id="problem-9.1">Problem 9.1</h3>
<p>Find <span class="math inline">\nabla g(\vec{x})</span>, the gradient
of <span class="math inline">g(\vec{x})</span>, and use it to show that
<span class="math inline">\nabla g\left( \begin{bmatrix} -1 \\ 1
\end{bmatrix} \right) = \begin{bmatrix} -8 \\ 0
\end{bmatrix}</span>.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading9_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse9_1" aria-expanded="true" aria-controls="collapse9_1">
Click to view the solution.
</button>
</h2>
<div id="collapse9_1" class="accordion-collapse collapse"
aria-labelledby="heading9_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">\nabla g(\vec{x}) = \begin{bmatrix} 2x_1
-6 + 4x_1(x_1^2 - x_2) \\ -2(x_1^2 - x_2) \end{bmatrix}</span></p>
<p>We can find <span class="math inline">\nabla g(\vec{x})</span> by
finding the partial derivatives of <span class="math inline">g(\vec{x})</span>:</p>
<p><span class="math display">\frac{\partial g}{\partial x_1} = 2(x_1 -
3) + 2(x_1^2 - x_2)(2 x_1)</span> <span class="math display">\frac{\partial g}{\partial x_2} = 2(x_1^2 -
x_2)(-1)</span> <span class="math display">\nabla g(\vec{x}) =
\begin{bmatrix} 2(x_1 - 3) + 2(x_1^2 - x_2)(2 x_1) \\ 2(x_1^2 - x_2)(-1)
\end{bmatrix}</span> <span class="math display">\nabla
g\left(\begin{bmatrix} - 1 \\ 1 \end{bmatrix}\right) = \begin{bmatrix}
2(-1 - 4) + 2((-1)^2 - 1)(2(-1)) \\ 2((-1)^2 - 1) \end{bmatrix} =
\begin{bmatrix} -8 \\ 0 \end{bmatrix}</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-9.2">Problem 9.2</h3>
<p>We’d like to find the vector <span
class="math inline">\vec{x}^*</span> that minimizes <span
class="math inline">g(\vec{x})</span> using gradient descent. Perform
one iteration of gradient descent by hand, using the initial guess <span
class="math inline">\vec{x}^{(0)} = \begin{bmatrix} -1 \\ 1
\end{bmatrix}</span> and the learning rate <span
class="math inline">\alpha = \frac{1}{2}</span>. In other words, what is
<span class="math inline">\vec{x}^{(1)}</span>?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading9_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse9_2" aria-expanded="true" aria-controls="collapse9_2">
Click to view the solution.
</button>
</h2>
<div id="collapse9_2" class="accordion-collapse collapse"
aria-labelledby="heading9_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">\vec x^{(1)} = \begin{bmatrix} 3 \\ 1
\end{bmatrix}</span></p>
<p>Here’s the general form of gradient descent: <span class="math display">\vec x^{(1)} = \vec{x}^{(0)} - \alpha \nabla
g(\vec{x}^{(0)})</span></p>
<p>We can substitute <span class="math inline">\alpha =
\frac{1}{2}</span> and <span class="math inline">x^{(0)} =
\begin{bmatrix} -1 \\ 1 \end{bmatrix}</span> to get: <span class="math display">\vec x^{(1)} = \begin{bmatrix} -1 \\ 1
\end{bmatrix} - \frac{1}{2} \nabla g(\vec x ^{(0)})</span> <span class="math display">\vec x^{(1)} = \begin{bmatrix} -1 \\ 1
\end{bmatrix} - \frac{1}{2} \begin{bmatrix} -8 \\ 0
\end{bmatrix}</span></p>
<p><span class="math display">\vec{x}^{(1)} = \begin{bmatrix} -1 \\ 1
\end{bmatrix} - \frac{1}{2} \begin{bmatrix} -8 \\ 0 \end{bmatrix} =
\begin{bmatrix} 3 \\ 1 \end{bmatrix}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-9.3">Problem 9.3</h3>
<p>Consider the function <span class="math inline">f(t) = (t - 3)^2 +
(t^2 - 1)^2</span>. Select the true statement below.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">f(t)</span> is convex and has a global
minimum.</p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">f(t)</span> is not convex, but has a global
minimum.</p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">f(t)</span> is convex, but doesn’t have a
global minimum.</p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">f(t)</span> is not convex and doesn’t have
a global minimum.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading9_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse9_3" aria-expanded="true" aria-controls="collapse9_3">
Click to view the solution.
</button>
</h2>
<div id="collapse9_3" class="accordion-collapse collapse"
aria-labelledby="heading9_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">f(t)</span> is not convex, but has a global
minimum.</p>
<p>It is seen that <span class="math inline">f(t)</span> isn’t convex,
which can be verified using the second derivative test: <span class="math display">f'(t) = 2(t - 3) + 2(t^2 - 1) 2t = 2t - 6 +
4t^3 - 4t = 4t^3 - 2t - 6</span> <span class="math display">f''(t) = 12t^2 - 2</span></p>
<p>Clearly, <span class="math inline">f''(t) &lt; 0</span> for
many values of <span class="math inline">t</span> (e.g. <span class="math inline">t = 0</span>), so <span class="math inline">f(t)</span> is not always convex.</p>
<p>However, <span class="math inline">f(t)</span> does have a global
minimum – its output is never less than 0. This is because it can be
expressed as the sum of two squares, <span class="math inline">(t -
3)^2</span> and <span class="math inline">(t^2 - 1)^2</span>,
respectively, both of which are greater than or equal to 0.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="section"><span class="math display"> </span></h2>
<h4
id="feedback-find-an-error-still-confused-have-a-suggestion-let-us-know-here.">👋
Feedback: Find an error? Still confused? Have a suggestion? Let us know
<a href="https://forms.gle/xK4DpWXh9rq8AKP37">here</a>.</h4>
<hr />
</body>
</html>
