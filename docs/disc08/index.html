<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Multiple Linear Regression</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="../assets/theme.css" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">Multiple Linear Regression</h1>
</header>
<p><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<!-- add after bootstrap.min.css -->
<link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"/>
<!-- add after bootstrap.min.js or bootstrap.bundle.min.js -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script></p>
<!-- for difficulty gauges-->
<script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-B947E6J6H4"></script> -->
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  // gtag('js', new Date());

  // gtag('config', 'G-B947E6J6H4');
</script>
<p><a href="../index.html">← return to study.practicaldsc.org</a></p>
<hr />
<p>The problems in this worksheet are taken from past exams in similar
classes. Work on them <strong>on paper</strong>, since the exams you
take in this course will also be on paper.</p>
<hr />
<h2 id="problem-1">Problem 1</h2>
<p>Billy’s aunt owns a jewellery store, and gives him data on <span
class="math inline">5000</span> of the diamonds in her store. For each
diamond, we have:</p>
<ul>
<li><strong>carat</strong>: the weight of the diamond, in carats</li>
<li><strong>length</strong>: the length of the diamond, in
centimeters</li>
<li><strong>width</strong>: the width of the diamond, in
centimeters</li>
<li><strong>price</strong>: the value of the diamond, in dollars</li>
</ul>
<p>The first 5 rows of the 5000-row dataset are shown below:</p>
<div>
<table>
<colgroup>
<col style="width: 24%" />
<col style="width: 27%" />
<col style="width: 24%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr>
<th>carat   </th>
<th>length   </th>
<th>width   </th>
<th>price   </th>
</tr>
</thead>
<tbody>
<tr>
<td>0.40</td>
<td>4.81</td>
<td>4.76</td>
<td>1323</td>
</tr>
<tr>
<td>1.04</td>
<td>6.58</td>
<td>6.53</td>
<td>5102</td>
</tr>
<tr>
<td>0.40</td>
<td>4.74</td>
<td>4.76</td>
<td>696</td>
</tr>
<tr>
<td>0.40</td>
<td>4.67</td>
<td>4.65</td>
<td>798</td>
</tr>
<tr>
<td>0.50</td>
<td>4.90</td>
<td>4.95</td>
<td>987</td>
</tr>
</tbody>
</table>
</div>
<p><br> Billy has enlisted our help in predicting the price of a diamond
given various other features.</p>
<p><br></p>
<h3 id="problem-1.1">Problem 1.1</h3>
<p>Suppose we want to fit a linear prediction rule that uses two
features, carat and length, to predict price. Specifically, our
prediction rule will be of the form</p>
<p><span class="math display">\text{predicted price} = w_0 + w_1 \cdot
\text{carat} + w_2 \cdot \text{length}</span></p>
<p><br></p>
<p>We will use least squares to find <span class="math inline">\vec{w}^*
= \begin{bmatrix} w_0^* \\ w_1^* \\ w_2^* \end{bmatrix}</span>.</p>
<p>Write out the first 5 rows of the design matrix, <span
class="math inline">X</span>. Your matrix should not have any variables
in it.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_1" aria-expanded="true" aria-controls="collapse1_1">
Click to view the solution.
</button>
</h2>
<div id="collapse1_1" class="accordion-collapse collapse"
aria-labelledby="heading1_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <span class="math display">X =
\begin{bmatrix} 1 &amp; 0.40 &amp; 4.81 \\ 1 &amp; 1.04 &amp; 6.58 \\ 1
&amp; 0.40 &amp; 4.74 \\ 1 &amp; 0.40 &amp; 4.67 \\ 1 &amp; 0.50 &amp;
4.90 \end{bmatrix}</span></p>
<p>In this design matrix X - the first column consists of all 1s (for
the intercept term <span class="math inline">w_0</span>), the second
column contains the carat values (for the coefficient <span class="math inline">w_1</span>), and the third column contains the
length values (for the coefficient <span class="math inline">w_2</span>).</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.2">Problem 1.2</h3>
<p>Suppose the optimal parameter vector <span
class="math inline">\vec{w}^*</span> is given by</p>
<p><span class="math display">\vec{w}^* = \begin{bmatrix} 2000 \\ 10000
\\ -1000 \end{bmatrix}</span></p>
<p>What is the predicted price of a diamond with 0.65 carats and a
length of 4 centimeters? Show your work.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_2" aria-expanded="true" aria-controls="collapse1_2">
Click to view the solution.
</button>
</h2>
<div id="collapse1_2" class="accordion-collapse collapse"
aria-labelledby="heading1_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: The predicted price is <span class="math inline">4500</span> dollars.</p>
<p>From our optimal parameter vector we know that <span class="math inline">w_0^* = 2000</span>, <span class="math inline">w_1^*
= 10000</span>, and <span class="math inline">w_2^* = -1000</span>. We
can compute the predicted price using our linear model:</p>
<p><span class="math display">\text{predicted price} = \begin{bmatrix} 1
&amp; 0.65 &amp; 4 \end{bmatrix} \cdot \begin{bmatrix} 2000 \\ 10000 \\
-1000 \end{bmatrix}</span></p>
<p>Computing: <span class="math display">2000 + 10000 \cdot 0.65 - 1000
\cdot 4 = 2000 + 6500 - 4000 = 4500</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.3">Problem 1.3</h3>
<p>Suppose <span class="math inline">\vec{e} = \begin{bmatrix} e_1 \\
e_2 \\ ... \\ e_n \end{bmatrix}</span> is the error/residual vector,
defined as</p>
<p><span class="math display">\vec{e} = \vec{y} - X \vec{w}^*</span></p>
<p>where <span class="math inline">\vec{y}</span> is the observation
vector containing the prices for each diamond.</p>
<p>For each of the following quantities, state whether they are
guaranteed to be equal to 0 the scalar, <span
class="math inline">\vec{0}</span> the vector of all 0s, or neither. No
justification is necessary.</p>
<ul>
<li><span class="math inline">\sum_{i = 1}^n e_i</span></li>
<li><span class="math inline">|| \vec{y} - X \vec{w}^* ||^2</span></li>
<li><span class="math inline">X^TX \vec{w}^*</span></li>
<li><span class="math inline">2X^TX \vec{w}^* - 2X^T\vec{y}</span></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_3" aria-expanded="true" aria-controls="collapse1_3">
Click to view the solution.
</button>
</h2>
<div id="collapse1_3" class="accordion-collapse collapse"
aria-labelledby="heading1_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>:</p>
<ul>
<li><span class="math inline">\sum_{i = 1}^n e_i</span>:
<strong>Yes</strong>, this is guaranteed to be 0. This was discussed in
Homework 7; it is a consequence of the fact that <span class="math inline">X^T (y - X \vec{w}^*) = 0</span> and that we have an
intercept term in our prediction rule (and hence a column of all 1s in
our design matrix, <span class="math inline">X</span>).</li>
<li><span class="math inline">|| \vec{y} - X \vec{w}^* ||^2</span>:
<strong>No</strong>, this is not guaranteed to be 0. This is the mean
squared error of our prediction rule, multiplied by <span class="math inline">n</span>. <span class="math inline">\vec{w}^*</span>
is found by minimizing mean squared error, but the minimum value of mean
squared error isn’t necessarily 0 — in fact, this quantity is only 0 if
we can write <span class="math inline">\vec{y}</span> exactly as <span class="math inline">X \vec{w}^*</span> with no prediction errors.</li>
<li><span class="math inline">X^TX \vec{w}^*</span>:
<strong>No</strong>, this is not guaranteed to be 0, either.</li>
<li><span class="math inline">2X^TX \vec{w}^* - 2X^T\vec{y}</span>:
<strong>Yes</strong>, this is guaranteed to be 0. Recall, the optimal
parameter vector <span class="math inline">\vec{w}^*</span> satisfies
the normal equations <span class="math inline">X^TX\vec{w}^* = X^T
\vec{y}</span>. Subtracting <span class="math inline">X^T \vec{y}</span>
from both sides of this equation and multiplying both sides by 2 yields
the desired result.</li>
</ul>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.4">Problem 1.4</h3>
<p>Suppose we introduce two more features:</p>
<ul>
<li>width alone, and</li>
<li>area, which is defined as length times width</li>
</ul>
<p>Suppose we also decide to remove the intercept term of our prediction
rule. With all of these changes, our prediction rule is now</p>
<p><span class="math display">\text{predicted price} = w_1 \cdot
\text{carat} + w_2 \cdot \text{length} + w_3 \cdot \text{width} + w_4
\cdot (\text{length} \cdot \text{width}) </span></p>
<ul>
<li>Write out just the first 2 rows of the design matrix <span
class="math inline">X</span> for this new prediction rule. You do
<strong>not</strong> need to simplify the numbers in your matrix, it is
fine if they involve the multiplication symbol.</li>
<li>Is the optimal coefficient for carat, <span
class="math inline">w_1^*</span>, for this new prediction rule
guaranteed to be equal to 10000, the optimal coefficient for carat in
our original prediction rule? No justification is necessary.</li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_4" aria-expanded="true" aria-controls="collapse1_4">
Click to view the solution.
</button>
</h2>
<div id="collapse1_4" class="accordion-collapse collapse"
aria-labelledby="heading1_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>:</p>
<ul>
<li><span class="math inline">X = \begin{bmatrix} 0.40 &amp; 4.81 &amp;
4.76 &amp; 4.81 \cdot 4.76 \\ 1.04 &amp; 6.58 &amp; 6.53 &amp; 6.58
\cdot 6.53 \end{bmatrix}</span></li>
<li>No, it’s not guaranteed that the <span class="math inline">\vec{w}_1^*</span> for this new prediction rule is
equal to the <span class="math inline">\vec{w}_1^*</span> for the
original prediction rule. The value of <span class="math inline">\vec{w}_1^*</span> in the new prediction rule will
be influenced by the fact that there’s no longer an intercept term and
that there are two new features (width and area) that weren’t previously
there.</li>
</ul>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-2">Problem 2</h2>
<p>Suppose we want to fit a hypothesis function of the form:</p>
<p><span class="math display">H(x_i) = w_0 + w_1 x_i^2</span></p>
<p>Note that this is <em>not</em> the simple linear regression
hypothesis function, <span class="math inline">H(x_i) = w_0 +
w_1x_i</span>.</p>
<p>To do so, we will find the optimal parameter vector <span
class="math inline">\vec{w}^* = \begin{bmatrix} w_0^* \\ w_1^*
\end{bmatrix}</span> that satisfies the normal equations. The first 5
rows of our dataset are as follows, though note that our dataset has
<span class="math inline">n</span> rows in total.</p>
<!-- | x  | y |
|----|---|
| 2  | 4 |
| -1 | 4 |
| 3  | 4 |
| -7 | 4 |
| 3  | 4 | -->
<table style="border: 1px solid black; border-collapse: collapse; margin: auto; text-align: center;">
  <tr>
    <th style="border: 1px solid black; padding: 8px;">x</th>
    <th style="border: 1px solid black; padding: 8px;">y</th>
  </tr>
  <tr>
    <td style="border: 1px solid black; padding: 8px;">2</td>
    <td style="border: 1px solid black; padding: 8px;">4</td>
  </tr>
  <tr>
    <td style="border: 1px solid black; padding: 8px;">-1</td>
    <td style="border: 1px solid black; padding: 8px;">4</td>
  </tr>
  <tr>
    <td style="border: 1px solid black; padding: 8px;">3</td>
    <td style="border: 1px solid black; padding: 8px;">4</td>
  </tr>
  <tr>
    <td style="border: 1px solid black; padding: 8px;">-7</td>
    <td style="border: 1px solid black; padding: 8px;">4</td>
  </tr>
  <tr>
    <td style="border: 1px solid black; padding: 8px;">3</td>
    <td style="border: 1px solid black; padding: 8px;">4</td>
  </tr>
</table>
<p>Suppose that <span class="math inline">x_1, x_2, ..., x_n</span> have
a mean of <span class="math inline">\bar{x} = 2</span> and a variance of
<span class="math inline">\sigma_x^2 = 10</span>.</p>
<p><br></p>
<h3 id="problem-2.1">Problem 2.1</h3>
<p>Write out the first 5 rows of the design matrix, <span
class="math inline">X</span>.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_1" aria-expanded="true" aria-controls="collapse2_1">
Click to view the solution.
</button>
</h2>
<div id="collapse2_1" class="accordion-collapse collapse"
aria-labelledby="heading2_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <span class="math inline">X =
\begin{bmatrix} 1 &amp; 4 \\ 1 &amp; 1 \\ 1 &amp; 9 \\ 1 &amp; 49 \\ 1
&amp; 9 \end{bmatrix}</span></p>
<p>Recall our hypothesis function is <span class="math inline">H(x_i) =
w_0 + w_1x_i^2</span>. Since there is an intercept term present, and
<span class="math inline">w_0</span> is the first parameter, the first
column of our design matrix will be all 1s. Our second column should
contain <span class="math inline">x_1^2, x_2^2, ..., x_n^2</span>. This
means we take each datapoint <span class="math inline">x_i</span> and
square it to form the second column of <span class="math inline">X</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.2">Problem 2.2</h3>
<p>Suppose, just in part (b), that after solving the normal equations,
we find <span class="math inline">\vec{w}^* = \begin{bmatrix} 2 \\ -5
\end{bmatrix}</span>. What is the predicted <span
class="math inline">y</span> value for <span class="math inline">x =
2</span>? Give your answer as an integer with no variables. Show your
work.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_2" aria-expanded="true" aria-controls="collapse2_2">
Click to view the solution.
</button>
</h2>
<div id="collapse2_2" class="accordion-collapse collapse"
aria-labelledby="heading2_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <span class="math inline">-18</span></p>
<p><span class="math inline">(2)(1)+(-5)(4)=-18</span></p>
<p>To find the predicted <span class="math inline">y</span> value, we
plug in <span class="math inline">x_i = 2</span> into the hypothesis
function <span class="math inline">H(x_i) = w_0 + w_1x_i^2</span>, or
take the dot product of <span class="math inline">\vec{w}^*</span> with
<span class="math inline">\begin{bmatrix}1 \\
2^2\end{bmatrix}</span>.</p>
<p><span class="math display">\begin{align*}
&amp;\begin{bmatrix} 2 \\ -5 \end{bmatrix} \cdot \begin{bmatrix} 1 \\ 4
\end{bmatrix}\\
&amp;(2)(1)+(-5)(4)\\
&amp;2 - 20\\
&amp;-18
\end{align*}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.3">Problem 2.3</h3>
<p>Let <span class="math inline">X_\text{tri} = 3 X</span>. Using the
fact that <span class="math inline">\sum_{i = 1}^n x_i^2 = n \sigma_x^2
+ n \bar{x}^2</span>, determine the value of the bottom-left value in
the matrix <span class="math inline">X_\text{tri}^T X_\text{tri}</span>,
i.e. the value in the second row and first column. Give your answer as
an expression involving <span class="math inline">n</span>. Show your
work.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_3" aria-expanded="true" aria-controls="collapse2_3">
Click to view the solution.
</button>
</h2>
<div id="collapse2_3" class="accordion-collapse collapse"
aria-labelledby="heading2_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <span class="math inline">126n</span></p>
<p><span class="math display">
X = \begin{bmatrix} 1 &amp; x_1^2 \\ 1 &amp; x_2^2 \\ \vdots &amp;
\vdots \\ 1 &amp; x_n^2 \end{bmatrix}
</span></p>
<p><span class="math display">
X_{\text{tri}} = \begin{bmatrix} 3 &amp; 3x_1^2 \\ 3 &amp; 3x_2^2 \\
\vdots &amp; \vdots \\ 3 &amp; 3x_n^2 \end{bmatrix}
</span></p>
<p>We want to know what the bottom left value of <span class="math inline">X_\text{tri}^T X_\text{tri}</span> is. We figure
this out with matrix multiplication!</p>
<p><span class="math display">\begin{align*}
X_\text{tri}^T X_\text{tri} &amp;= \begin{bmatrix} 3 &amp; 3 &amp; ...
&amp; 3\\ 3x_1^2 &amp; 3x_2^2 &amp; ... &amp; 3x_n^2 \end{bmatrix}
\begin{bmatrix} 3 &amp; 3x_1^2 \\ 3 &amp; 3x_2^2 \\ \vdots &amp; \vdots
\\ 3 &amp; 3x_n^2 \end{bmatrix}\\
&amp;= \begin{bmatrix} \sum_{i = 1}^n 3(3) &amp; \sum_{i = 1}^n
3(3x_i^2) \\ \sum_{i = 1}^n 3(3x_i^2) &amp; \sum_{i = 1}^n
(3x_i^2)(3x_i^2)\end{bmatrix}\\
&amp;= \begin{bmatrix} \sum_{i = 1}^n 9 &amp; \sum_{i = 1}^n 9x_i^2 \\
\sum_{i = 1}^n 9x_i^2 &amp; \sum_{i = 1}^n (3x_i^2)^2 \end{bmatrix}
\end{align*}</span></p>
<p>We can see that the bottom left element should be <span class="math inline">\sum_{i = 1}^n 9x_i^2</span>.</p>
<p>From here we can use the fact given to us in the directions: <span class="math inline">\sum_{i = 1}^n x_i^2 = n \sigma_x^2 + n
\bar{x}^2</span>.</p>
<p><span class="math display">\begin{align*}
\sum_{i = 1}^n 9x_i^2 &amp;= 9\sum_{i = 1}^n x_i^2\\
&amp;= 9(n \sigma_x^2 + n \bar{x}^2)\\
&amp;= 9(10n + 2^2n)\\
&amp;= 9(10n + 4n)\\
&amp;= 9(14n) = 126n
\end{align*}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-3">Problem 3</h2>
<p>Consider the vectors <span class="math inline">\vec{u}</span> and
<span class="math inline">\vec{v}</span>, defined below.</p>
<p><span class="math display">\vec{u} = \begin{bmatrix} 1 \\ 0 \\ 0
\end{bmatrix} \qquad \vec{v} = \begin{bmatrix} 0 \\ 1 \\ 1
\end{bmatrix}</span></p>
<p>We define <span class="math inline">X \in \mathbb{R}^{3 \times
2}</span> to be the matrix whose first column is <span
class="math inline">\vec u</span> and whose second column is <span
class="math inline">\vec v</span>.</p>
<p><br></p>
<h3 id="problem-3.1">Problem 3.1</h3>
<p>In this part only, let <span class="math inline">\vec{y} =
\begin{bmatrix} -1 \\ k \\ 252 \end{bmatrix}</span>.</p>
<p>Find a scalar <span class="math inline">k</span> such that <span
class="math inline">\vec{y}</span> is in <span
class="math inline">\text{span}(\vec u, \vec v)</span>. Give your answer
as a constant with no variables.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_1" aria-expanded="true" aria-controls="collapse3_1">
Click to view the solution.
</button>
</h2>
<div id="collapse3_1" class="accordion-collapse collapse"
aria-labelledby="heading3_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <span class="math inline">252</span>.</p>
<p>Vectors in <span class="math inline">\text{span}(\vec u, \vec
v)</span> are all linear combinations of <span class="math inline">\vec{u}</span> and <span class="math inline">\vec{v}</span>, meaning they have the form:</p>
<p><span class="math display">
a \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix} + b \begin{bmatrix} 0 \\ 1
\\ 1 \end{bmatrix} = \begin{bmatrix} a \\ b \\ b \end{bmatrix}
</span></p>
<p>From this, any vector in the span must have its second and third
components equal. Since <span class="math inline">\vec{y}</span> has its
third component as 252, so k must equal to 252.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.2">Problem 3.2</h3>
<p>Show that: <span class="math display">(X^TX)^{-1}X^T =
\begin{bmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; \frac{1}{2} &amp;
\frac{1}{2} \end{bmatrix}</span></p>
<p><em>Hint: If <span class="math inline">A = \begin{bmatrix} a_1 &amp;
0 \\ 0 &amp; a_2 \end{bmatrix}</span>, then <span
class="math inline">A^{-1} = \begin{bmatrix} \frac{1}{a_1} &amp; 0 \\ 0
&amp; \frac{1}{a_2} \end{bmatrix}</span>.</em></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_2" aria-expanded="true" aria-controls="collapse3_2">
Click to view the solution.
</button>
</h2>
<div id="collapse3_2" class="accordion-collapse collapse"
aria-labelledby="heading3_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: We can construct the following series of
matrices to get <span class="math inline">(X^TX)^{-1}X^T</span>.</p>
<ul>
<li><span class="math inline">X = \begin{bmatrix} 1 &amp; 0 \\ 0 &amp; 1
\\ 0 &amp; 1 \end{bmatrix}</span></li>
<li><span class="math inline">X^T = \begin{bmatrix} 1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 1 \end{bmatrix}</span></li>
<li><span class="math inline">X^TX = \begin{bmatrix} 1 &amp; 0 \\ 0
&amp; 2 \end{bmatrix}</span></li>
<li><span class="math inline">(X^TX)^{-1} = \begin{bmatrix} 1 &amp; 0 \\
0 &amp; \frac{1}{2} \end{bmatrix}</span></li>
<li><span class="math inline">(X^TX)^{-1}X^T = \begin{bmatrix} 1 &amp; 0
&amp; 0 \\ 0 &amp; \frac{1}{2} &amp; \frac{1}{2}
\end{bmatrix}</span></li>
</ul>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.3">Problem 3.3</h3>
<p>In parts 3 and 4 only, let <span class="math inline">\vec{y} =
\begin{bmatrix} 4 \\ 2 \\ 8 \end{bmatrix}</span>.</p>
<p>Find scalars <span class="math inline">a</span> and <span
class="math inline">b</span> such that <span class="math inline">a \vec
u + b \vec v</span> is the vector in <span
class="math inline">\text{span}(\vec u, \vec v)</span> that is as close
to <span class="math inline">\vec{y}</span> as possible. Give your
answers as constants with no variables.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_3" aria-expanded="true" aria-controls="collapse3_3">
Click to view the solution.
</button>
</h2>
<div id="collapse3_3" class="accordion-collapse collapse"
aria-labelledby="heading3_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <span class="math inline">a = 4</span>,
<span class="math inline">b = 5</span>.</p>
<p>The result from the part (b) implies that when using the normal
equations to find coefficients for <span class="math inline">\vec
u</span> and <span class="math inline">\vec v</span> – which we know
from lecture produce an error vector whose length is minimized – the
coefficient on <span class="math inline">\vec u</span> must be <span class="math inline">y_1</span> and the coefficient on <span class="math inline">\vec v</span> must be <span class="math inline">\frac{y_2 + y_3}{2}</span>. This can be shown by
taking the result from part (b), <span class="math inline">\begin{bmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp;
\frac{1}{2} &amp; \frac{1}{2} \end{bmatrix}</span>, and multiplying it
by the vector <span class="math inline">\vec y = \begin{bmatrix} y_1 \\
y_2 \\ y_3 \end{bmatrix}</span>.</p>
<p>Here, <span class="math inline">y_1 = 4</span>, so <span class="math inline">a = 4</span>. We also know <span class="math inline">y_2 = 2</span> and <span class="math inline">y_3 =
8</span>, so <span class="math inline">b = \frac{2+8}{2} = 5</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.4">Problem 3.4</h3>
<p>Let <span class="math inline">\vec{e} = \vec{y} - (a \vec u + b \vec
v)</span>, where <span class="math inline">a</span> and <span
class="math inline">b</span> are the values you found in part (c).</p>
<p>What is <span class="math inline">\lVert \vec{e} \rVert</span>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">0</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">3 \sqrt{2}</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">4 \sqrt{2}</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">6</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">6 \sqrt{2}</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">2\sqrt{21}</span></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_4" aria-expanded="true" aria-controls="collapse3_4">
Click to view the solution.
</button>
</h2>
<div id="collapse3_4" class="accordion-collapse collapse"
aria-labelledby="heading3_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <span class="math inline">3
\sqrt{2}</span>.</p>
<p>The correct value of <span class="math inline">a \vec u + b \vec v =
\begin{bmatrix} 4 \\ 5 \\ 5\end{bmatrix}</span>. Then, <span class="math inline">\vec{e} = \begin{bmatrix} 4 \\ 2 \\ 8 \end{bmatrix}
- \begin{bmatrix} 4 \\ 5 \\ 5 \end{bmatrix} = \begin{bmatrix} 0 \\ -3 \\
3 \end{bmatrix}</span>, which has a length of <span class="math inline">\sqrt{0^2 + (-3)^2 + 3^2} = 3\sqrt{2}</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.5">Problem 3.5</h3>
<p>Is it true that, for any vector <span class="math inline">\vec{y} \in
\mathbb{R}^3</span>, we can find scalars <span
class="math inline">c</span> and <span class="math inline">d</span> such
that the sum of the entries in the vector <span
class="math inline">\vec{y} - (c \vec u + d \vec v)</span> is 0?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes, because <span class="math inline">\vec{u}</span> and <span class="math inline">\vec{v}</span> are linearly independent.</p></li>
<li><p><input type="radio" disabled="" /> Yes, because <span class="math inline">\vec{u}</span> and <span class="math inline">\vec{v}</span> are orthogonal.</p></li>
<li><p><input type="radio" disabled="" /> Yes, but for a reason that isn’t listed here.</p></li>
<li><p><input type="radio" disabled="" /> No, because <span class="math inline">\vec{y}</span> is not
necessarily in <span class="math inline">\text{span}(\vec{u},
\vec{v})</span>.</p></li>
<li><p><input type="radio" disabled="" /> No, because neither <span class="math inline">\vec{u}</span> nor
<span class="math inline">\vec{v}</span> is equal to the vector <span class="math inline">\begin{bmatrix} 1 &amp; 1 &amp; 1
\end{bmatrix}^T</span>.</p></li>
<li><p><input type="radio" disabled="" /> No, but for a reason that isn’t listed here.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_5">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_5" aria-expanded="true" aria-controls="collapse3_5">
Click to view the solution.
</button>
</h2>
<div id="collapse3_5" class="accordion-collapse collapse"
aria-labelledby="heading3_5" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: Yes, but for a reason that isn’t listed
here.</p>
<p>Here’s the full reason:</p>
<ol type="1">
<li>We can use the normal equations to find <span class="math inline">c</span> and <span class="math inline">d</span>, no
matter what <span class="math inline">\vec{y}</span> is.</li>
<li>The error vector <span class="math inline">\vec e</span> that
results from using the normal equations is such that <span class="math inline">\vec e</span> is orthogonal to the span of the
columns of <span class="math inline">X</span>.</li>
<li>The columns of <span class="math inline">X</span> are just <span class="math inline">\vec u</span> and <span class="math inline">\vec
v</span>. So, <span class="math inline">\vec e</span> is orthogonal to
any linear combination of <span class="math inline">\vec u</span> and
<span class="math inline">\vec v</span>.</li>
<li>One of the many linear combinations of <span class="math inline">\vec u</span> and <span class="math inline">\vec
v</span> is <span class="math inline">\begin{bmatrix} 1 \\ 0 \\ 0
\end{bmatrix} + \begin{bmatrix} 0 \\ 1 \\ 1 \end{bmatrix} =
\begin{bmatrix} 1 \\ 1 \\ 1 \end{bmatrix}</span>.</li>
<li>This means that the vector <span class="math inline">\vec e</span>
is orthogonal to <span class="math inline">\begin{bmatrix} 1 \\ 1 \\ 1
\end{bmatrix}</span>, which means that <span class="math inline">\vec{1}^T \vec{e} = 0 \implies \sum_{i = 1}^3 e_i =
0</span>.</li>
</ol>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.6">Problem 3.6</h3>
<p>Suppose that <span class="math inline">Q \in \mathbb{R}^{100 \times
12}</span>, <span class="math inline">\vec{s} \in
\mathbb{R}^{100}</span>, and <span class="math inline">\vec{f} \in
\mathbb{R}^{12}</span>. What are the dimensions of the following
product?</p>
<p><span class="math display">\vec{s}^T Q \vec{f}</span></p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> scalar</p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">12 \times 1</span> vector</p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">100 \times 1</span> vector</p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">100 \times 12</span> matrix</p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">12 \times 12</span> matrix</p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">12 \times 100</span> matrix</p></li>
<li><p><input type="radio" disabled="" /> undefined</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_6">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_6" aria-expanded="true" aria-controls="collapse3_6">
Click to view the solution.
</button>
</h2>
<div id="collapse3_6" class="accordion-collapse collapse"
aria-labelledby="heading3_6" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: Scalar.</p>
<ul>
<li><span class="math inline">\vec{s}^T</span>: 1 x 100</li>
<li><span class="math inline">Q</span>: 100 x 12.</li>
<li><span class="math inline">\vec{f}</span>: 12 x 1.</li>
</ul>
<p>The inner dimensions of 100 and 12 cancel, and so <span class="math inline">\vec{s}^T Q \vec{f}</span> is of shape 1 x 1.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-4">Problem 4</h2>
<p>Suppose we want to predict how long it takes to run a Jupyter
notebook on Datahub. For 100 different Jupyter notebooks, we collect the
following 5 pieces of information:</p>
<ul>
<li><p><strong>cells</strong>: number of cells in the notebook</p></li>
<li><p><strong>lines</strong>: number of lines of code</p></li>
<li><p><strong>max iterations</strong>: largest number of iterations in
any loop in the notebook, or 1 if there are no loops</p></li>
<li><p><strong>variables</strong>: number of variables defined in the
notebook</p></li>
<li><p><strong>runtime</strong>: number of seconds for the notebook to
run on Datahub</p></li>
</ul>
<p>Then we use multiple regression to fit a prediction rule of the form
<!-- $$H(\text{cells, lines, max iterations, variables}) =  w_0 + w_1 \cdot \text{cells} \cdot \text{lines} + w_2 \cdot (\text{max iterations})^{\text{variables} - 10}$$ --></p>
<p><span class="math display">H(\text{cells}_i, \text{lines}_i,
\text{max iterations}_i, \text{variables}_i) =  
w_0 + w_1 \cdot \text{cells}_i \cdot \text{lines}_i + w_2 \cdot
(\text{max iterations}_i)^{\text{variables}_i - 10}</span></p>
<p><br></p>
<h3 id="problem-4.1">Problem 4.1</h3>
<p>What are the dimensions of the design matrix <span
class="math inline">X</span>?</p>
<p><span class="math display">
\begin{bmatrix}
&amp; &amp; &amp; \\
&amp; &amp; &amp; \\
&amp; &amp; &amp; \\
\end{bmatrix}_{r \times c}
</span></p>
<p>So, what should <span class="math inline">r</span> and <span
class="math inline">c</span> be for: <span class="math inline">r</span>
rows <span class="math inline">\times</span> <span
class="math inline">c</span> columns.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_1" aria-expanded="true" aria-controls="collapse4_1">
Click to view the solution.
</button>
</h2>
<div id="collapse4_1" class="accordion-collapse collapse"
aria-labelledby="heading4_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>:</p>
<p><span class="math inline">100 \text{ rows} \times 3 \text{
columns}</span></p>
<p>There should be <span class="math inline">100</span> rows because
there are <span class="math inline">100</span> different Jupyter
notebooks with different information within them. There should be <span class="math inline">3</span> columns, one for each <span class="math inline">w_i</span>. In this case we have <span class="math inline">w_0</span>, which means <span class="math inline">X</span> will have a column of ones, <span class="math inline">w_1</span>, which means <span class="math inline">X</span> will have a second column of <span class="math inline">\text{cells} \cdot \text{lines}</span>, and <span class="math inline">w_2</span>, which will be the last column in <span class="math inline">X</span> containing <span class="math inline">(\text{max iterations}_i)^{\text{variables}_i -
10}</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-4.2">Problem 4.2</h3>
<p>In <strong>one sentence</strong>, what does the entry in row 3,
column 2 of the design matrix X represent? (Count rows and columns
starting at 1, not 0).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_2" aria-expanded="true" aria-controls="collapse4_2">
Click to view the solution.
</button>
</h2>
<div id="collapse4_2" class="accordion-collapse collapse"
aria-labelledby="heading4_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>:</p>
<p>This entry represents the product of the number of cells and number
of lines of code for the third Jupyter notebook in the training
dataset.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-5">Problem 5</h2>
<p>Consider the dataset shown below.</p>
<div class="center">
<table>
<thead>
<tr>
<th style="text-align: left;"><span
class="math inline">x^{(1)}</span></th>
<th style="text-align: left;"><span
class="math inline">x^{(2)}</span></th>
<th style="text-align: left;"><span
class="math inline">x^{(3)}</span></th>
<th style="text-align: left;"><span class="math inline">y</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">0</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">-5</td>
</tr>
<tr>
<td style="text-align: left;">3</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">7</td>
</tr>
<tr>
<td style="text-align: left;">5</td>
<td style="text-align: left;">-1</td>
<td style="text-align: left;">-3</td>
<td style="text-align: left;">4</td>
</tr>
<tr>
<td style="text-align: left;">0</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
</tr>
</tbody>
</table>
</div>
<p><br></p>
<h3 id="problem-5.1">Problem 5.1</h3>
<p>We want to use multiple regression to fit a prediction rule of the
form <span class="math display">H(x_i^{(1)}, x_i^{(2)}, x_i^{(3)}) = w_0
+ w_1 x_i^{(1)} x_i^{(3)} + w_2 (x_i^{(2)} - x_i^{(3)})^2.</span> Write
down the design matrix <span class="math inline">X</span> and
observation vector <span class="math inline">\vec{y}</span> for this
scenario. No justification needed.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_1" aria-expanded="true" aria-controls="collapse5_1">
Click to view the solution.
</button>
</h2>
<div id="collapse5_1" class="accordion-collapse collapse"
aria-labelledby="heading5_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>The design matrix <span class="math inline">X</span> and observation
vector <span class="math inline">\vec{y}</span> are given by:</p>
<p><span class="math display">
X =
\begin{bmatrix}
1 &amp; 0 &amp; 4\\
1 &amp; 15 &amp; 1\\
1 &amp; -15 &amp; 4\\
1 &amp; 0 &amp; 1
\end{bmatrix}
</span></p>
<p><span class="math display">
\vec{y} =
\begin{bmatrix}
-5\\
7\\
4\\
2
\end{bmatrix}
</span></p>
<p>The observation vector <span class="math inline">\vec{y}</span>
contains the target values from the dataset.</p>
<p>For the design matrix <span class="math inline">X</span>, each row
corresponds to one data point in our dataset, where <span class="math inline">x_i^{(1)}</span>, <span class="math inline">x_i^{(2)}</span>, and <span class="math inline">x_i^{(3)}</span> represent three separate features
for the <span class="math inline">i</span>-th data point. Each row of
<span class="math inline">X</span> has the form <span class="math inline">\begin{bmatrix}1 &amp; x_i^{(1)}x_i^{(3)} &amp;
(x_i^{(2)}-x_i^{(3)})^2\end{bmatrix}</span>. The first column consists
of all 1’s for the bias term <span class="math inline">w_0</span>, which
is not affected by the feature values.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.2">Problem 5.2</h3>
<p>For the <span class="math inline">X</span> and <span
class="math inline">\vec{y}</span> that you have written down, let <span
class="math inline">\vec{w}</span> be the optimal parameter vector,
which comes from solving the normal equations <span
class="math inline">X^TX\vec{w}=X^T\vec{y}</span>. Let <span
class="math inline">\vec{e} = \vec{y} - X \vec{w}</span> be the error
vector, and let <span class="math inline">e_i</span> be the <span
class="math inline">i</span>th component of this error vector. Show that
<span class="math display">4e_1+e_2+4e_3+e_4=0.</span></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_2" aria-expanded="true" aria-controls="collapse5_2">
Click to view the solution.
</button>
</h2>
<div id="collapse5_2" class="accordion-collapse collapse"
aria-labelledby="heading5_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>The key to this problem is the fact that the error vector, <span class="math inline">\vec{e}</span>, is orthogonal to the columns of the
design matrix, <span class="math inline">X</span>. As a refresher, if
<span class="math inline">\vec{w^*}</span> satisfies the normal
equations, then:</p>
<p>We can rewrite the normal equation (<span class="math inline">X^TX\vec{w}=X^T\vec{y}</span>) to allow substitution
for <span class="math inline">\vec{e} = \vec{y} - X \vec{w}</span>.</p>
<p><span class="math display">X^TX\vec{w}=X^T\vec{y}</span> <span class="math display">0 = X^T\vec{y} - X^TX\vec{w}</span> <span class="math display">0 = X^T(\vec{y}-X\vec{w})</span> <span class="math display">0 = X^T\vec{e}</span></p>
<p>The first step is to find <span class="math inline">X^T</span>, which
is easy because we found <span class="math inline">X</span> above: <span class="math display">
\begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; 1 \\ 0 &amp; 15 &amp; -15 &amp; 0 \\ 4 &amp; 1
&amp; 4 &amp; 1
\end{bmatrix}
</span></p>
<p>And now we can plug <span class="math inline">X^T</span> and <span class="math inline">\vec e</span> into our equation <span class="math inline">0 = X^T\vec{e}</span>. It might be easiest to find
the right side first:</p>
<p><span class="math display">X^T\vec{e} = \begin{bmatrix} 1 &amp; 1
&amp; 1 &amp; 1 \\ 0 &amp; 15 &amp; -15 &amp; 0 \\ 4 &amp; 1 &amp; 4
&amp; 1 \end{bmatrix} \cdot \begin{bmatrix} e_1 \\ e_2 \\ e_3 \\
e_4\end{bmatrix}</span></p>
<p><span class="math display">= \begin{bmatrix} e_1 + e_2 + e_3 + e_4 \\
15e_2 - 15e_3 \\ 4e_1 + e_2 + 4e_3 + e_4\end{bmatrix}</span></p>
<p>Finally, we set it equal to zero! <span class="math display">0 = e_1
+ e_2 + e_3 + e_4</span> <span class="math display">0 = 15e_2 -
15e_3</span> <span class="math display">0 = 4e_1 + e_2 + 4e_3 +
e_4</span></p>
<p>With this we have shown that <span class="math inline">4e_1+e_2+4e_3+e_4=0</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-6">Problem 6</h2>
<p>Let <span class="math inline">X</span> be a design matrix with 4
columns, such that the first column is a column of all <span
class="math inline">1</span>s. Let <span
class="math inline">\vec{y}</span> be an observation vector. Let <span
class="math inline">\vec{w}^* = (X^TX)^{-1}X^T\vec{y}.</span> We’ll name
the components of <span class="math inline">\vec{w}^*</span> as
follows:</p>
<p><span class="math display">\vec{w}^* = \begin{bmatrix} w_0^* \\ w_1^*
\\ w_2^* \\ w_3^* \end{bmatrix}</span></p>
<p>In this problem, we’ll consider various modifications to the design
matrix and see how they affect the solution to the normal equations.</p>
<p><br></p>
<h3 id="problem-6.1">Problem 6.1</h3>
<p>Let <span class="math inline">X_a</span> be the design matrix that
comes from <strong>interchanging the first two columns</strong> of <span
class="math inline">X</span>. Let <span class="math inline">\vec{v}^* =
(X_a^TX_a)^{-1}X_a^T\vec{y}</span>. Express the components <span
class="math inline">\vec{v}^*</span> in terms of <span
class="math inline">w_0^*, w_1^*, w_2^*</span>, and <span
class="math inline">w_3^*</span> (which were the components of <span
class="math inline">\vec{w}^*</span>).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_1" aria-expanded="true" aria-controls="collapse6_1">
Click to view the solution.
</button>
</h2>
<div id="collapse6_1" class="accordion-collapse collapse"
aria-labelledby="heading6_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <span class="math display">\vec{v}^* =
\begin{bmatrix} w_1^* \\ w_0^* \\ w_2^* \\ w_3^*
\end{bmatrix}</span></p>
<p>Suppose our original prediction rule was of the form: <span class="math display">H(x_i^{(1)}, x_i^{(2)}, x_i^{(3)}) = w_0 + w_1
x_i^{(1)} + w_2 x_i^{(2)} + w_3 x_i^{(3)}.</span></p>
<p>Because the span of the resulting design matrix has not changed, the
optimal predictions themselves will not change, because the optimal
predictions come from projecting <span class="math inline">\vec{y}</span> onto span(X). So, the problem boils
down to figuring out how to choose the coefficients in <span class="math inline">\vec{v}^*</span> so that the predictions of the
resulting model are the same as those in the original model.</p>
<p>By swapping the first two columns of our design matrix, this changes
the prediction rule to be of the form: <span class="math display">H(x_i^{(1)}, x_i^{(2)}, x_i^{(3)}) = v_1 + v_0
x_i^{(1)} + v_2 x_i^{(2)} + v_3 x_i^{(3)}.</span></p>
<p>Therefore the optimal parameters for the new model are related to the
optimal parameters for the original model by: <span class="math display">\begin{aligned} v_0^* &amp;= w_1^* \\ v_1^* &amp;=
w_0^* \\ v_2^* &amp;= w_2^* \\ v_3^* &amp;= w_3^*
\end{aligned}</span></p>
<p>Intuitively, when we interchange two columns of our design matrix,
all that does is interchange the terms in the prediction rule, which
interchanges those weights in the parameter vector.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-6.2">Problem 6.2</h3>
<p>Let <span class="math inline">X_b</span> be the design matrix that
comes from <strong>adding one to each entry of the first column</strong>
of <span class="math inline">X</span>. Let <span
class="math inline">\vec{v}^* = (X_b^TX_b)^{-1}X_b^T\vec{y}</span>.
Express the components <span class="math inline">\vec{v}^*</span> in
terms of <span class="math inline">w_0^*, w_1^*, w_2^*</span>, and <span
class="math inline">w_3^*</span> (which were the components of <span
class="math inline">\vec{w}^*</span>).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_2" aria-expanded="true" aria-controls="collapse6_2">
Click to view the solution.
</button>
</h2>
<div id="collapse6_2" class="accordion-collapse collapse"
aria-labelledby="heading6_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <span class="math display">\vec{v}^* =
\begin{bmatrix} \dfrac{w_0^*}{2}  \\ w_1^* \\ w_2^* \\
w_3^*\end{bmatrix}</span></p>
<p>Suppose our original prediction rule was of the form: <span class="math display">H(x_i^{(1)}, x_i^{(2)}, x_i^{(3)}) = w_0 + w_1
x_i^{(1)} + w_2 x_i^{(2)} + w_3 x_i^{(3)}.</span></p>
<p>Because the span of the resulting design matrix has not changed, the
optimal predictions themselves will not change, because the optimal
predictions come from projecting <span class="math inline">\vec{y}</span> onto span(X). So, the problem boils
down to figuring out how to choose the coefficients in <span class="math inline">\vec{v}^*</span> so that the predictions of the
resulting model are the same as those in the original model.</p>
<p>By adding one to each entry of the first column of the design matrix,
we are changing the column of <span class="math inline">1</span>s to be
a column of <span class="math inline">2</span>s. This changes the
prediction rule to be of the form: <span class="math display">H(x_i^{(1)}, x_i^{(2)}, x_i^{(3)}) = v_0 \cdot 2 +
v_1 x_i^{(1)} + v_2 x_i^{(2)} + v_3 x_i^{(3)}.</span></p>
<p>In order to compensate for these changes to our coefficients, we need
to “offset” any alterations made to our coefficients. Therefore the
optimal parameters for the new model are related to the optimal
parameters for the original model by: <span class="math display">\begin{aligned} v_0^* &amp;= \dfrac{w_0^*}{2} \\
v_1^* &amp;= w_1^* \\ v_2^* &amp;= w_2^* \\ v_3^* &amp;= w_3^*
\end{aligned}</span></p>
<p>This is saying we just halve the intercept term. For example, imagine
fitting a line to data in <span class="math inline">\mathbb{R}^2</span>
and finding that the best-fitting line is <span class="math inline">y=12+3x</span>. If we had to write this in the form
<span class="math inline">y=v_0\cdot 2 + v_1x</span>, we would find that
the best choice for <span class="math inline">v_0</span> is <span class="math inline">6</span> and the best choice for <span class="math inline">v_1</span> is <span class="math inline">3</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-6.3">Problem 6.3</h3>
<p>Let <span class="math inline">X_c</span> be the design matrix that
comes from <strong>adding one to each entry of the third column</strong>
of <span class="math inline">X</span>. Let <span
class="math inline">\vec{v}^* = (X_c^TX_c)^{-1}X_c^T\vec{y}</span>.
Express the components <span class="math inline">\vec{v}^*</span> in
terms of <span class="math inline">w_0^*, w_1^*, w_2^*</span>, and <span
class="math inline">w_3^*</span>, which were the components of <span
class="math inline">\vec{w}^*</span>.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_3" aria-expanded="true" aria-controls="collapse6_3">
Click to view the solution.
</button>
</h2>
<div id="collapse6_3" class="accordion-collapse collapse"
aria-labelledby="heading6_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <span class="math display">\vec{v}^* =
\begin{bmatrix} w_0^* - w_2^*  \\ w_1^* \\ w_2^* \\ w_3^*
\end{bmatrix}</span></p>
<p>Suppose our original prediction rule was of the form: <span class="math display">H(x_i^{(1)}, x_i^{(2)}, x_i^{(3)}) = w_0 + w_1
x_i^{(1)} + w_2 x_i^{(2)} + w_3 x_i^{(3)}.</span></p>
<p>Because the span of the resulting design matrix has not changed, the
optimal predictions themselves will not change, because the optimal
predictions come from projecting <span class="math inline">\vec{y}</span> onto span(X). So, the problem boils
down to figuring out how to choose the coefficients in <span class="math inline">\vec{v}^*</span> so that the predictions of the
resulting model are the same as those in the original model.</p>
<p>By adding one to each entry of the third column of the design matrix,
this changes the prediction rule to be of the form: <span class="math display">\begin{aligned} H(x_i^{(1)}, x_i^{(2)}, x_i^{(3)})
&amp;= v_0 + v_1 x_i^{(1)} + v_2(x_i^{(2)}+1) + v_3 x_i^{(3)} \\ &amp;=
(v_0 + v_2) + v_1 x_i^{(1)} + v_2 x_i^{(2)} + v_3 x_i^{(3)}
\end{aligned}</span></p>
<p>In order to compensate for these changes to our coefficients, we need
to “offset” any alterations made to our coefficients. Therefore the
optimal parameters for the new model are related to the optimal
parameters for the original model by <span class="math display">\begin{aligned} v_0^* &amp;= w_0^* - w_2^* \\ v_1^*
&amp;= w_1^* \\ v_2^* &amp;= w_2^* \\ v_3^* &amp;= w_3^*
\end{aligned}</span></p>
<p>One way to think about this is that if we replace <span class="math inline">x_i^{(2)}</span> with <span class="math inline">x_i^{(2)}+1</span>, then our predictions will
increase by the coefficient of <span class="math inline">x_i^{(2)}</span>. In order to keep our predictions
the same, we would need to adjust our intercept term by subtracting this
same amount.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<p><span class="math display"> </span></p>
</body>
</html>
