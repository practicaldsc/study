<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>DataFrames and Querying</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../assets/theme.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
   var mathElements = document.getElementsByClassName("math");
   var macros = [];
   for (var i = 0; i < mathElements.length; i++) {
    var texText = mathElements[i].firstChild;
    if (mathElements[i].tagName == "SPAN") {
     katex.render(texText.data, mathElements[i], {
      displayMode: mathElements[i].classList.contains('display'),
      throwOnError: false,
      macros: macros,
      fleqn: false
     });
  }}});
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">DataFrames and Querying</h1>
</header>
<p><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script> <!-- add after bootstrap.min.css --> <link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"/> <!-- add after bootstrap.min.js or bootstrap.bundle.min.js --> <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script></p>
<!-- for difficulty gauges-->
<script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-B947E6J6H4"></script> -->
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  // gtag('js', new Date());

  // gtag('config', 'G-B947E6J6H4');
</script>
<p><a href="../index.html">← return to study.practicaldsc.org</a></p>
<hr />
<p>The problems in this worksheet are taken from past exams in similar classes. Work on them <strong>on paper</strong>, since the exams you take in this course will also be on paper. <br><br>We encourage you to complete this worksheet in a live discussion section. Solutions will be made available after all discussion sections have concluded. You don’t need to submit your answers anywhere.<br><br><b>Note: We do not plan to cover all problems here in the live discussion section</b>; the problems we don’t cover can be used for extra practice.</p>
<hr />
<h2 id="problem-1">Problem 1</h2>
<p>In this problem, we’ll work with the DataFrame <code>dogs</code>, which contains one row for every registered pet dog in Zurich, Switzerland in 2017.</p>
<p>The first few rows of <code>dogs</code> are shown below, but <code>dogs</code> has many more rows than are shown.</p>
<center><img src="../../assets/images/disc02/disc02-p3-df.png" width=750></center>
<p><br></p>
<ul>
<li><code>"owner_id" (int)</code>: A unique ID for each owner. Note that, for example, there are two rows in the preview for <code>4215</code>, meaning that owner has at least 2 dogs. <strong>Assume that if an <code>"owner_id"</code> appears in <code>dogs</code> multiple times, the corresponding <code>"owner_age"</code>, <code>"owner_sex"</code>, and <code>"district"</code> are always the same.</strong></li>
<li><code>"owner_age" (str)</code>: The age group of the owner; either <code>"11-20"</code>, <code>"21-30"</code>, …, or <code>"91-100"</code> (9 possibilities in total).</li>
<li><code>"owner_sex" (str)</code>: The birth sex of the owner; either <code>"m"</code> (male) or <code>"f"</code> (female).</li>
<li><code>"district" (int)</code>: The city district the owner lives in; a positive integer between <code>1</code> and <code>12</code> (inclusive).</li>
<li><code>"primary_breed" (str)</code>: The primary breed of the dog.</li>
<li><code>"secondary_breed" (str)</code>: The secondary breed of the dog. If this column is not null, the dog is a “mixed breed” dog; otherwise, the dog is a “purebred” dog.</li>
<li><code>"dog_sex" (str)</code>: The birth sex of the dog; either <code>"m"</code> (male) or <code>"f"</code> (female).</li>
<li><code>"birth_year" (int)</code>: The birth year of the dog.</li>
</ul>
<p><br></p>
<h3 id="problem-1.1">Problem 1.1</h3>
<p>Fill in the blank so that <code>most_common</code> evaluates to the most common district in <code>dogs</code>. Assume there are no ties.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>most_common <span class="op">=</span> ____</span></code></pre></div>
<p><br></p>
<h3 id="problem-1.2">Problem 1.2</h3>
<p>Fill in the blank so that <code>female_breeds</code> evaluates to a Series containing the primary breeds of all female dogs.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>female_breeds <span class="op">=</span> dogs.____</span></code></pre></div>
<p><br></p>
<hr />
<h2 id="problem-2">Problem 2</h2>
<p>In this problem, we will work with the DataFrame <code>tv</code>, which contains information about various TV shows available to watch on streaming services. For each TV show, we have:</p>
<ul>
<li><code>"Title" (object)</code>: The title of the TV show.</li>
<li><code>"Year" (int)</code>: The year in which the TV show was first released. (For instance, the show <em>How I Met Your Mother</em> ran from 2005 to 2014; there is only one row for <em>How I Met Your Mother</em> in <code>tv</code>, and its <code>"Year"</code> value is 2005.)</li>
<li><code>"Age" (object)</code>: The age category for the TV show. If not missing, <code>"Age"</code> is one of <code>"all"</code>, <code>"7+"</code>, <code>"13+"</code>, <code>"16+"</code>, or <code>"18+"</code>. (For instance, <code>"all"</code> means that the show is appropriate for all audiences, while `“18+”} means that the show contains mature content and viewers should be at least 18 years old.)</li>
<li><code>"IMDb" (float)</code>: The TV show’s rating on IMDb (between 0 and 10).</li>
<li><code>"Rotten Tomatoes" (int)</code>: The TV show’s rating on Rotten Tomatoes (between 0 and 100).</li>
<li><code>"Netflix" (int)</code>: 1 if the show is available for streaming on Netflix and 0 otherwise. The <code>"Hulu"</code>, <code>"Prime Video"</code>, and <code>"Disney+"</code> columns work the same way.</li>
</ul>
<p>The first few rows of <code>tv</code> are shown below (though <code>tv</code> has many more rows than are pictured here).</p>
<center><img src='../assets/images/disc03/data-info-wi23-mt.png' width=65%></center>
<p><br></p>
<h3 id="problem-2.1">Problem 2.1</h3>
<p>As you see in the first few rows of <code>tv</code>, some TV shows are available for streaming on multiple streaming services. Fill in the blanks so that the two expressions below, Expression 1 and Expression 2, <strong>both</strong> evaluate to the <code>"Title"</code> of the TV show that is available for streaming on the <strong>greatest number of streaming services</strong>. Assume there are no ties and that the <code>"Title"</code> column contains unique values.</p>
<p>Expression 1:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>tv.set_index(<span class="st">&quot;Title&quot;</span>).loc[__(a)__].T.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>).idxmax()</span></code></pre></div>
<p>Expression 2:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>        tv.assign(num_services<span class="op">=</span>tv.iloc[__(b)__].<span class="bu">sum</span>(__(c)__))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>            .sort_values(<span class="st">&quot;num_services&quot;</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>            .iloc[__(d)__]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<p><strong><em>Hint</em></strong>: <code>.T</code> transposes the rows and columns of a DataFrame — the indexes of <code>df</code> are the columns of <code>df.T</code> and vice versa.</p>
<p>What goes in the blanks?</p>
<p><br></p>
<p>In the following subparts, consider the variable <code>double_count</code>, defined below.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>double_count <span class="op">=</span> tv[<span class="st">&quot;Title&quot;</span>].value_counts().value_counts()</span></code></pre></div>
<p><br></p>
<h3 id="problem-2.2">Problem 2.2</h3>
<p>What is <code>type(double_count)</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> SeriesGroupBy</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> DataFrameGroupBy</p></li>
</ul>
<p><br></p>
<h3 id="problem-2.3">Problem 2.3</h3>
<p>Which of the following statements are true? Select all that apply.</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> The only case in which it would make sense to set the index of <code>tv</code> to <code>"Title"</code> is if <code>double_count.iloc[0] == 1</code> is <code>True</code>.</p></li>
<li><p><input type="checkbox" disabled="" /> The only case in which it would make sense to set the index of <code>tv</code> to <code>"Title"</code> is if <code>double_count.loc[1] == tv.shape[0]</code> is <code>True</code>.</p></li>
<li><p><input type="checkbox" disabled="" /> If <code>double_count.loc[2] == 5</code> is <code>True</code>, there are 5 TV shows that all share the same <code>"Title"</code>.</p></li>
<li><p><input type="checkbox" disabled="" /> If <code>double_count.loc[2] == 5</code> is <code>True</code>, there are 5 pairs of 2 TV shows such that each pair shares the same <code>"Title"</code>.</p></li>
<li><p><input type="checkbox" disabled="" /> None of the above.</p></li>
</ul>
<p><br></p>
<hr />
<h2 id="problem-3">Problem 3</h2>
<p>Suppose you are given a DataFrame of employees for a given company. The DataFrame, called <code>employees</code>, is indexed by <code>'employee_id'</code> (string) with a column called <code>'years'</code> (int) that contains the number of years each employee has worked for the company. Suppose that the code</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>employees.sort_values(by<span class="op">=</span><span class="st">&#39;years&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>).index[<span class="dv">0</span>]</span></code></pre></div>
<p>outputs <code>'2476'</code>.</p>
<p>True or False: The number of years that employee 2476 has worked for the company is greater than the number of years that any other employee has worked for the company.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<hr />
<h2 id="problem-4">Problem 4</h2>
<p>You are given a DataFrame called <code>sports</code>, indexed by <code>'Sport'</code> containing one column, <code>'PlayersPerTeam'</code>. The first few rows of the DataFrame are shown below:</p>
<center><img src='../assets/images/disc03/sports.png' width=20%></center>
<p><br></p>
<h3 id="problem-4.1">Problem 4.1</h3>
<p>Which of the following evaluates to <code>'basketball'</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>sports.loc[1]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>sports.iloc[1]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>sports.index[1]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>sports['Sport'].iloc[1]</code></p></li>
</ul>
<p><br></p>
<h3 id="problem-4.2">Problem 4.2</h3>
<p>Select the following statements that evaluate to <code>5</code>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>sports.loc['basketball', 'PlayersPerTeam']</code></p></li>
<li><p><input type="radio" disabled="" /> <code>sports['PlayersPerTeam'].loc['basketball']</code></p></li>
<li><p><input type="radio" disabled="" /> <code>sports['PlayersPerTeam'].iloc[1]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>sports.loc['PlayersPerTeam']['basketball']</code></p></li>
<li><p><input type="radio" disabled="" /> <code>sports.loc['basketball']</code></p></li>
<li><p><input type="radio" disabled="" /> <code>sports.iloc[1]</code></p></li>
</ul>
<p><br></p>
<hr />
<h2 id="section"><span class="math display"> </span></h2>
<h4 id="feedback-find-an-error-still-confused-have-a-suggestion-let-us-know-here.">👋 Feedback: Find an error? Still confused? Have a suggestion? Let us know <a href="https://forms.gle/xK4DpWXh9rq8AKP37">here</a>.</h4>
<hr />
</body>
</html>
