<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Feature Engineering and Generalization</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../assets/theme.css" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">Feature Engineering and Generalization</h1>
</header>
<p><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<!-- add after bootstrap.min.css -->
<link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"/>
<!-- add after bootstrap.min.js or bootstrap.bundle.min.js -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script></p>
<!-- for difficulty gauges-->
<script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-B947E6J6H4"></script> -->
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  // gtag('js', new Date());

  // gtag('config', 'G-B947E6J6H4');
</script>
<p><a href="../index.html">← return to study.practicaldsc.org</a></p>
<hr />
<p>The problems in this worksheet are taken from past exams in similar
classes. Work on them <strong>on paper</strong>, since the exams you
take in this course will also be on paper. <br><br>We encourage you to
complete this worksheet in a live discussion section. Solutions will be
made available after all discussion sections have concluded. You don’t
need to submit your answers anywhere.<br><br><b>Note: We do not plan to
cover all problems here in the live discussion section</b>; the problems
we don’t cover can be used for extra practice.</p>
<hr />
<h2 id="problem-1">Problem 1</h2>
<p>Every week, Lauren goes to her local grocery store and buys a varying
amount of vegetable but always buys exactly one pound of meat (either
beef, fish, or chicken). We use a linear regression model to predict her
total grocery bill. We’ve collected a dataset containing the pounds of
vegetables bought, the type of meat bought, and the total bill. Below we
display the first few rows of the dataset and two plots generated using
the entire training set.</p>
<center><img src='../../assets/images/disc09/dsc80_final_q9.png' width=65%></center>
<p><br></p>
<h3 id="problem-1.1">Problem 1.1</h3>
<p>Suppose we fit the following linear regression models to predict
<code>'total'</code> using the squared loss function. Based on the data
and visualizations shown above, for each of the following models <span
class="math inline">H(x_i)</span>, determine whether <strong>each fitted
model coefficient <span class="math inline">w^*</span></strong> is
positive (<span class="math inline">+</span>), negative (<span
class="math inline">-</span>), or exactly 0. The notation <span
class="math inline">\text{meat=beef}</span> refers to the one-hot
encoded <code>'meat'</code> column with value <span
class="math inline">1</span> if the original value in the
<code>'meat'</code> column was <code>'beef'</code> and <span
class="math inline">0</span> otherwise. Likewise, <span
class="math inline">\text{meat=chicken}</span> and <span
class="math inline">\text{meat=fish}</span> are the one-hot encoded
<code>'meat'</code> columns for <code>'chicken'</code> and
<code>'fish'</code>, respectively.</p>
<p>For example, in part (iv), you’ll need to provide three answers: one
for <span class="math inline">w_0^*</span> (either positive, negative,
or 0), one for <span class="math inline">w_1^*</span> (either positive,
negative, or 0), and one for <span class="math inline">w_2^*</span>
(either positive, negative, or 0).</p>
<ol type="i">
<li><span class="math inline">H(x_i) = w_0</span></li>
<li><span class="math inline">H(x_i) = w_0 + w_1 \cdot
\text{veg}_i</span></li>
<li><span class="math inline">H(x_i) = w_0 + w_1 \cdot
(\text{meat=chicken})_i</span></li>
<li><span class="math inline">H(\vec x_i) = w_0 + w_1 \cdot
(\text{meat=beef})_i + w_2 \cdot (\text{meat=chicken})_i</span></li>
<li><span class="math inline">H(\vec x_i) = w_0 + w_1 \cdot
(\text{meat=beef})_i + w_2 \cdot (\text{meat=chicken})_i + w_3 \cdot
(\text{meat=fish})_i</span></li>
</ol>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_1" aria-expanded="true" aria-controls="collapse1_1">
Click to view the solution.
</button>
</h2>
<div id="collapse1_1" class="accordion-collapse collapse"
aria-labelledby="heading1_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Model i. <span class="math inline">H(x_i) =
w_0</span></strong> <br/><strong>Answer</strong>: <span class="math inline">w_0^*</span> must be positive</p>
<p>If <span class="math inline">H(x_i) = w_0</span>, then <span class="math inline">w_0^*</span> will be the mean <code>'total'</code>
value in our dataset, and since all of our observed <code>'total'</code>
values are positive, their mean – and hence, <span class="math inline">w_0^*</span> – must also be positive.</p>
<p><br/></p>
<p><strong>Model ii. <span class="math inline">H(x_i) = w_0 + w_1 \cdot
\text{veg}_i</span></strong> <br/><strong>Answer</strong>: <span class="math inline">w_0^*</span> must be positive; <span class="math inline">w_1^*</span> must be positive</p>
<p>Of the three graphs provided, the middle one shows the relationship
between <code>'total'</code> and <code>'veg'</code>. We see that if we
were to draw a line of best fit, the <span class="math inline">y</span>-intercept (<span class="math inline">w_0^*</span>) would be positive, and so would the
slope (<span class="math inline">w_1^*</span>).</p>
<p><br/></p>
<p><strong>Model iii. <span class="math inline">H(x_i) = w_0 + w_1 \cdot
\text{(meat=chicken)}_i</span></strong> <br/><strong>Answer</strong>:
<span class="math inline">w_0^*</span> must be positive; <span class="math inline">w_1^*</span> must be negative</p>
<p>Here’s the key to solving this part (and the following few): the
input <span class="math inline">x</span> has a <code>'meat'</code> of
<code>'chicken'</code>, <span class="math inline">H(x_i) = w_0 +
w_1</span>. If the input <span class="math inline">x</span> has a
<code>'meat'</code> of something other than <code>'chicken'</code>, then
<span class="math inline">H(x_i) = w_0</span>. So:</p>
<ul>
<li><span class="math inline">w_0^*</span>, the optimal <span class="math inline">w_0</span>, should be a constant
<code>'total'</code> prediction that makes sense for non-chicken inputs,
and</li>
<li><span class="math inline">w_1^*</span>, the optimal <span class="math inline">w_1</span>, should be a number we add to <span class="math inline">w_0^*</span> to adjust the constant
<code>'total'</code> prediction for chickens.</li>
</ul>
<p>For all three <code>'meat'</code> categories, the average observed
<code>'total'</code> value is positive, so it would make sense that for
non-chickens, the constant prediction <span class="math inline">w_0^*</span> is positive. Based on the third graph,
it seems that <code>'chicken'</code>s tend to have a lower
<code>'total'</code> value on average than the other two categories, so
if the input <span class="math inline">x</span> is a
<code>'chicken'</code> (that is, if <span class="math inline">\text{meat=chicken} = 1</span>), then the constant
<code>'total'</code> prediction should be less than the constant
<code>'total'</code> prediction for other <code>'meat'</code>s. Since we
want <code>w_0^* + w_1^*</code> to be less than <span class="math inline">w_0^*</span>, <span class="math inline">w_1^*</span>
must then be negative.</p>
<p><br/></p>
<p><strong>Model iv. <span class="math inline">H(\vec x_i) = w_0 + w_1
\cdot \text{(meat=beef)}_i + w_2 \cdot
\text{(meat=chicken)}_i</span></strong> <br/><strong>Answer</strong>:
<span class="math inline">w_0^*</span> must be positive; <span class="math inline">w_1^*</span> must be negative; <span class="math inline">w_2^*</span> must be negative</p>
<p><span class="math inline">H(\vec x_i)</span> makes one of three
predictions:</p>
<ul>
<li>If <span class="math inline">x</span> has a <code>'meat'</code>
value of <code>'chicken'</code>, then it predicts <span class="math inline">w_0 + w_2</span>.</li>
<li>If <span class="math inline">x</span> has a <code>'meat'</code>
value of <code>'beef'</code>, then it predicts <span class="math inline">w_0 + w_1</span>.</li>
<li>If <span class="math inline">x</span> has a <code>'meat'</code>
value of <code>'fish'</code>, then it predicts <span class="math inline">w_0</span>.</li>
</ul>
<p>Think of <span class="math inline">w_1^*</span> and <span class="math inline">w_2^*</span> – the optimal <span class="math inline">w_1</span> and <span class="math inline">w_2</span>
– as being adjustments to the mean <code>'total'</code> amount for
<code>'fish'</code>. Per the third graph, <code>'fish'</code> have the
highest mean <code>'total'</code> amount of the three
<code>'meat'</code> types, so <span class="math inline">w_0^*</span>
should be positive while <span class="math inline">w_1^*</span> and
<span class="math inline">w_2^*</span> should be negative.</p>
<p><br/></p>
<p><strong>Model v. <span class="math inline">H(\vec x_i) = w_0 + w_1
\cdot \text{(meat=beef)}_i + w_2 \cdot \text{(meat=chicken)}_i + w_3
\cdot \text{(meat=fish)}_i</span></strong> <br/><strong>Answer</strong>:
Not enough information for any of the four coefficients!</p>
<p>Like in the previous part, <span class="math inline">H(\vec
x_i)</span> makes one of three predictions:</p>
<ul>
<li>If <span class="math inline">x</span> has a <code>'meat'</code>
value of <code>'chicken'</code>, then it predicts <span class="math inline">w_0 + w_2</span>.</li>
<li>If <span class="math inline">x</span> has a <code>'meat'</code>
value of <code>'beef'</code>, then it predicts <span class="math inline">w_0 + w_1</span>.</li>
<li>If <span class="math inline">x</span> has a <code>'meat'</code>
value of <code>'fish'</code>, then it predicts <span class="math inline">w_0 + w_3</span>.</li>
</ul>
<p>Since the mean minimizes mean squared error for the constant model,
we’d expect <span class="math inline">w_0^* + w_2^*</span> to be the
mean <code>'total'</code> for <code>'chicken'</code>, <span class="math inline">w_0^* + w_1^*</span> to be the mean
<code>'total'</code> for <code>'beef'</code>, and <span class="math inline">w_0^* + w_3^*</span> to be the mean total for
<code>'fish'</code>. The issue is that there are infinitely many
combinations of <span class="math inline">w_0^*, w_1^*, w_2^*,
w_3^*</span> that allow this to happen!</p>
<p>Pretend, for example, that:</p>
<ul>
<li>The mean <code>'total'</code> for <code>'chicken</code> is 8.</li>
<li>The mean <code>'total'</code> for <code>'beef'</code> is 12.</li>
<li>The mean <code>'total'</code> for <code>'fish'</code> is 15.</li>
</ul>
<p>Then, <span class="math inline">w_0^* = -10, w_1^* = 22, w_2^* = 18,
w_3^* = 25</span> and <span class="math inline">w_0^* = 20, w_1^* = -8,
w_2^* = -12, w_3^* = -5</span> work, but the signs of the coefficients
are inconsistent. As such, it’s impossible to tell!</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.2">Problem 1.2</h3>
<p>Suppose we fit the model <span class="math inline">H(\vec x_i) = w_0
+ w_1 \cdot \text{veg}_i + w_2 \cdot (\text{meat=beef})_i + w_3 \cdot
(\text{meat=fish})_i</span>. After fitting, we find that <span
class="math inline">\vec{w^*}=[-3, 5, 8, 12]</span>.</p>
<p>What is the prediction of this model on the <strong>first</strong>
point in our dataset?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> -3</p></li>
<li><p><input type="radio" disabled="" /> 2</p></li>
<li><p><input type="radio" disabled="" /> 5</p></li>
<li><p><input type="radio" disabled="" /> 10</p></li>
<li><p><input type="radio" disabled="" /> 13</p></li>
<li><p><input type="radio" disabled="" /> 22</p></li>
<li><p><input type="radio" disabled="" /> 25</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_2" aria-expanded="true" aria-controls="collapse1_2">
Click to view the solution.
</button>
</h2>
<div id="collapse1_2" class="accordion-collapse collapse"
aria-labelledby="heading1_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: 10</p>
<p>Plugging in our weights <span class="math inline">\vec{w}^*</span> to
the model <span class="math inline">H(\vec x_i)</span> and filling in
data from the row</p>
<table>
<thead>
<tr>
<th>veg</th>
<th>meat</th>
<th>total</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>beef</td>
<td>13</td>
</tr>
</tbody>
</table>
<p><br/></p>
<p>gives us <span class="math inline">-3 + 5(1) + 8(1) + 12(0) =
10</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.3">Problem 1.3</h3>
<p>Following the same model <span class="math inline">H(\vec x_i)</span>
and weights from the previous problem, what is the loss of this model on
the <strong>second</strong> point in our dataset, using squared
loss?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> 0</p></li>
<li><p><input type="radio" disabled="" /> 1</p></li>
<li><p><input type="radio" disabled="" /> 5</p></li>
<li><p><input type="radio" disabled="" /> 6</p></li>
<li><p><input type="radio" disabled="" /> 8</p></li>
<li><p><input type="radio" disabled="" /> 24</p></li>
<li><p><input type="radio" disabled="" /> 25</p></li>
<li><p><input type="radio" disabled="" /> 169</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_3" aria-expanded="true" aria-controls="collapse1_3">
Click to view the solution.
</button>
</h2>
<div id="collapse1_3" class="accordion-collapse collapse"
aria-labelledby="heading1_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: 25</p>
<p>The squared loss for a single point is <span class="math inline">(\text{actual} - \text{predicted})^2</span>. Here,
our actual <code>'total'</code> value is 19, and our predicted value
<code>'total'</code> value is <span class="math inline">-3 + 5(3) + 8(0)
+ 12(1) = -3 + 15 + 12 = 24</span>, so the squared loss is <span class="math inline">(19 - 24)^2 = (-5)^2 = 25</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-2">Problem 2</h2>
<p>Suppose we want to fit a multiple linear regression model (using
squared loss) that predicts the number of ingredients in a product given
its price and various other information.</p>
<p>From the Data Overview page, we know that there are
<strong>6</strong> different <strong>types</strong> of products. Assume
in this question that there are <strong>20</strong> different product
<strong>brands</strong>. Consider the models defined in the table
below.</p>
<table>
<colgroup>
<col style="width: 16%" />
<col style="width: 15%" />
<col style="width: 11%" />
<col style="width: 27%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr>
<th><strong>Model Name</strong></th>
<th><strong>Intercept</strong></th>
<th><strong>Price</strong></th>
<th><strong>Type</strong></th>
<th><strong>Brand</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Model A</strong></td>
<td>Yes</td>
<td>Yes</td>
<td>No</td>
<td>One hot encoded</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td><strong>without</strong> <code>drop="first"</code></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Model B</strong></td>
<td>Yes</td>
<td>Yes</td>
<td>No</td>
<td>No</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Model C</strong></td>
<td>Yes</td>
<td>Yes</td>
<td>One hot encoded</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td><strong>without</strong> <code>drop="first"</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Model D</strong></td>
<td>No</td>
<td>Yes</td>
<td>One hot encoded</td>
<td>One hot encoded</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td><strong>with</strong> <code>drop="first"</code></td>
<td><strong>with</strong> <code>drop="first"</code></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Model E</strong></td>
<td>No</td>
<td>Yes</td>
<td>One hot encoded</td>
<td>One hot encoded</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td><strong>with</strong> <code>drop="first"</code></td>
<td><strong>without</strong> <code>drop="first"</code></td>
</tr>
</tbody>
</table>
<p>For instance, Model A above includes an intercept term, price as a
feature, one hot encodes brand names, and doesn’t use
<code>drop="first"</code> as an argument to <code>OneHotEncoder</code>
in <code>sklearn</code>.</p>
<p>In parts 1 through 3, you are given a model. For each model provided,
state the <strong>number</strong> of columns and the rank (i.e. number
of linearly independent columns) of the design matrix, <span
class="math inline">X</span>. Some of part 1 is already done for you as
an example.</p>
<p><br></p>
<h3 id="problem-2.1">Problem 2.1</h3>
<p><strong>Model A</strong></p>
<p>Number of columns in <span class="math inline">X</span>:<br />
Rank of <span class="math inline">X</span>: <strong>21</strong></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_1" aria-expanded="true" aria-controls="collapse2_1">
Click to view the solution.
</button>
</h2>
<div id="collapse2_1" class="accordion-collapse collapse"
aria-labelledby="heading2_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>:</p>
<p>Number of columns in <span class="math inline">X</span>:
<strong>22</strong></p>
<p>Model A includes an intercept, the price feature, and a one-hot
encoding of the 20 brands without dropping the first category. The
intercept adds 1 column, the price adds 1 column, and the one-hot
encoding for brands adds 20 columns. The rank is <strong>21</strong>
because one of the brand categories can be predicted by the others
(i.e., the columns are linearly dependent).</p>
<p>The rank is 21 because when encoding categorical variables (such as
brands), dropping the first category avoids introducing perfect
multicollinearity. By not dropping a category, we increase the rank by
1, but this still maintains linear dependence among the columns.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 80%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.2">Problem 2.2</h3>
<p><strong>Model B</strong></p>
<p>Number of columns in <span class="math inline">X</span>:<br />
Rank of <span class="math inline">X</span>:</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_2" aria-expanded="true" aria-controls="collapse2_2">
Click to view the solution.
</button>
</h2>
<div id="collapse2_2" class="accordion-collapse collapse"
aria-labelledby="heading2_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>:</p>
<p>Number of columns in <span class="math inline">X</span>:
<strong>2</strong><br/>
Rank of <span class="math inline">X</span>: <strong>2</strong></p>
<p>Model B includes an intercept and the price feature, but no one-hot
encoding for the brands or product types. The intercept and price are
linearly independent, resulting in both the number of columns and the
rank being 2.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 82%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.3">Problem 2.3</h3>
<p><strong>Model C</strong></p>
<p>Number of columns in <span class="math inline">X</span>:<br />
Rank of <span class="math inline">X</span>:</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_3" aria-expanded="true" aria-controls="collapse2_3">
Click to view the solution.
</button>
</h2>
<div id="collapse2_3" class="accordion-collapse collapse"
aria-labelledby="heading2_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>:</p>
<p>Number of columns in <span class="math inline">X</span>:
<strong>8</strong><br/>
Rank of <span class="math inline">X</span>: <strong>7</strong></p>
<p>Model C includes an intercept, the price feature, and a one-hot
encoding of the 6 product types without dropping the first category. The
intercept adds 1 column, the price adds 1 column, and the one-hot
encoding for the product types adds 6 columns. However, one column is
linearly dependent because we didn’t drop one of the one-hot encoded
columns, reducing the rank to 7.</p>
<p>This happens because if we have 6 product types, one of the columns
can always be written as a linear combination of the other five. Thus,
we lose one degree of freedom in the matrix, and the rank is 7.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 81%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.4">Problem 2.4</h3>
<p>Which of the following models are <strong>NOT guaranteed</strong> to
have residuals that sum to 0?</p>
<p><em>Hint: Remember, the residuals of a fit model are the differences
between actual and predicted <span class="math inline">y</span>-values,
among the data points in the training set.</em></p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> Model A</p></li>
<li><p><input type="checkbox" disabled="" /> Model B</p></li>
<li><p><input type="checkbox" disabled="" /> Model C</p></li>
<li><p><input type="checkbox" disabled="" /> Model D</p></li>
<li><p><input type="checkbox" disabled="" /> Model E</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_4" aria-expanded="true" aria-controls="collapse2_4">
Click to view the solution.
</button>
</h2>
<div id="collapse2_4" class="accordion-collapse collapse"
aria-labelledby="heading2_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: Model D</p>
<p>For residuals to sum to zero in a linear regression model, the design
matrix must include either an intercept term (Models A - C) or
equivalent redundancy in the encoded variables to act as a substitute
for the intercept (Model E). Models that lack both an intercept and
equivalent redundancy, such as Model D, are not guaranteed to have
residuals sum to zero.</p>
<p>For a linear model, the residual vector <span class="math inline">\vec{e}</span> is chosen such that it is orthogonal
to the column space of the design matrix <span class="math inline">X</span>. If one of the columns of <span class="math inline">X</span> is a column of all ones (as in the case
with an intercept term), it ensures that the sum of the residuals is
zero. This is because the error vector <span class="math inline">\vec{e}</span> is orthogonal to the span of <span class="math inline">X</span>, and hence <span class="math inline">X^T
\vec{e} = 0</span>. If there isn’t a column of all ones, but we can
create such a column using a linear combination of the other columns in
<span class="math inline">X</span>, the residuals will still sum to
zero. Model D lacks this structure, so the residuals are not guaranteed
to sum to zero.</p>
<p>In contrast, one-hot encoding without dropping any category can
behave like an intercept because it introduces a column for each
category, allowing the model to adjust its predictions as if it had an
intercept term. The sum of the indicator variables in such a setup
equals 1 for every row, creating a similar effect to an intercept, which
is why residuals may sum to zero in these cases.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 60%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-3">Problem 3</h2>
<p>The DataFrame <code>new_releases</code> contains the following
information for songs that were recently released:</p>
<ul>
<li><p><code>"genre"</code>: the genre of the song (one of the following
5 possibilities: <code>"Hip-Hop/Rap"</code>, <code>"Pop"</code>,
<code>"Country"</code>, <code>"Alternative"</code>, or
<code>"International"</code>)</p></li>
<li><p><code>"rec_label"</code>: the record label of the artist who
released the song (one of the following 4 possibilities:
<code>"EMI"</code>, <code>"SME"</code>, <code>"UMG"</code>, or
<code>"WMG"</code>)</p></li>
<li><p><code>"danceability"</code>: how easy the song is to dance to,
according to the Spotify API (between 0 and 1)</p></li>
<li><p><code>"speechiness"</code>: what proportion of the song is made
up of spoken words, according to the Spotify API (between 0 and
1)</p></li>
<li><p><code>"first_month"</code>: the number of total streams the song
had on Spotify in the first month it was released</p></li>
</ul>
<p>The first few rows of <code>new_releases</code> are shown below
(though <code>new_releases</code> has many more rows than are shown
below).</p>
<center><img src='../assets/images/disc09/new_releases.png' width=55%></center>
<p>We decide to build a linear regression model that predicts
<code>"first_month"</code> given all other information. To start, we
conduct a train-test split, splitting <code>new_releases</code> into
<code>X_train</code>, <code>X_test</code>, <code>y_train</code>, and
<code>y_test</code>.</p>
<p>We then fit two linear models (with intercept terms) to the training
data:</p>
<ul>
<li><p>Model 1 (<code>lr_one</code>): Uses <code>"danceability"</code>
only.</p></li>
<li><p>Model 2 (<code>lr_two</code>): Uses <code>"danceability"</code>
and <code>"speechiness"</code> only.</p></li>
</ul>
<p><br></p>
<h3 id="problem-3.1">Problem 3.1</h3>
<p>Consider the following outputs.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> X_train.shape[<span class="dv">0</span>]</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="dv">50</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> np.<span class="bu">sum</span>((y_train <span class="op">-</span> lr_two.predict(X_train)) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="dv">500000</span> <span class="co"># five hundred thousand</span></span></code></pre></div>
<p>What is Model 2 (<code>lr_two</code>)’s training RMSE (square root of
mean squared error)? Give your answer as an integer.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_1" aria-expanded="true" aria-controls="collapse3_1">
Click to view the solution.
</button>
</h2>
<div id="collapse3_1" class="accordion-collapse collapse"
aria-labelledby="heading3_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> 100</p>
<p>We are given that there are <span class="math inline">n=50</span>
data points, and that the sum of squared errors <span class="math inline">\sum_{i = 1}^n (y_i - H(x_i))^2</span> is <span class="math inline">500{,}000</span>. Then:</p>
<p><span class="math display">\begin{aligned}
    \text{RMSE} &amp;= \sqrt{\frac{1}{n} \sum_{i = 1}^n (y_i -
H(x_i))^2} \\
    &amp;= \sqrt{\frac{1}{50} \cdot 500{,}000} \\
    &amp;= \sqrt{10{,}000}
    \\
    &amp;= 100\end{aligned}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<p>Now, suppose we fit two more linear models (with intercept terms) to
the training data:</p>
<ul>
<li><p>Model 3 (<span class="math inline">\texttt{lr\_drop}</span>):
Uses <code>"danceability"</code> and <code>"speechiness"</code> as-is,
and one-hot encodes <code>"genre"</code> and <code>"rec_label"</code>,
using <code>OneHotEncoder(drop="first")</code>.</p></li>
<li><p>Model 4 (<span class="math inline">\texttt{lr\_no\_drop}</span>):
Uses <code>"danceability"</code> and <code>"speechiness"</code> as-is,
and one-hot encodes <code>"genre"</code> and <code>"rec_label"</code>,
using <code>OneHotEncoder()</code>.</p></li>
</ul>
<p>Note that the only difference between Model 3 and Model 4 is the fact
that Model 3 uses <code>drop="first"</code>.</p>
<p><br></p>
<h3 id="problem-3.2">Problem 3.2</h3>
<p>How many <strong>one-hot encoded</strong> columns are used in each
model? In other words, how many <strong>binary</strong> columns are used
in each model? Give both answers as integers.</p>
<p><em>Hint: Make sure to look closely at the description of
<code>new_releases</code> at the top of the previous page, and don’t
include the already-quantitative features.</em></p>
<p>number of one-hot encoded columns in Model 3 (<code>lr_drop</code>)
=</p>
<p>number of one-hot encoded columns in Model 4
(<code>lr_no_drop</code>) =</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_2" aria-expanded="true" aria-controls="collapse3_2">
Click to view the solution.
</button>
</h2>
<div id="collapse3_2" class="accordion-collapse collapse"
aria-labelledby="heading3_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> 7 and 9</p>
<p>There are 5 unique values of <code>"genre"</code> and 4 unique values
of <code>"rec_label"</code>, so if we create a single one-hot encoded
column for each one, there would be <span class="math inline">5 + 4 =
9</span> one-hot encoded columns (which there are in
<code>lr_no_drop</code>).</p>
<p>If we drop one one-hot-encoded column per category, which is what
<code>drop="first"</code> does, then we only have <span class="math inline">(5 - 1) + (4 - 1) = 7</span> one-hot encoded columns
(which there are in <code>lr_drop</code>).</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.3">Problem 3.3</h3>
<p>Recall, in Model 4 (<code>lr_no_drop</code>) we one-hot encoded
<code>"genre"</code> and <code>"rec_label"</code>, and did not use
<code>drop="first"</code> when instantiating our
<code>OneHotEncoder</code>.</p>
<p>Suppose we are given the following coefficients in Model 4:</p>
<ul>
<li><p>The coefficient on <code>"genre_Pop"</code> is <span
class="math inline">2000</span>.</p></li>
<li><p>The coefficient on <code>"genre_Country"</code> is <span
class="math inline">1000</span>.</p></li>
<li><p>The coefficient on <code>"danceability"</code> is <span
class="math inline">10^6 = 1{,}000{,}000</span>.</p></li>
</ul>
<p>Daisy and Billy are two artists signed to the same
<code>"rec_label"</code> who each just released a new song with the same
<code>"speechiness"</code>. Daisy is a <code>"Pop"</code> artist while
Billy is a <code>"Country"</code> artist.</p>
<p>Model 4 predicted that Daisy’s song and Billy’s song will have the
same <code>"first_month"</code> streams. What is the <strong>absolute
difference</strong> between Daisy’s song’s <code>"danceability"</code>
and Billy’s song’s <code>"danceability"</code>? Give your answer as a
simplified fraction.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_3" aria-expanded="true" aria-controls="collapse3_3">
Click to view the solution.
</button>
</h2>
<div id="collapse3_3" class="accordion-collapse collapse"
aria-labelledby="heading3_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <span class="math inline">\frac{1}{1000}</span></p>
<p>“My favorite problem on the exam!" -Suraj</p>
<p>Model 4 is made up of 11 features, i.e. 11 columns.</p>
<ul>
<li><p>4 of the columns correspond to the different values of
<code>"rec_label"</code>. Since Daisy and Billy have the same
<code>"rec_label"</code>, their values in these four columns are all the
same.</p></li>
<li><p>One of the columns corresponds to <code>"speechiness"</code>.
Since Daisy’s song and Billy’s song have the same
<code>"speechiness"</code>, their values in this column are the
same.</p></li>
<li><p>5 of the columns correspond to the different values of
<code>"genre"</code>. Daisy is a <code>"Pop"</code> artist, so she has a
1 in the <code>"genre_Pop"</code> column and a 0 in the other four
<code>"genre_"</code> columns, and similarly Billy has a 1 in the
<code>"genre_Country"</code> column and 0s in the others.</p></li>
<li><p>One of the columns corresponds to <code>"danceability"</code>,
and Daisy and Billy have different quantitative values in this
column.</p></li>
</ul>
<p>Let <span class="math inline">d_1</span> and <span class="math inline">d_2</span>.</p>
<p>The key is in recognizing that all features in Daisy’s prediction and
Billy’s prediction are the same, other than the coefficients on
<code>"genre_Pop"</code>, <code>"genre_Country"</code>, and
<code>"danceability"</code>. Let’s let <span class="math inline">d_1</span> be Daisy’s song’s
<code>"danceability"</code>, and let <span class="math inline">d_2</span> be Billy’s song’s
<code>"danceability"</code>. Then:</p>
<p><span class="math display">\begin{aligned}
    2000 + 10^{6} \cdot d_1 = 1000 + 10^{6} \cdot d_2 \\
    1000 &amp;= 10^{6} (d_2 - d_1) \\
    \frac{1}{1000} &amp;= d_2 - d_1\end{aligned}</span></p>
<p>Thus, the absolute difference between their songs’
<code>"danceability"</code>s is <span class="math inline">\frac{1}{1000}</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-4">Problem 4</h2>
<p>Suppose we have one qualitative variable that that we convert to
numerical values using one- hot encoding. We’ve shown the first four
rows of the resulting design matrix below:</p>
<center><img src='../assets/images/disc10/matrix.png' width=400></center>
<p><br></p>
<h3 id="problem-4.1">Problem 4.1</h3>
<p>Say we train a linear model <span class="math inline">m_1</span> on
these data. Then, we replace all of the 1 values in column
<strong>a</strong> with 3’s and all of the 1 values in column
<strong>b</strong> with 2’s and train a new linear model <span
class="math inline">m_2</span>. Neither <span
class="math inline">m_1</span> nor <span class="math inline">m_2</span>
have an intercept term. On the training data, the average squared loss
for <span class="math inline">m_1</span> will be ________ that of <span
class="math inline">m_2</span>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> greater than</p></li>
<li><p><input type="radio" disabled="" /> less than</p></li>
<li><p><input type="radio" disabled="" /> equal to</p></li>
<li><p><input type="radio" disabled="" /> impossible to tell</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_1" aria-expanded="true" aria-controls="collapse4_1">
Click to view the solution.
</button>
</h2>
<div id="collapse4_1" class="accordion-collapse collapse"
aria-labelledby="heading4_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<p>The answer is equal to.</p>
<p>Because we can simply adjust the weights in the opposite way that we
rescale the one-hot columns, any model obtainable with the original
encoding can also be obtained with the rescaled encoding. This
guarantees that the training loss remains unchanged.</p>
<p>When one-hot encoding is used, each category is represented by a
column that typically contains only 0s and 1s. Rescaling these columns
means multiplying the 1s by a constant (for example, turning 1 into 2 or
3). However, if we also adjust the corresponding weights in the model by
dividing by that same constant, the product of the rescaled column value
and its weight remains the same. Since the model’s predictions are based
on these products, the predictions will not change, and as a result, the
average squared loss on the training data will also remain
unchanged.</p>
<p>Imagine a categorical variable “Color” with three levels: Red, Green,
and Blue. We one-hot encode this variable into three columns. For an
observation: - If the color is Red, the encoded values might be: Red =
1, Green = 0, Blue = 0.</p>
<p>Now, suppose we decide to multiply the column for Red by 2. The new
value for a Red observation becomes 2 instead of 1. To keep the
prediction the same, we can simply use half the weight for this column
in the model. This inverse adjustment ensures that the final product
(column value multiplied by weight) remains unchanged. Thus, the model’s
prediction and the average squared loss on the training data stay the
same.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-4.2">Problem 4.2</h3>
<p>To account for the intercept term, we add a column of all ones to our
design matrix from part a. That is, the resulting design matrix has four
columns: <strong>a</strong> with 3’s instead of 1’s, <strong>b</strong>
with 2’s instead of 1’s, <strong>c</strong>, and a column of all ones.
What is the rank of the new design matrix with these four columns?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> 1</p></li>
<li><p><input type="radio" disabled="" /> 2</p></li>
<li><p><input type="radio" disabled="" /> 3</p></li>
<li><p><input type="radio" disabled="" /> 4</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_2" aria-expanded="true" aria-controls="collapse4_2">
Click to view the solution.
</button>
</h2>
<div id="collapse4_2" class="accordion-collapse collapse"
aria-labelledby="heading4_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<p>The answer is 3.</p>
<p>Note that the column <strong>c</strong> = intercept column −<span class="math inline">\frac{1}{3}</span><strong>a</strong> + <span class="math inline">\frac{1}{2}</span><strong>b</strong>. Hence, there
is a linear dependence relationship, meaning that one of the columns is
redundant and that the rank of the new design matrix is 3.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-5">Problem 5</h2>
<p>One piece of information that may be useful as a feature is the
proportion of SAT test takers in a state in a given year that qualify
for free lunches in school. The Series <code>lunch_props</code> contains
8 values, each of which are either <code>"low"</code>,
<code>"medium"</code>, or <code>"high"</code>. Since we can’t use
strings as features in a model, we decide to encode these strings using
the following <code>Pipeline</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: The FunctionTransformer is only needed to change the result</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># of the OneHotEncoder from a &quot;sparse&quot; matrix to a regular matrix</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># so that it can be used with StandardScaler;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># it doesn&#39;t change anything mathematically.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>pl <span class="op">=</span> Pipeline([</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;ohe&quot;</span>, OneHotEncoder(drop<span class="op">=</span><span class="st">&quot;first&quot;</span>)),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;ft&quot;</span>, FunctionTransformer(<span class="kw">lambda</span> X: X.toarray())),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;ss&quot;</span>, StandardScaler())</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>])</span></code></pre></div>
<p>After calling <code>pl.fit(lunch_props)</code>,
<code>pl.transform(lunch_props)</code> evaluates to the following
array:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>array([[ <span class="fl">1.29099445</span>, <span class="op">-</span><span class="fl">0.37796447</span>],</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.77459667</span>, <span class="op">-</span><span class="fl">0.37796447</span>],</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.77459667</span>, <span class="op">-</span><span class="fl">0.37796447</span>],</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.77459667</span>,  <span class="fl">2.64575131</span>],</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">1.29099445</span>, <span class="op">-</span><span class="fl">0.37796447</span>],</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">1.29099445</span>, <span class="op">-</span><span class="fl">0.37796447</span>],</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.77459667</span>, <span class="op">-</span><span class="fl">0.37796447</span>],</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.77459667</span>, <span class="op">-</span><span class="fl">0.37796447</span>]])</span></code></pre></div>
<p>and <code>pl.named_steps["ohe"].get_feature_names()</code> evaluates
to the following array:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>array([<span class="st">&quot;x0_low&quot;</span>, <span class="st">&quot;x0_med&quot;</span>], dtype<span class="op">=</span><span class="bu">object</span>)</span></code></pre></div>
<p>Given the above information, we can conclude that
<code>lunch_props</code> has <strong>(a)</strong> value(s) equal to
<code>"low"</code>, <strong>(b)</strong> value(s) equal to
<code>"medium"</code>, and <strong>(c)</strong> value(s) equal to
<code>"high"</code>. <em>(Note: You should write one positive integer in
each box such that the numbers add up to 8.)</em></p>
<p>What are (a), (b), and (c)? Give you answers as positive
integers.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5" aria-expanded="true" aria-controls="collapse5">
Click to view the solution.
</button>
</h2>
<div id="collapse5" class="accordion-collapse collapse"
aria-labelledby="heading5" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> 3, 1, 4</p>
<p>The first column of the transformed array corresponds to the
standardized one-hot-encoded <code>low</code> column. There are 3 values
that are positive, which means there are 3 values that were originally
<code>1</code> in that column pre-standardization. This means that 3 of
the values in <code>lunch_props</code> were originally
<code>"low"</code>.</p>
<p>The second column of the transformed array corresponds to the
standardized one-hot-encoded <code>med</code> column. There is only 1
value in the transformed column that is positive, which means only 1 of
the values in <code>lunch_props</code> was originally
<code>"medium"</code>.</p>
<p>The Series <code>lunch_props</code> has 8 values, 3 of which were
identified as <code>"low"</code> in subpart 1, and 1 of which was
identified as <code>"medium"</code> in subpart 2. The number of values
being <code>"high"</code> must therefore be <span class="math inline">8
- 3 - 1 = 4</span>.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-6">Problem 6</h2>
<!-- Regression Question -->
<p>Reggie and Essie are given a dataset of real features <span
class="math inline">x_i \in \mathbb{R}</span> and observations <span
class="math inline">y_i</span>. Essie proposes the following hypothesis
function: <span class="math display">F(x_i) = \alpha_0 + \alpha_1
x_i</span> and Reggie proposes to the following linear prediction rule:
<span class="math display">G(x_i) = \gamma_0 + \gamma_1 x_i^2</span></p>
<p><br></p>
<h3 id="problem-6.1">Problem 6.1</h3>
<p>Let MMSE<span class="math inline">(F)</span> be the minimum value of
mean squared error that <span class="math inline">F</span> achieves on a
given dataset, and let MMSE<span class="math inline">(G)</span> be the
minimum value of mean squared error that <span
class="math inline">G</span> achieves on a given dataset. Give an
example of a dataset <span class="math inline">(x_1, y_1), (x_2, y_2),
…, (x_n, y_n)</span> for which MMSE<span class="math inline">(F)</span>
&gt; MMSE<span class="math inline">(G)</span>.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_1" aria-expanded="true" aria-controls="collapse6_1">
Click to view the solution.
</button>
</h2>
<div id="collapse6_1" class="accordion-collapse collapse"
aria-labelledby="heading6_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>Example: If the datapoints follow a quadratic form <span class="math inline">y_i=x_i^2</span> for all <span class="math inline">i</span>, then the <span class="math inline">F</span> prediction rule will achieve a zero error
while <span class="math inline">G&gt;0</span> since the data do not
follow a linear form.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-6.2">Problem 6.2</h3>
<p>Let MMSE<span class="math inline">(F)</span> be the minimum value of
mean squared error that <span class="math inline">F</span> achieves on a
given dataset, and let MMSE<span class="math inline">(G)</span> be the
minimum value of mean squared error that <span
class="math inline">G</span> achieves on a given dataset. Give an
example of a dataset <span class="math inline">(x_1, y_1), (x_2, y_2),
…, (x_n, y_n)</span> for which MMSE<span class="math inline">(F)</span>
= MMSE<span class="math inline">(G)</span>.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_2" aria-expanded="true" aria-controls="collapse6_2">
Click to view the solution.
</button>
</h2>
<div id="collapse6_2" class="accordion-collapse collapse"
aria-labelledby="heading6_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>Example 1: If the response variables are constant <span class="math inline">y_i=c</span> for all <span class="math inline">i</span>, then for both prediciton rules by setting
<span class="math inline">\alpha_0=\gamma_0=c</span> and <span class="math inline">\alpha_1=\gamma_1=0</span>, both predictors will
achieve MSE=0.</p>
<p>Example 2: when every single value of the features <span class="math inline">x_i</span> and <span class="math inline">x^2_
i</span> coincide in the dataset (this occurs when <span class="math inline">x = 0</span> or <span class="math inline">x =
1</span>), the parameters of both prediction rules will be the same, as
will the MSE.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-6.3">Problem 6.3</h3>
<p>Reggie adds a new feature <span class="math inline">x^{(2)}</span>,
to his dataset and creates two new hypothesis functions, J and K: <span
class="math display">J(\vec x_i) = w_0 + w_1 x_i^{(1)} + w_2
x_i^{(2)}</span> <span class="math display">K(\vec x_i) = \beta_0 +
\beta_1 x_i^{(1)} + \beta_2 x_i^{(2)} + \beta_3 (2 x_i^{(1)} -
x_i^{(2)})</span> Reggie argues that having more features is better, so
MMSE(K) &lt; MMSE(J). Is Reggie correct? Why or why not?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_3" aria-expanded="true" aria-controls="collapse6_3">
Click to view the solution.
</button>
</h2>
<div id="collapse6_3" class="accordion-collapse collapse"
aria-labelledby="heading6_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">K(\vec x_i)</span> can be rewritten as
<span class="math display">K(\vec x_i) = \beta_0 + (\beta_1+2\beta_3)
x_i^{(1)} +(\beta_2 - \beta_3)x_i^{(2)}</span> By setting <span class="math inline">\tilde{\beta}_1=\beta_1+2\beta_3</span> and <span class="math inline">\tilde{\beta_2}= \beta_2 - \beta_3</span> then</p>
<p><span class="math display">K(\vec x_i) =
K(\beta_0,\tilde{\beta}_1,\tilde{\beta}_2) = \beta_0 + \tilde{\beta_1}
x_i^{(1)} +\tilde{\beta}_2 x_i^{(2)}</span></p>
<p>Thus <span class="math inline">J</span> and <span class="math inline">K</span> have the same normal equations and
therefore the same minimum MSE.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-7">Problem 7</h2>
<p>The two plots below show the total number of boots (top) and sandals
(bottom) purchased per month in the <code>df</code> table. Assume that
there is one data point per month.</p>
<center><img src="../../assets/images/disc09/boot.png" style="width: 100%; height: auto;"></center>
<center><img src="../../assets/images/disc09/sandal.png" style="width: 100%; height: auto;"></center>
<p>For each of the following regression models, use the visualizations
shown above to select the value that is <strong>closest</strong> to the
fitted model weights. If it is not possible to determine the model
weight, select “Not enough info”. For the models below:</p>
<ul>
<li>The notation <span class="math inline">\text{boot}</span> refers to
the number of boots sold.</li>
<li>The notation <span class="math inline">\text{sandal}</span> refers
to the number of sandals sold.</li>
<li><span class="math inline">\text{summer}=1</span> is a column with
value 1 if the month is between March (03) and August (08),
inclusive.</li>
<li><span class="math inline">\text{winter}=1</span> is a column with
value 1 if the month is between September (09) and February (02),
inclusive.</li>
</ul>
<p><br></p>
<h3 id="problem-7.1">Problem 7.1</h3>
<p><span class="math inline">\text{predicted boot}_i = w_0</span></p>
<p><span class="math inline">w_0</span>:</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> 0</p></li>
<li><p><input type="radio" disabled="" /> 50</p></li>
<li><p><input type="radio" disabled="" /> 100</p></li>
<li><p><input type="radio" disabled="" /> Not enough info</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7_1" aria-expanded="true" aria-controls="collapse7_1">
Click to view the solution.
</button>
</h2>
<div id="collapse7_1" class="accordion-collapse collapse"
aria-labelledby="heading7_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> <span class="math inline">w_0 =
50</span></p>
<p>The model predicts a constant value for boots. The intercept <span class="math inline">w_0</span> represents the average boots sold across
all months. Since the boot count plot shows data points centered around
50, this is the best estimate.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-7.2">Problem 7.2</h3>
<p><span class="math inline">\text{predicted boot}_i = w_0 + w_1 \cdot
\text{sandals}_i</span></p>
<p><span class="math inline">w_0</span>:</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> -100</p></li>
<li><p><input type="radio" disabled="" /> -1</p></li>
<li><p><input type="radio" disabled="" /> 0</p></li>
<li><p><input type="radio" disabled="" /> 1</p></li>
<li><p><input type="radio" disabled="" /> 100</p></li>
<li><p><input type="radio" disabled="" /> Not enough info</p></li>
</ul>
<p><span class="math inline">w_1</span>:</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> -100</p></li>
<li><p><input type="radio" disabled="" /> -1</p></li>
<li><p><input type="radio" disabled="" /> 1</p></li>
<li><p><input type="radio" disabled="" /> 100</p></li>
<li><p><input type="radio" disabled="" /> Not enough info</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7_2" aria-expanded="true" aria-controls="collapse7_2">
Click to view the solution.
</button>
</h2>
<div id="collapse7_2" class="accordion-collapse collapse"
aria-labelledby="heading7_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong></p>
<p><span class="math inline">w_0</span>: 100</p>
<p>The intercept <span class="math inline">w_0</span> represents the
predicted boot sales when sandal sales are zero. Since the boot plot
shows a baseline of ~100 units during months with minimal sandal sales
(e.g., winter), this justifies <span class="math inline">w_0 =
100</span></p>
<p><span class="math inline">w_1</span>: -1</p>
<p>The coefficient <span class="math inline">w_1 = −1</span> indicates
an inverse relationship: for every additional sandal sold, boot sales
decrease by 1 unit. This aligns with seasonal trends (e.g., sandals
dominate in summer, boots in winter), and the plots likely show a
consistent negative slope of -1 between the variables.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-7.3">Problem 7.3</h3>
<p><span class="math inline">\text{predicted boot}_i  = w_0 + w_1 \cdot
(\text{summer=1})_i</span></p>
<p><span class="math inline">w_0</span>:</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> -100</p></li>
<li><p><input type="radio" disabled="" /> -1</p></li>
<li><p><input type="radio" disabled="" /> 0</p></li>
<li><p><input type="radio" disabled="" /> 1</p></li>
<li><p><input type="radio" disabled="" /> 100</p></li>
<li><p><input type="radio" disabled="" /> Not enough info</p></li>
</ul>
<p><span class="math inline">w_1</span>:</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> -80</p></li>
<li><p><input type="radio" disabled="" /> -1</p></li>
<li><p><input type="radio" disabled="" /> 0</p></li>
<li><p><input type="radio" disabled="" /> 1</p></li>
<li><p><input type="radio" disabled="" /> 80</p></li>
<li><p><input type="radio" disabled="" /> Not enough info</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7_3" aria-expanded="true" aria-controls="collapse7_3">
Click to view the solution.
</button>
</h2>
<div id="collapse7_3" class="accordion-collapse collapse"
aria-labelledby="heading7_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong></p>
<p><span class="math inline">w_0</span>: 100</p>
<p>The intercept represents the average boot sales when <span class="math inline">\text{summer}=0</span> (winter months). Since the
boot plot shows consistent sales of ~100 units during winter, this value
is justified.</p>
<p><span class="math inline">w_1</span>: -80</p>
<p>The coefficient for <span class="math inline">\text{summer}=1</span>
reflects the change in boot sales during summer. If boot sales drop
sharply by ~80 units in summer (e.g., from 100 in winter to 20 in
summer), this negative offset matches the seasonal trend.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-7.4">Problem 7.4</h3>
<p><span class="math inline">\text{predicted sandal}_i  = w_0 + w_1
\cdot (\text{summer=1})_i</span></p>
<p><span class="math inline">w_0</span>:</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> -20</p></li>
<li><p><input type="radio" disabled="" /> -1</p></li>
<li><p><input type="radio" disabled="" /> 0</p></li>
<li><p><input type="radio" disabled="" /> 1</p></li>
<li><p><input type="radio" disabled="" /> 20</p></li>
<li><p><input type="radio" disabled="" /> Not enough info</p></li>
</ul>
<p><span class="math inline">w_1</span>:</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> -80</p></li>
<li><p><input type="radio" disabled="" /> -1</p></li>
<li><p><input type="radio" disabled="" /> 0</p></li>
<li><p><input type="radio" disabled="" /> 1</p></li>
<li><p><input type="radio" disabled="" /> 80</p></li>
<li><p><input type="radio" disabled="" /> Not enough info</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7_4" aria-expanded="true" aria-controls="collapse7_4">
Click to view the solution.
</button>
</h2>
<div id="collapse7_4" class="accordion-collapse collapse"
aria-labelledby="heading7_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong></p>
<p><span class="math inline">w_0</span>: 20</p>
<p>The intercept represents baseline sandal sales when <span class="math inline">\text{summer}=0</span> (winter months). Since the
sandal plot shows consistent sales of ~20 units during winter, this
value aligns with the seasonal low.</p>
<p><span class="math inline">w_1</span>: 80</p>
<p>The coefficient reflects the increase in sandal sales during summer.
If sales rise sharply by ~80 units in summer (e.g., from 20 in winter to
100 in summer), this positive seasonal effect matches the trend shown in
the visualization.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-7.5">Problem 7.5</h3>
<p><span class="math inline">\text{predicted sandal}_i  = w_0 + w_1
\cdot (\text{summer=1})_i + w_2 \cdot (\text{winter=1})_i</span></p>
<p><span class="math inline">w_0</span>:</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> -20</p></li>
<li><p><input type="radio" disabled="" /> -1</p></li>
<li><p><input type="radio" disabled="" /> 0</p></li>
<li><p><input type="radio" disabled="" /> 1</p></li>
<li><p><input type="radio" disabled="" /> 20</p></li>
<li><p><input type="radio" disabled="" /> Not enough info</p></li>
</ul>
<p><span class="math inline">w_1</span>:</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> -80</p></li>
<li><p><input type="radio" disabled="" /> -1</p></li>
<li><p><input type="radio" disabled="" /> 0</p></li>
<li><p><input type="radio" disabled="" /> 1</p></li>
<li><p><input type="radio" disabled="" /> 80</p></li>
<li><p><input type="radio" disabled="" /> Not enough info</p></li>
</ul>
<p><span class="math inline">w_2</span>:</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> -80</p></li>
<li><p><input type="radio" disabled="" /> -1</p></li>
<li><p><input type="radio" disabled="" /> 0</p></li>
<li><p><input type="radio" disabled="" /> 1</p></li>
<li><p><input type="radio" disabled="" /> 80</p></li>
<li><p><input type="radio" disabled="" /> Not enough info</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7_5">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7_5" aria-expanded="true" aria-controls="collapse7_5">
Click to view the solution.
</button>
</h2>
<div id="collapse7_5" class="accordion-collapse collapse"
aria-labelledby="heading7_5" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong></p>
<p><span class="math inline">w_0</span>: Not enough info</p>
<p><span class="math inline">w_1</span>: Not enough info</p>
<p><span class="math inline">w_2</span>: Not enough info</p>
<p>The model includes both summer and winter dummy variables, which
likely cover all months. This creates perfect multicollinearity (since
summer + winter = 1 always). The intercept and coefficients cannot be
uniquely determined without a reference category or additional
constraints. For example, increasing the intercept and decreasing both
seasonal coefficients equally would yield the same predictions. The
visualizations do not provide enough information to resolve this
ambiguity.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="section"><span class="math display"> </span></h2>
<h4
id="feedback-find-an-error-still-confused-have-a-suggestion-let-us-know-here.">👋
Feedback: Find an error? Still confused? Have a suggestion? Let us know
<a href="https://forms.gle/xK4DpWXh9rq8AKP37">here</a>.</h4>
<hr />
</body>
</html>
